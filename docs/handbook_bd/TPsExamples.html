<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7.3 Example workflows | patRoon handbook</title>
  <meta name="description" content="7.3 Example workflows | patRoon handbook" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="7.3 Example workflows | patRoon handbook" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7.3 Example workflows | patRoon handbook" />
  
  
  

<meta name="author" content="Rick Helmus" />


<meta name="date" content="2022-06-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linking-parent-and-transformation-product-features.html"/>
<link rel="next" href="advanced_usage.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.9/grViz.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet" />
<script src="libs/vis-9.1.0/vis-network.min.js"></script>
<script src="libs/visNetwork-binding-2.1.0/visNetwork.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>2</b> Installation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="automatic-installation-windows-only.html"><a href="automatic-installation-windows-only.html"><i class="fa fa-check"></i><b>2.1</b> Automatic installation (Windows only)</a></li>
<li class="chapter" data-level="2.2" data-path="docker-image.html"><a href="docker-image.html"><i class="fa fa-check"></i><b>2.2</b> Docker image</a></li>
<li class="chapter" data-level="2.3" data-path="manual-installation.html"><a href="manual-installation.html"><i class="fa fa-check"></i><b>2.3</b> Manual installation</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="manual-installation.html"><a href="manual-installation.html#r-prerequisites"><i class="fa fa-check"></i><b>2.3.1</b> R prerequisites</a></li>
<li class="chapter" data-level="2.3.2" data-path="manual-installation.html"><a href="manual-installation.html#other-dependencies"><i class="fa fa-check"></i><b>2.3.2</b> Other dependencies</a></li>
<li class="chapter" data-level="2.3.3" data-path="manual-installation.html"><a href="manual-installation.html#patroon-installation"><i class="fa fa-check"></i><b>2.3.3</b> patRoon installation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="workflow-concepts.html"><a href="workflow-concepts.html"><i class="fa fa-check"></i><b>3</b> Workflow concepts</a></li>
<li class="chapter" data-level="4" data-path="generating-workflow-data.html"><a href="generating-workflow-data.html"><i class="fa fa-check"></i><b>4</b> Generating workflow data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i><b>4.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="introduction-1.html"><a href="introduction-1.html#workflow-functions"><i class="fa fa-check"></i><b>4.1.1</b> Workflow functions</a></li>
<li class="chapter" data-level="4.1.2" data-path="introduction-1.html"><a href="introduction-1.html#workflow-output"><i class="fa fa-check"></i><b>4.1.2</b> Workflow output</a></li>
<li class="chapter" data-level="4.1.3" data-path="introduction-1.html"><a href="introduction-1.html#overview-of-all-functions-and-their-output"><i class="fa fa-check"></i><b>4.1.3</b> Overview of all functions and their output</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="preparations.html"><a href="preparations.html"><i class="fa fa-check"></i><b>4.2</b> Preparations</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="preparations.html"><a href="preparations.html#data-pre-treatment"><i class="fa fa-check"></i><b>4.2.1</b> Data pre-treatment</a></li>
<li class="chapter" data-level="4.2.2" data-path="preparations.html"><a href="preparations.html#anaInfo"><i class="fa fa-check"></i><b>4.2.2</b> Analysis information</a></li>
<li class="chapter" data-level="4.2.3" data-path="preparations.html"><a href="preparations.html#newProject"><i class="fa fa-check"></i><b>4.2.3</b> Automatic project generation with newProject()</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="features.html"><a href="features.html"><i class="fa fa-check"></i><b>4.3</b> Features</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="features.html"><a href="features.html#finding-and-grouping-features"><i class="fa fa-check"></i><b>4.3.1</b> Finding and grouping features</a></li>
<li class="chapter" data-level="4.3.2" data-path="features.html"><a href="features.html#suspscr"><i class="fa fa-check"></i><b>4.3.2</b> Suspect screening</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="componentization.html"><a href="componentization.html"><i class="fa fa-check"></i><b>4.4</b> Componentization</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="componentization.html"><a href="componentization.html#componentsChrom"><i class="fa fa-check"></i><b>4.4.1</b> Features with similar chromatographic behaviour</a></li>
<li class="chapter" data-level="4.4.2" data-path="componentization.html"><a href="componentization.html#homologues-series"><i class="fa fa-check"></i><b>4.4.2</b> Homologues series</a></li>
<li class="chapter" data-level="4.4.3" data-path="componentization.html"><a href="componentization.html#compClust"><i class="fa fa-check"></i><b>4.4.3</b> Intensity and MS/MS similarity</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="incorpAdductIso.html"><a href="incorpAdductIso.html"><i class="fa fa-check"></i><b>4.5</b> Incorporating adduct and isotopic data</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="incorpAdductIso.html"><a href="incorpAdductIso.html#selecting-features-with-preferential-adductsisotopes"><i class="fa fa-check"></i><b>4.5.1</b> Selecting features with preferential adducts/isotopes</a></li>
<li class="chapter" data-level="4.5.2" data-path="incorpAdductIso.html"><a href="incorpAdductIso.html#setting-adduct-annotations-for-feature-groups"><i class="fa fa-check"></i><b>4.5.2</b> Setting adduct annotations for feature groups</a></li>
<li class="chapter" data-level="4.5.3" data-path="incorpAdductIso.html"><a href="incorpAdductIso.html#useAdductAnn"><i class="fa fa-check"></i><b>4.5.3</b> Using adduct annotations in the workflow</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="annotation.html"><a href="annotation.html"><i class="fa fa-check"></i><b>4.6</b> Annotation</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="annotation.html"><a href="annotation.html#ms-peak-lists"><i class="fa fa-check"></i><b>4.6.1</b> MS peak lists</a></li>
<li class="chapter" data-level="4.6.2" data-path="annotation.html"><a href="annotation.html#formulae"><i class="fa fa-check"></i><b>4.6.2</b> Formulae</a></li>
<li class="chapter" data-level="4.6.3" data-path="annotation.html"><a href="annotation.html#compounds"><i class="fa fa-check"></i><b>4.6.3</b> Compounds</a></li>
<li class="chapter" data-level="4.6.4" data-path="annotation.html"><a href="annotation.html#suspAnn"><i class="fa fa-check"></i><b>4.6.4</b> Suspect annotation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="processing.html"><a href="processing.html"><i class="fa fa-check"></i><b>5</b> Processing workflow data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="inspecting-results.html"><a href="inspecting-results.html"><i class="fa fa-check"></i><b>5.1</b> Inspecting results</a></li>
<li class="chapter" data-level="5.2" data-path="filtering.html"><a href="filtering.html"><i class="fa fa-check"></i><b>5.2</b> Filtering</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="filtering.html"><a href="filtering.html#features-1"><i class="fa fa-check"></i><b>5.2.1</b> Features</a></li>
<li class="chapter" data-level="5.2.2" data-path="filtering.html"><a href="filtering.html#suspect-screening"><i class="fa fa-check"></i><b>5.2.2</b> Suspect screening</a></li>
<li class="chapter" data-level="5.2.3" data-path="filtering.html"><a href="filtering.html#annotation-1"><i class="fa fa-check"></i><b>5.2.3</b> Annotation</a></li>
<li class="chapter" data-level="5.2.4" data-path="filtering.html"><a href="filtering.html#components"><i class="fa fa-check"></i><b>5.2.4</b> Components</a></li>
<li class="chapter" data-level="5.2.5" data-path="filtering.html"><a href="filtering.html#negation"><i class="fa fa-check"></i><b>5.2.5</b> Negation</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="subset.html"><a href="subset.html"><i class="fa fa-check"></i><b>5.3</b> Subsetting</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="subset.html"><a href="subset.html#prioritization-workflow"><i class="fa fa-check"></i><b>5.3.1</b> Prioritization workflow</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="deleting-data.html"><a href="deleting-data.html"><i class="fa fa-check"></i><b>5.4</b> Deleting data</a></li>
<li class="chapter" data-level="5.5" data-path="unOv.html"><a href="unOv.html"><i class="fa fa-check"></i><b>5.5</b> Unique and overlapping features</a></li>
<li class="chapter" data-level="5.6" data-path="specSim.html"><a href="specSim.html"><i class="fa fa-check"></i><b>5.6</b> MS similarity</a></li>
<li class="chapter" data-level="5.7" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>5.7</b> Visualization</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="visualization.html"><a href="visualization.html#vis_feat_ann"><i class="fa fa-check"></i><b>5.7.1</b> Features and annatation data</a></li>
<li class="chapter" data-level="5.7.2" data-path="visualization.html"><a href="visualization.html#visComp"><i class="fa fa-check"></i><b>5.7.2</b> Overlapping and unique data</a></li>
<li class="chapter" data-level="5.7.3" data-path="visualization.html"><a href="visualization.html#ms-similarity"><i class="fa fa-check"></i><b>5.7.3</b> MS similarity</a></li>
<li class="chapter" data-level="5.7.4" data-path="visualization.html"><a href="visualization.html#plotClust"><i class="fa fa-check"></i><b>5.7.4</b> Hierarchical clustering results</a></li>
<li class="chapter" data-level="5.7.5" data-path="visualization.html"><a href="visualization.html#generating-eics-in-dataanalysis"><i class="fa fa-check"></i><b>5.7.5</b> Generating EICs in DataAnalysis</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="intReview.html"><a href="intReview.html"><i class="fa fa-check"></i><b>5.8</b> Interactively explore and review data</a></li>
<li class="chapter" data-level="5.9" data-path="report.html"><a href="report.html"><i class="fa fa-check"></i><b>5.9</b> Reporting</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="setsWorkflow.html"><a href="setsWorkflow.html"><i class="fa fa-check"></i><b>6</b> Sets workflows</a>
<ul>
<li class="chapter" data-level="6.1" data-path="initiating-a-sets-workflow.html"><a href="initiating-a-sets-workflow.html"><i class="fa fa-check"></i><b>6.1</b> Initiating a sets workflow</a></li>
<li class="chapter" data-level="6.2" data-path="generating-sets-workflow-data.html"><a href="generating-sets-workflow-data.html"><i class="fa fa-check"></i><b>6.2</b> Generating sets workflow data</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="generating-sets-workflow-data.html"><a href="generating-sets-workflow-data.html#componentization-1"><i class="fa fa-check"></i><b>6.2.1</b> Componentization</a></li>
<li class="chapter" data-level="6.2.2" data-path="generating-sets-workflow-data.html"><a href="generating-sets-workflow-data.html#formula-and-compound-annotation"><i class="fa fa-check"></i><b>6.2.2</b> Formula and compound annotation</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="setsAdducts.html"><a href="setsAdducts.html"><i class="fa fa-check"></i><b>6.3</b> Selecting adducts to improve grouping</a></li>
<li class="chapter" data-level="6.4" data-path="processing-data.html"><a href="processing-data.html"><i class="fa fa-check"></i><b>6.4</b> Processing data</a></li>
<li class="chapter" data-level="6.5" data-path="advanced.html"><a href="advanced.html"><i class="fa fa-check"></i><b>6.5</b> Advanced</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="advanced.html"><a href="advanced.html#initiating-a-sets-workflow-from-feature-groups"><i class="fa fa-check"></i><b>6.5.1</b> Initiating a sets workflow from feature groups</a></li>
<li class="chapter" data-level="6.5.2" data-path="advanced.html"><a href="advanced.html#inspecting-and-converting-set-objects"><i class="fa fa-check"></i><b>6.5.2</b> Inspecting and converting set objects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="TPs.html"><a href="TPs.html"><i class="fa fa-check"></i><b>7</b> Transformation product screening</a>
<ul>
<li class="chapter" data-level="7.1" data-path="genTPs.html"><a href="genTPs.html"><i class="fa fa-check"></i><b>7.1</b> Obtaining transformation product data</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="genTPs.html"><a href="genTPs.html#parent-input"><i class="fa fa-check"></i><b>7.1.1</b> Parent input</a></li>
<li class="chapter" data-level="7.1.2" data-path="genTPs.html"><a href="genTPs.html#processing-data-1"><i class="fa fa-check"></i><b>7.1.2</b> Processing data</a></li>
<li class="chapter" data-level="7.1.3" data-path="genTPs.html"><a href="genTPs.html#TPsCustom"><i class="fa fa-check"></i><b>7.1.3</b> Custom libraries and transformations</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="linking-parent-and-transformation-product-features.html"><a href="linking-parent-and-transformation-product-features.html"><i class="fa fa-check"></i><b>7.2</b> Linking parent and transformation product features</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="linking-parent-and-transformation-product-features.html"><a href="linking-parent-and-transformation-product-features.html#componentization-2"><i class="fa fa-check"></i><b>7.2.1</b> Componentization</a></li>
<li class="chapter" data-level="7.2.2" data-path="linking-parent-and-transformation-product-features.html"><a href="linking-parent-and-transformation-product-features.html#TPsProc"><i class="fa fa-check"></i><b>7.2.2</b> Processing data</a></li>
<li class="chapter" data-level="7.2.3" data-path="linking-parent-and-transformation-product-features.html"><a href="linking-parent-and-transformation-product-features.html#omitting-transformation-product-input"><i class="fa fa-check"></i><b>7.2.3</b> Omitting transformation product input</a></li>
<li class="chapter" data-level="7.2.4" data-path="linking-parent-and-transformation-product-features.html"><a href="linking-parent-and-transformation-product-features.html#reporting-tp-components"><i class="fa fa-check"></i><b>7.2.4</b> Reporting TP components</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="TPsExamples.html"><a href="TPsExamples.html"><i class="fa fa-check"></i><b>7.3</b> Example workflows</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="TPsExamples.html"><a href="TPsExamples.html#TPsEx1"><i class="fa fa-check"></i><b>7.3.1</b> Screen predicted TPs for targets</a></li>
<li class="chapter" data-level="7.3.2" data-path="TPsExamples.html"><a href="TPsExamples.html#TPsEx2"><i class="fa fa-check"></i><b>7.3.2</b> Screening TPs from a library for suspects</a></li>
<li class="chapter" data-level="7.3.3" data-path="TPsExamples.html"><a href="TPsExamples.html#TPsEx3"><i class="fa fa-check"></i><b>7.3.3</b> Non-target screening of predicted TPs</a></li>
<li class="chapter" data-level="7.3.4" data-path="TPsExamples.html"><a href="TPsExamples.html#TPsEx4"><i class="fa fa-check"></i><b>7.3.4</b> Non-target screening of TPs by annotation similarities</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="advanced_usage.html"><a href="advanced_usage.html"><i class="fa fa-check"></i><b>8</b> Advanced usage</a>
<ul>
<li class="chapter" data-level="8.1" data-path="adducts.html"><a href="adducts.html"><i class="fa fa-check"></i><b>8.1</b> Adducts</a></li>
<li class="chapter" data-level="8.2" data-path="fNorm.html"><a href="fNorm.html"><i class="fa fa-check"></i><b>8.2</b> Feature intensity normalization</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="fNorm.html"><a href="fNorm.html#feature-normalization"><i class="fa fa-check"></i><b>8.2.1</b> Feature normalization</a></li>
<li class="chapter" data-level="8.2.2" data-path="fNorm.html"><a href="fNorm.html#group-normalization"><i class="fa fa-check"></i><b>8.2.2</b> Group normalization</a></li>
<li class="chapter" data-level="8.2.3" data-path="fNorm.html"><a href="fNorm.html#using-normalized-intensities"><i class="fa fa-check"></i><b>8.2.3</b> Using normalized intensities</a></li>
<li class="chapter" data-level="8.2.4" data-path="fNorm.html"><a href="fNorm.html#default-normalization"><i class="fa fa-check"></i><b>8.2.4</b> Default normalization</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="fOpt.html"><a href="fOpt.html"><i class="fa fa-check"></i><b>8.3</b> Feature parameter optimization</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="fOpt.html"><a href="fOpt.html#parameter-sets"><i class="fa fa-check"></i><b>8.3.1</b> Parameter sets</a></li>
<li class="chapter" data-level="8.3.2" data-path="fOpt.html"><a href="fOpt.html#processing-optmization-results"><i class="fa fa-check"></i><b>8.3.2</b> Processing optmization results</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="peakQual.html"><a href="peakQual.html"><i class="fa fa-check"></i><b>8.4</b> Chromatographic peak qualities</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="peakQual.html"><a href="peakQual.html#applying-machine-learning-with-metaclean"><i class="fa fa-check"></i><b>8.4.1</b> Applying machine learning with MetaClean</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="exporting-and-converting-feature-data.html"><a href="exporting-and-converting-feature-data.html"><i class="fa fa-check"></i><b>8.5</b> Exporting and converting feature data</a></li>
<li class="chapter" data-level="8.6" data-path="consensus.html"><a href="consensus.html"><i class="fa fa-check"></i><b>8.6</b> Algorithm consensus</a></li>
<li class="chapter" data-level="8.7" data-path="MSLibraries.html"><a href="MSLibraries.html"><i class="fa fa-check"></i><b>8.7</b> MS libraries</a></li>
<li class="chapter" data-level="8.8" data-path="compclust.html"><a href="compclust.html"><i class="fa fa-check"></i><b>8.8</b> Compound clustering</a></li>
<li class="chapter" data-level="8.9" data-path="basic-quantitative-and-regression-analysis.html"><a href="basic-quantitative-and-regression-analysis.html"><i class="fa fa-check"></i><b>8.9</b> Basic quantitative and regression analysis</a></li>
<li class="chapter" data-level="8.10" data-path="FCCalc.html"><a href="FCCalc.html"><i class="fa fa-check"></i><b>8.10</b> Fold changes</a></li>
<li class="chapter" data-level="8.11" data-path="caching.html"><a href="caching.html"><i class="fa fa-check"></i><b>8.11</b> Caching</a></li>
<li class="chapter" data-level="8.12" data-path="parallelization.html"><a href="parallelization.html"><i class="fa fa-check"></i><b>8.12</b> Parallelization</a>
<ul>
<li class="chapter" data-level="8.12.1" data-path="parallelization.html"><a href="parallelization.html#parellization-of-r-functions"><i class="fa fa-check"></i><b>8.12.1</b> Parellization of R functions</a></li>
<li class="chapter" data-level="8.12.2" data-path="parallelization.html"><a href="parallelization.html#multiprocessing"><i class="fa fa-check"></i><b>8.12.2</b> Multiprocessing</a></li>
<li class="chapter" data-level="8.12.3" data-path="parallelization.html"><a href="parallelization.html#notes-when-using-parallelization-with-futures"><i class="fa fa-check"></i><b>8.12.3</b> Notes when using parallelization with futures</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>9</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">patRoon handbook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="TPsExamples" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Example workflows<a href="TPsExamples.html#TPsExamples" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The next subsections demonstrate several approaches to perform a TP screening workflow with <code>patRoon</code>. In all examples it is assumed that feature groups were already obtained (with the <code>findFeatures</code> and <code>groupFeatures</code> functions) and stored in the <code>fGroups</code> variable.</p>
<p>The workflows with <code>patRoon</code> are designed to be flexible, and the examples here are primarily meant to implement your own workflow. Furthermore, some of the techniques used in the examples can also be combined. For instance, the <a href="FCCalc.html#FCCalc">Fold change</a> classification and MS/MS similarity filters applied in the <a href="TPsExamples.html#TPsEx4">fourth example</a> could also be applied to any of the other examples.</p>
<div id="TPsEx1" class="section level3 hasAnchor" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Screen predicted TPs for targets<a href="TPsExamples.html#TPsEx1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The first example is a simple workflow where TPs are predicted for a set of given parents with <a href="https://bitbucket.org/djoumbou/biotransformer/src/master/">BioTransformer</a> and subsequently screened. A <a href="http://ipb-halle.github.io/MetFrag/">MetFrag</a> compound database is generated and used for annotation.</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="TPsExamples.html#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predict TPs for a fixed list of parents</span></span>
<span id="cb185-2"><a href="TPsExamples.html#cb185-2" aria-hidden="true" tabindex="-1"></a>TPs <span class="ot">&lt;-</span> <span class="fu">generateTPs</span>(<span class="st">&quot;biotransformer&quot;</span>, <span class="at">parents =</span> patRoonData<span class="sc">::</span>suspectsPos)</span>
<span id="cb185-3"><a href="TPsExamples.html#cb185-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-4"><a href="TPsExamples.html#cb185-4" aria-hidden="true" tabindex="-1"></a><span class="co"># screen for the TPs</span></span>
<span id="cb185-5"><a href="TPsExamples.html#cb185-5" aria-hidden="true" tabindex="-1"></a>suspectsTPs <span class="ot">&lt;-</span> <span class="fu">convertToSuspects</span>(TPs, <span class="at">includeParents =</span> <span class="cn">FALSE</span>)</span>
<span id="cb185-6"><a href="TPsExamples.html#cb185-6" aria-hidden="true" tabindex="-1"></a>fGroupsTPs <span class="ot">&lt;-</span> <span class="fu">screenSuspects</span>(fGroups, suspectsTPs, <span class="at">adduct =</span> <span class="st">&quot;[M+H]+&quot;</span>, <span class="at">onlyHits =</span> <span class="cn">TRUE</span>)</span>
<span id="cb185-7"><a href="TPsExamples.html#cb185-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-8"><a href="TPsExamples.html#cb185-8" aria-hidden="true" tabindex="-1"></a><span class="co"># perform annotation of TPs</span></span>
<span id="cb185-9"><a href="TPsExamples.html#cb185-9" aria-hidden="true" tabindex="-1"></a>mslistsTPs <span class="ot">&lt;-</span> <span class="fu">generateMSPeakLists</span>(fGroupsTPs, <span class="st">&quot;mzr&quot;</span>)</span>
<span id="cb185-10"><a href="TPsExamples.html#cb185-10" aria-hidden="true" tabindex="-1"></a><span class="fu">convertToMFDB</span>(TPs, <span class="st">&quot;TP-database.csv&quot;</span>, <span class="at">includeParents =</span> <span class="cn">FALSE</span>) <span class="co"># generate MetFrag database</span></span>
<span id="cb185-11"><a href="TPsExamples.html#cb185-11" aria-hidden="true" tabindex="-1"></a>compoundsTPs <span class="ot">&lt;-</span> <span class="fu">generateCompounds</span>(fGroupsTPs, mslistsTPs, <span class="st">&quot;metfrag&quot;</span>, <span class="at">adduct =</span> <span class="st">&quot;[M+H]+&quot;</span>, <span class="at">database =</span> <span class="st">&quot;csv&quot;</span>,</span>
<span id="cb185-12"><a href="TPsExamples.html#cb185-12" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">extraOpts =</span> <span class="fu">list</span>(<span class="at">LocalDatabasePath =</span> <span class="st">&quot;TP-database.csv&quot;</span>))</span></code></pre></div>
</div>
<div id="TPsEx2" class="section level3 hasAnchor" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> Screening TPs from a library for suspects<a href="TPsExamples.html#TPsEx2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this example TPs of interest are obtained for the parents that surfaced from of a suspect screening. The steps of this workflow are:</p>
<ol style="list-style-type: decimal">
<li>Suspect screening parents.</li>
<li>Obtain TPs for the suspect hits from a library.</li>
<li>A second suspect screening is performed for TPs and the original parent screening results are amended. Note that the parent data is needed for componentization.</li>
<li>Both parents and TPs are annotated using a database generated from their chemical structures.</li>
<li>Some prioritization is performed by
<ol style="list-style-type: lower-alpha">
<li>Only keeping candidate structures for which <em>in-silico</em> fragmentation resulted in at least one annotated MS/MS peak.</li>
<li>Only keeping suspect hits with an estimated identification level of 3 or better.</li>
</ol></li>
<li>The TP components are made and only feature groups with parent/TP assignments are kept.</li>
<li>All results are reported.</li>
</ol>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="TPsExamples.html#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co"># step 1</span></span>
<span id="cb186-2"><a href="TPsExamples.html#cb186-2" aria-hidden="true" tabindex="-1"></a>fGroupsScr <span class="ot">&lt;-</span> <span class="fu">screenSuspects</span>(fGroups, patRoonData<span class="sc">::</span>suspectsPos, <span class="at">adduct =</span> <span class="st">&quot;[M+H]+&quot;</span>)</span>
<span id="cb186-3"><a href="TPsExamples.html#cb186-3" aria-hidden="true" tabindex="-1"></a><span class="co"># step 2</span></span>
<span id="cb186-4"><a href="TPsExamples.html#cb186-4" aria-hidden="true" tabindex="-1"></a>TPs <span class="ot">&lt;-</span> <span class="fu">generateTPs</span>(<span class="st">&quot;library&quot;</span>, <span class="at">parents =</span> fGroupsScr)</span>
<span id="cb186-5"><a href="TPsExamples.html#cb186-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-6"><a href="TPsExamples.html#cb186-6" aria-hidden="true" tabindex="-1"></a><span class="co"># step 3</span></span>
<span id="cb186-7"><a href="TPsExamples.html#cb186-7" aria-hidden="true" tabindex="-1"></a>suspects <span class="ot">&lt;-</span> <span class="fu">convertToSuspects</span>(TPs)</span>
<span id="cb186-8"><a href="TPsExamples.html#cb186-8" aria-hidden="true" tabindex="-1"></a>fGroupsScr <span class="ot">&lt;-</span> <span class="fu">screenSuspects</span>(fGroupsScr, suspects, <span class="at">adduct =</span> <span class="st">&quot;[M+H]+&quot;</span>, <span class="at">onlyHits =</span> <span class="cn">TRUE</span>, <span class="at">amend =</span> <span class="cn">TRUE</span>)</span>
<span id="cb186-9"><a href="TPsExamples.html#cb186-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-10"><a href="TPsExamples.html#cb186-10" aria-hidden="true" tabindex="-1"></a><span class="co"># step 4</span></span>
<span id="cb186-11"><a href="TPsExamples.html#cb186-11" aria-hidden="true" tabindex="-1"></a>mslistsScr <span class="ot">&lt;-</span> <span class="fu">generateMSPeakLists</span>(fGroupsScr, <span class="st">&quot;mzr&quot;</span>)</span>
<span id="cb186-12"><a href="TPsExamples.html#cb186-12" aria-hidden="true" tabindex="-1"></a><span class="fu">convertToMFDB</span>(TPs, <span class="st">&quot;TP-database.csv&quot;</span>, <span class="at">includeParents =</span> <span class="cn">TRUE</span>)</span>
<span id="cb186-13"><a href="TPsExamples.html#cb186-13" aria-hidden="true" tabindex="-1"></a>compoundsScr <span class="ot">&lt;-</span> <span class="fu">generateCompounds</span>(fGroupsScr, mslistsScr, <span class="st">&quot;metfrag&quot;</span>, <span class="at">adduct =</span> <span class="st">&quot;[M+H]+&quot;</span>, <span class="at">database =</span> <span class="st">&quot;csv&quot;</span>,</span>
<span id="cb186-14"><a href="TPsExamples.html#cb186-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">extraOpts =</span> <span class="fu">list</span>(<span class="at">LocalDatabasePath =</span> <span class="st">&quot;TP-database.csv&quot;</span>))</span>
<span id="cb186-15"><a href="TPsExamples.html#cb186-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-16"><a href="TPsExamples.html#cb186-16" aria-hidden="true" tabindex="-1"></a><span class="co"># step 5a</span></span>
<span id="cb186-17"><a href="TPsExamples.html#cb186-17" aria-hidden="true" tabindex="-1"></a>compoundsScr <span class="ot">&lt;-</span> <span class="fu">filter</span>(compoundsScr, <span class="at">minExplainedPeaks =</span> <span class="dv">1</span>)</span>
<span id="cb186-18"><a href="TPsExamples.html#cb186-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-19"><a href="TPsExamples.html#cb186-19" aria-hidden="true" tabindex="-1"></a><span class="co"># step 5b</span></span>
<span id="cb186-20"><a href="TPsExamples.html#cb186-20" aria-hidden="true" tabindex="-1"></a>fGroupsScrAnn <span class="ot">&lt;-</span> <span class="fu">annotateSuspects</span>(fGroupsScr, <span class="at">MSPeakLists =</span> mslistsScr,</span>
<span id="cb186-21"><a href="TPsExamples.html#cb186-21" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">compounds =</span> compoundsScr)</span>
<span id="cb186-22"><a href="TPsExamples.html#cb186-22" aria-hidden="true" tabindex="-1"></a>fGroupsScrAnn <span class="ot">&lt;-</span> <span class="fu">filter</span>(fGroupsScrAnn, <span class="at">maxLevel =</span> <span class="dv">3</span>, <span class="at">onlyHits =</span> <span class="cn">TRUE</span>)</span>
<span id="cb186-23"><a href="TPsExamples.html#cb186-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-24"><a href="TPsExamples.html#cb186-24" aria-hidden="true" tabindex="-1"></a><span class="co"># step 6</span></span>
<span id="cb186-25"><a href="TPsExamples.html#cb186-25" aria-hidden="true" tabindex="-1"></a>componTP <span class="ot">&lt;-</span> <span class="fu">generateComponents</span>(fGroupsScrAnn, <span class="st">&quot;tp&quot;</span>, <span class="at">TPs =</span> TPs, <span class="at">MSPeakLists =</span> mslistsScr,</span>
<span id="cb186-26"><a href="TPsExamples.html#cb186-26" aria-hidden="true" tabindex="-1"></a>                               <span class="at">compounds =</span> compoundsScr)</span>
<span id="cb186-27"><a href="TPsExamples.html#cb186-27" aria-hidden="true" tabindex="-1"></a>fGroupsScrAnn <span class="ot">&lt;-</span> fGroupsScrAnn[results <span class="ot">=</span> componTP]</span>
<span id="cb186-28"><a href="TPsExamples.html#cb186-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-29"><a href="TPsExamples.html#cb186-29" aria-hidden="true" tabindex="-1"></a><span class="co"># step 7</span></span>
<span id="cb186-30"><a href="TPsExamples.html#cb186-30" aria-hidden="true" tabindex="-1"></a><span class="fu">reportHTML</span>(fGroupsScrAnn, <span class="at">MSPeakLists =</span> mslistsScr, <span class="at">compounds =</span> compoundsScr,</span>
<span id="cb186-31"><a href="TPsExamples.html#cb186-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">components =</span> componTP, <span class="at">TPs =</span> TPs)</span></code></pre></div>
</div>
<div id="TPsEx3" class="section level3 hasAnchor" number="7.3.3">
<h3><span class="header-section-number">7.3.3</span> Non-target screening of predicted TPs<a href="TPsExamples.html#TPsEx3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This example uses metabolic logic to calculate possible TPs for all feature groups from a complete non-target screening. This example demonstrates how a workflow can be performed when little is known about the identity of the parents. The steps of this workflow are:</p>
<ol style="list-style-type: decimal">
<li>Formula annotations are performed for all feature groups.</li>
<li>These results are then limited to the top 5 candidates, and only feature groups with annotations are kept.</li>
<li>The TPs are calculated for all remaining feature groups.</li>
<li>A suspect screening is performed to find the TPs. Unlike the previous example feature groups without hits are kept (<a href="linking-parent-and-transformation-product-features.html#TPsFGroups">discussed here</a>).</li>
<li>The components are generated</li>
<li>The components are filtered:
<ol style="list-style-type: lower-alpha">
<li>The TPs must follow an expected <a href="linking-parent-and-transformation-product-features.html#TPsProc">retention time direction</a></li>
<li>The parent/TPs should have at least one candidate formula that fits with the transformation.</li>
</ol></li>
<li>Only feature groups are kept with parent/TP assignments and all results are reported.</li>
</ol>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="TPsExamples.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># steps 1-2</span></span>
<span id="cb187-2"><a href="TPsExamples.html#cb187-2" aria-hidden="true" tabindex="-1"></a>mslists <span class="ot">&lt;-</span> <span class="fu">generateMSPeakLists</span>(fGroups, <span class="st">&quot;mzr&quot;</span>)</span>
<span id="cb187-3"><a href="TPsExamples.html#cb187-3" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">generateFormulas</span>(fGroups, mslists, <span class="st">&quot;genform&quot;</span>, <span class="at">adduct =</span> <span class="st">&quot;[M+H]+&quot;</span>)</span>
<span id="cb187-4"><a href="TPsExamples.html#cb187-4" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">filter</span>(formulas, <span class="at">topMost =</span> <span class="dv">5</span>)</span>
<span id="cb187-5"><a href="TPsExamples.html#cb187-5" aria-hidden="true" tabindex="-1"></a>fGroups <span class="ot">&lt;-</span> fGroups[results <span class="ot">=</span> formulas]</span>
<span id="cb187-6"><a href="TPsExamples.html#cb187-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-7"><a href="TPsExamples.html#cb187-7" aria-hidden="true" tabindex="-1"></a><span class="co"># step 3</span></span>
<span id="cb187-8"><a href="TPsExamples.html#cb187-8" aria-hidden="true" tabindex="-1"></a>TPs <span class="ot">&lt;-</span> <span class="fu">generateTPs</span>(<span class="st">&quot;logic&quot;</span>, <span class="at">fGroups =</span> fGroups, <span class="at">adduct =</span> <span class="st">&quot;[M+H]+&quot;</span>)</span>
<span id="cb187-9"><a href="TPsExamples.html#cb187-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-10"><a href="TPsExamples.html#cb187-10" aria-hidden="true" tabindex="-1"></a><span class="co"># step 4</span></span>
<span id="cb187-11"><a href="TPsExamples.html#cb187-11" aria-hidden="true" tabindex="-1"></a>suspects <span class="ot">&lt;-</span> <span class="fu">convertToSuspects</span>(TPs)</span>
<span id="cb187-12"><a href="TPsExamples.html#cb187-12" aria-hidden="true" tabindex="-1"></a>fGroupsScr <span class="ot">&lt;-</span> <span class="fu">screenSuspects</span>(fGroups, suspects, <span class="at">adduct =</span> <span class="st">&quot;[M+H]+&quot;</span>, <span class="at">onlyHits =</span> <span class="cn">FALSE</span>)</span>
<span id="cb187-13"><a href="TPsExamples.html#cb187-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-14"><a href="TPsExamples.html#cb187-14" aria-hidden="true" tabindex="-1"></a><span class="co"># step 5</span></span>
<span id="cb187-15"><a href="TPsExamples.html#cb187-15" aria-hidden="true" tabindex="-1"></a>componTP <span class="ot">&lt;-</span> <span class="fu">generateComponents</span>(fGroupsScr, <span class="st">&quot;tp&quot;</span>, <span class="at">TPs =</span> TPs, <span class="at">MSPeakLists =</span> mslists, <span class="at">formulas =</span> formulas)</span>
<span id="cb187-16"><a href="TPsExamples.html#cb187-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-17"><a href="TPsExamples.html#cb187-17" aria-hidden="true" tabindex="-1"></a><span class="co"># step 6</span></span>
<span id="cb187-18"><a href="TPsExamples.html#cb187-18" aria-hidden="true" tabindex="-1"></a>componTP <span class="ot">&lt;-</span> <span class="fu">filter</span>(componTP, <span class="at">retDirMatch =</span> <span class="cn">TRUE</span>, <span class="at">formulas =</span> formulas)</span>
<span id="cb187-19"><a href="TPsExamples.html#cb187-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-20"><a href="TPsExamples.html#cb187-20" aria-hidden="true" tabindex="-1"></a><span class="co"># step 7</span></span>
<span id="cb187-21"><a href="TPsExamples.html#cb187-21" aria-hidden="true" tabindex="-1"></a>fGroupsScr <span class="ot">&lt;-</span> fGroupsScr[results <span class="ot">=</span> componTP]</span>
<span id="cb187-22"><a href="TPsExamples.html#cb187-22" aria-hidden="true" tabindex="-1"></a><span class="fu">reportHTML</span>(fGroupsScr, <span class="at">MSPeakLists =</span> mslists, <span class="at">formulas =</span> formulas, <span class="at">components =</span> componTP)</span></code></pre></div>
</div>
<div id="TPsEx4" class="section level3 hasAnchor" number="7.3.4">
<h3><span class="header-section-number">7.3.4</span> Non-target screening of TPs by annotation similarities<a href="TPsExamples.html#TPsEx4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This example shows a workflow where no TP data from a prediction or library is used. Instead, this workflow relies on statistics and MS/MS data to find feature groups which may potentially have a parent - TP relationship. The workflow is similar to that of the previous example. The steps of this workflow are:</p>
<ol style="list-style-type: decimal">
<li><a href="FCCalc.html#FCCalc">Fold changes</a> (FC) between two sample groups are calculated to classify which feature groups are decreasing (i.e. parents) or increasing (i.e. TPs).</li>
<li>Feature groups without classification are removed.</li>
<li>Formula annotations are performed like the previous example.</li>
<li>The componentization is performed and the FC classifications are used to specify which feature groups are to be considered parents or TPs.</li>
<li>Only TPs are kept that show a high MS/MS spectral similarity and share at least one fragment with their parent.</li>
<li>Only feature groups are kept with parent/TP assignments and all results are reported.</li>
</ol>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="TPsExamples.html#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># step 1</span></span>
<span id="cb188-2"><a href="TPsExamples.html#cb188-2" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(fGroups, <span class="at">FCParams =</span> <span class="fu">getFCParams</span>(<span class="fu">c</span>(<span class="st">&quot;before&quot;</span>, <span class="st">&quot;after&quot;</span>)))</span>
<span id="cb188-3"><a href="TPsExamples.html#cb188-3" aria-hidden="true" tabindex="-1"></a>groupsParents <span class="ot">&lt;-</span> tab[classification <span class="sc">==</span> <span class="st">&quot;decrease&quot;</span>]<span class="sc">$</span>group</span>
<span id="cb188-4"><a href="TPsExamples.html#cb188-4" aria-hidden="true" tabindex="-1"></a>groupsTPs <span class="ot">&lt;-</span> tab[classification <span class="sc">==</span> <span class="st">&quot;increase&quot;</span>]<span class="sc">$</span>group</span>
<span id="cb188-5"><a href="TPsExamples.html#cb188-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-6"><a href="TPsExamples.html#cb188-6" aria-hidden="true" tabindex="-1"></a><span class="co"># step 2</span></span>
<span id="cb188-7"><a href="TPsExamples.html#cb188-7" aria-hidden="true" tabindex="-1"></a>fGroups <span class="ot">&lt;-</span> fGroups[, <span class="fu">union</span>(groupsParents, groupsTPs)]</span>
<span id="cb188-8"><a href="TPsExamples.html#cb188-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-9"><a href="TPsExamples.html#cb188-9" aria-hidden="true" tabindex="-1"></a><span class="co"># step 3</span></span>
<span id="cb188-10"><a href="TPsExamples.html#cb188-10" aria-hidden="true" tabindex="-1"></a>mslists <span class="ot">&lt;-</span> <span class="fu">generateMSPeakLists</span>(fGroups, <span class="st">&quot;mzr&quot;</span>)</span>
<span id="cb188-11"><a href="TPsExamples.html#cb188-11" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">generateFormulas</span>(fGroups, mslists, <span class="st">&quot;genform&quot;</span>, <span class="at">adduct =</span> <span class="st">&quot;[M+H]+&quot;</span>)</span>
<span id="cb188-12"><a href="TPsExamples.html#cb188-12" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">filter</span>(formulas, <span class="at">topMost =</span> <span class="dv">5</span>)</span>
<span id="cb188-13"><a href="TPsExamples.html#cb188-13" aria-hidden="true" tabindex="-1"></a>fGroups <span class="ot">&lt;-</span> fGroups[results <span class="ot">=</span> formulas]</span>
<span id="cb188-14"><a href="TPsExamples.html#cb188-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-15"><a href="TPsExamples.html#cb188-15" aria-hidden="true" tabindex="-1"></a><span class="co"># step 4</span></span>
<span id="cb188-16"><a href="TPsExamples.html#cb188-16" aria-hidden="true" tabindex="-1"></a>componTP <span class="ot">&lt;-</span> <span class="fu">generateComponents</span>(<span class="at">algorithm =</span> <span class="st">&quot;tp&quot;</span>,</span>
<span id="cb188-17"><a href="TPsExamples.html#cb188-17" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fGroups =</span> fGroups[, groupsParents],</span>
<span id="cb188-18"><a href="TPsExamples.html#cb188-18" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fGroupsTPs =</span> fGroups[, groupsTPs],</span>
<span id="cb188-19"><a href="TPsExamples.html#cb188-19" aria-hidden="true" tabindex="-1"></a>                               <span class="at">MSPeakLists =</span> mslists, <span class="at">formulas =</span> formulas)</span>
<span id="cb188-20"><a href="TPsExamples.html#cb188-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-21"><a href="TPsExamples.html#cb188-21" aria-hidden="true" tabindex="-1"></a><span class="co"># step 5</span></span>
<span id="cb188-22"><a href="TPsExamples.html#cb188-22" aria-hidden="true" tabindex="-1"></a>componTP <span class="ot">&lt;-</span> <span class="fu">filter</span>(componTP, <span class="at">minSpecSimBoth =</span> <span class="fl">0.75</span>, <span class="at">minFragMatches =</span> <span class="dv">1</span>)</span>
<span id="cb188-23"><a href="TPsExamples.html#cb188-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-24"><a href="TPsExamples.html#cb188-24" aria-hidden="true" tabindex="-1"></a><span class="co"># step 6</span></span>
<span id="cb188-25"><a href="TPsExamples.html#cb188-25" aria-hidden="true" tabindex="-1"></a>fGroups <span class="ot">&lt;-</span> fGroups[results <span class="ot">=</span> componTP]</span>
<span id="cb188-26"><a href="TPsExamples.html#cb188-26" aria-hidden="true" tabindex="-1"></a><span class="fu">reportHTML</span>(fGroups, <span class="at">MSPeakLists =</span> mslists, <span class="at">formulas =</span> formulas, <span class="at">components =</span> componTP)</span></code></pre></div>

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="linking-parent-and-transformation-product-features.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="advanced_usage.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": false
}
});
});
</script>

</body>

</html>
