<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.2 Features | patRoon handbook</title>
  <meta name="description" content="4.2 Features | patRoon handbook" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="4.2 Features | patRoon handbook" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.2 Features | patRoon handbook" />
  
  
  

<meta name="author" content="Rick Helmus" />


<meta name="date" content="2022-01-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="preparations.html"/>
<link rel="next" href="componentization.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet" />
<script src="libs/vis-9.1.0/vis-network.min.js"></script>
<script src="libs/visNetwork-binding-2.1.0/visNetwork.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>2</b> Installation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="automatic-installation-windows-only.html"><a href="automatic-installation-windows-only.html"><i class="fa fa-check"></i><b>2.1</b> Automatic installation (Windows only)</a></li>
<li class="chapter" data-level="2.2" data-path="docker-image.html"><a href="docker-image.html"><i class="fa fa-check"></i><b>2.2</b> Docker image</a></li>
<li class="chapter" data-level="2.3" data-path="manual-installation.html"><a href="manual-installation.html"><i class="fa fa-check"></i><b>2.3</b> Manual installation</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="manual-installation.html"><a href="manual-installation.html#r-prerequisites"><i class="fa fa-check"></i><b>2.3.1</b> R prerequisites</a></li>
<li class="chapter" data-level="2.3.2" data-path="manual-installation.html"><a href="manual-installation.html#other-dependencies"><i class="fa fa-check"></i><b>2.3.2</b> Other dependencies</a></li>
<li class="chapter" data-level="2.3.3" data-path="manual-installation.html"><a href="manual-installation.html#patroon-installation"><i class="fa fa-check"></i><b>2.3.3</b> patRoon installation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="workflow-concepts.html"><a href="workflow-concepts.html"><i class="fa fa-check"></i><b>3</b> Workflow concepts</a></li>
<li class="chapter" data-level="4" data-path="generating-workflow-data.html"><a href="generating-workflow-data.html"><i class="fa fa-check"></i><b>4</b> Generating workflow data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="preparations.html"><a href="preparations.html"><i class="fa fa-check"></i><b>4.1</b> Preparations</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="preparations.html"><a href="preparations.html#data-pre-treatment"><i class="fa fa-check"></i><b>4.1.1</b> Data pre-treatment</a></li>
<li class="chapter" data-level="4.1.2" data-path="preparations.html"><a href="preparations.html#anaInfo"><i class="fa fa-check"></i><b>4.1.2</b> Analysis information</a></li>
<li class="chapter" data-level="4.1.3" data-path="preparations.html"><a href="preparations.html#newProject"><i class="fa fa-check"></i><b>4.1.3</b> Automatic project generation with newProject()</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="features.html"><a href="features.html"><i class="fa fa-check"></i><b>4.2</b> Features</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="features.html"><a href="features.html#finding-and-grouping-features"><i class="fa fa-check"></i><b>4.2.1</b> Finding and grouping features</a></li>
<li class="chapter" data-level="4.2.2" data-path="features.html"><a href="features.html#suspscr"><i class="fa fa-check"></i><b>4.2.2</b> Suspect screening</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="componentization.html"><a href="componentization.html"><i class="fa fa-check"></i><b>4.3</b> Componentization</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="componentization.html"><a href="componentization.html#componentsChrom"><i class="fa fa-check"></i><b>4.3.1</b> Features with similar chromatographic behaviour</a></li>
<li class="chapter" data-level="4.3.2" data-path="componentization.html"><a href="componentization.html#homologues-series"><i class="fa fa-check"></i><b>4.3.2</b> Homologues series</a></li>
<li class="chapter" data-level="4.3.3" data-path="componentization.html"><a href="componentization.html#compClust"><i class="fa fa-check"></i><b>4.3.3</b> Intensity and MS/MS similarity</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="incorpAdductIso.html"><a href="incorpAdductIso.html"><i class="fa fa-check"></i><b>4.4</b> Incorporating adduct and isotopic data</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="incorpAdductIso.html"><a href="incorpAdductIso.html#selecting-features-with-preferential-adductsisotopes"><i class="fa fa-check"></i><b>4.4.1</b> Selecting features with preferential adducts/isotopes</a></li>
<li class="chapter" data-level="4.4.2" data-path="incorpAdductIso.html"><a href="incorpAdductIso.html#setting-adduct-annotations-for-feature-groups"><i class="fa fa-check"></i><b>4.4.2</b> Setting adduct annotations for feature groups</a></li>
<li class="chapter" data-level="4.4.3" data-path="incorpAdductIso.html"><a href="incorpAdductIso.html#useAdductAnn"><i class="fa fa-check"></i><b>4.4.3</b> Using adduct annotations in the workflow</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="annotation.html"><a href="annotation.html"><i class="fa fa-check"></i><b>4.5</b> Annotation</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="annotation.html"><a href="annotation.html#ms-peak-lists"><i class="fa fa-check"></i><b>4.5.1</b> MS peak lists</a></li>
<li class="chapter" data-level="4.5.2" data-path="annotation.html"><a href="annotation.html#formulae"><i class="fa fa-check"></i><b>4.5.2</b> Formulae</a></li>
<li class="chapter" data-level="4.5.3" data-path="annotation.html"><a href="annotation.html#compounds"><i class="fa fa-check"></i><b>4.5.3</b> Compounds</a></li>
<li class="chapter" data-level="4.5.4" data-path="annotation.html"><a href="annotation.html#suspAnn"><i class="fa fa-check"></i><b>4.5.4</b> Suspect annotation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="processing.html"><a href="processing.html"><i class="fa fa-check"></i><b>5</b> Processing workflow data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="inspecting-results.html"><a href="inspecting-results.html"><i class="fa fa-check"></i><b>5.1</b> Inspecting results</a></li>
<li class="chapter" data-level="5.2" data-path="filtering.html"><a href="filtering.html"><i class="fa fa-check"></i><b>5.2</b> Filtering</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="filtering.html"><a href="filtering.html#features-1"><i class="fa fa-check"></i><b>5.2.1</b> Features</a></li>
<li class="chapter" data-level="5.2.2" data-path="filtering.html"><a href="filtering.html#suspect-screening"><i class="fa fa-check"></i><b>5.2.2</b> Suspect screening</a></li>
<li class="chapter" data-level="5.2.3" data-path="filtering.html"><a href="filtering.html#annotation-1"><i class="fa fa-check"></i><b>5.2.3</b> Annotation</a></li>
<li class="chapter" data-level="5.2.4" data-path="filtering.html"><a href="filtering.html#components"><i class="fa fa-check"></i><b>5.2.4</b> Components</a></li>
<li class="chapter" data-level="5.2.5" data-path="filtering.html"><a href="filtering.html#negation"><i class="fa fa-check"></i><b>5.2.5</b> Negation</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="subset.html"><a href="subset.html"><i class="fa fa-check"></i><b>5.3</b> Subsetting</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="subset.html"><a href="subset.html#prioritization-workflow"><i class="fa fa-check"></i><b>5.3.1</b> Prioritization workflow</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="deleting-data.html"><a href="deleting-data.html"><i class="fa fa-check"></i><b>5.4</b> Deleting data</a></li>
<li class="chapter" data-level="5.5" data-path="unOv.html"><a href="unOv.html"><i class="fa fa-check"></i><b>5.5</b> Unique and overlapping features</a></li>
<li class="chapter" data-level="5.6" data-path="specSim.html"><a href="specSim.html"><i class="fa fa-check"></i><b>5.6</b> MS similarity</a></li>
<li class="chapter" data-level="5.7" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>5.7</b> Visualization</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="visualization.html"><a href="visualization.html#vis_feat_ann"><i class="fa fa-check"></i><b>5.7.1</b> Features and annatation data</a></li>
<li class="chapter" data-level="5.7.2" data-path="visualization.html"><a href="visualization.html#visComp"><i class="fa fa-check"></i><b>5.7.2</b> Overlapping and unique data</a></li>
<li class="chapter" data-level="5.7.3" data-path="visualization.html"><a href="visualization.html#ms-similarity"><i class="fa fa-check"></i><b>5.7.3</b> MS similarity</a></li>
<li class="chapter" data-level="5.7.4" data-path="visualization.html"><a href="visualization.html#plotClust"><i class="fa fa-check"></i><b>5.7.4</b> Hierarchical clustering results</a></li>
<li class="chapter" data-level="5.7.5" data-path="visualization.html"><a href="visualization.html#generating-eics-in-dataanalysis"><i class="fa fa-check"></i><b>5.7.5</b> Generating EICs in DataAnalysis</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="intReview.html"><a href="intReview.html"><i class="fa fa-check"></i><b>5.8</b> Interactively explore and review data</a></li>
<li class="chapter" data-level="5.9" data-path="report.html"><a href="report.html"><i class="fa fa-check"></i><b>5.9</b> Reporting</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="setsWorkflow.html"><a href="setsWorkflow.html"><i class="fa fa-check"></i><b>6</b> Sets workflows</a>
<ul>
<li class="chapter" data-level="6.1" data-path="initiating-a-sets-workflow.html"><a href="initiating-a-sets-workflow.html"><i class="fa fa-check"></i><b>6.1</b> Initiating a sets workflow</a></li>
<li class="chapter" data-level="6.2" data-path="generating-sets-workflow-data.html"><a href="generating-sets-workflow-data.html"><i class="fa fa-check"></i><b>6.2</b> Generating sets workflow data</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="generating-sets-workflow-data.html"><a href="generating-sets-workflow-data.html#componentization-1"><i class="fa fa-check"></i><b>6.2.1</b> Componentization</a></li>
<li class="chapter" data-level="6.2.2" data-path="generating-sets-workflow-data.html"><a href="generating-sets-workflow-data.html#formula-and-compound-annotation"><i class="fa fa-check"></i><b>6.2.2</b> Formula and compound annotation</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="setsAdducts.html"><a href="setsAdducts.html"><i class="fa fa-check"></i><b>6.3</b> Selecting adducts to improve grouping</a></li>
<li class="chapter" data-level="6.4" data-path="processing-data.html"><a href="processing-data.html"><i class="fa fa-check"></i><b>6.4</b> Processing data</a></li>
<li class="chapter" data-level="6.5" data-path="advanced.html"><a href="advanced.html"><i class="fa fa-check"></i><b>6.5</b> Advanced</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="advanced.html"><a href="advanced.html#initiating-a-sets-workflow-from-feature-groups"><i class="fa fa-check"></i><b>6.5.1</b> Initiating a sets workflow from feature groups</a></li>
<li class="chapter" data-level="6.5.2" data-path="advanced.html"><a href="advanced.html#inspecting-and-converting-set-objects"><i class="fa fa-check"></i><b>6.5.2</b> Inspecting and converting set objects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="TPs.html"><a href="TPs.html"><i class="fa fa-check"></i><b>7</b> Transformation product screening</a>
<ul>
<li class="chapter" data-level="7.1" data-path="genTPs.html"><a href="genTPs.html"><i class="fa fa-check"></i><b>7.1</b> Obtaining transformation product data</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="genTPs.html"><a href="genTPs.html#parent-input"><i class="fa fa-check"></i><b>7.1.1</b> Parent input</a></li>
<li class="chapter" data-level="7.1.2" data-path="genTPs.html"><a href="genTPs.html#processing-data-1"><i class="fa fa-check"></i><b>7.1.2</b> Processing data</a></li>
<li class="chapter" data-level="7.1.3" data-path="genTPs.html"><a href="genTPs.html#TPsCustom"><i class="fa fa-check"></i><b>7.1.3</b> Custom libraries and transformations</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="linking-parent-and-transformation-product-features.html"><a href="linking-parent-and-transformation-product-features.html"><i class="fa fa-check"></i><b>7.2</b> Linking parent and transformation product features</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="linking-parent-and-transformation-product-features.html"><a href="linking-parent-and-transformation-product-features.html#componentization-2"><i class="fa fa-check"></i><b>7.2.1</b> Componentization</a></li>
<li class="chapter" data-level="7.2.2" data-path="linking-parent-and-transformation-product-features.html"><a href="linking-parent-and-transformation-product-features.html#TPsProc"><i class="fa fa-check"></i><b>7.2.2</b> Processing data</a></li>
<li class="chapter" data-level="7.2.3" data-path="linking-parent-and-transformation-product-features.html"><a href="linking-parent-and-transformation-product-features.html#omitting-transformation-product-input"><i class="fa fa-check"></i><b>7.2.3</b> Omitting transformation product input</a></li>
<li class="chapter" data-level="7.2.4" data-path="linking-parent-and-transformation-product-features.html"><a href="linking-parent-and-transformation-product-features.html#reporting-tp-components"><i class="fa fa-check"></i><b>7.2.4</b> Reporting TP components</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="TPsExamples.html"><a href="TPsExamples.html"><i class="fa fa-check"></i><b>7.3</b> Example workflows</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="TPsExamples.html"><a href="TPsExamples.html#TPsEx1"><i class="fa fa-check"></i><b>7.3.1</b> Screen predicted TPs for targets</a></li>
<li class="chapter" data-level="7.3.2" data-path="TPsExamples.html"><a href="TPsExamples.html#TPsEx2"><i class="fa fa-check"></i><b>7.3.2</b> Screening TPs from a library for suspects</a></li>
<li class="chapter" data-level="7.3.3" data-path="TPsExamples.html"><a href="TPsExamples.html#TPsEx3"><i class="fa fa-check"></i><b>7.3.3</b> Non-target screening of predicted TPs</a></li>
<li class="chapter" data-level="7.3.4" data-path="TPsExamples.html"><a href="TPsExamples.html#TPsEx4"><i class="fa fa-check"></i><b>7.3.4</b> Non-target screening of TPs by annotation similarities</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="advanced_usage.html"><a href="advanced_usage.html"><i class="fa fa-check"></i><b>8</b> Advanced usage</a>
<ul>
<li class="chapter" data-level="8.1" data-path="adducts.html"><a href="adducts.html"><i class="fa fa-check"></i><b>8.1</b> Adducts</a></li>
<li class="chapter" data-level="8.2" data-path="fOpt.html"><a href="fOpt.html"><i class="fa fa-check"></i><b>8.2</b> Feature parameter optimization</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="fOpt.html"><a href="fOpt.html#parameter-sets"><i class="fa fa-check"></i><b>8.2.1</b> Parameter sets</a></li>
<li class="chapter" data-level="8.2.2" data-path="fOpt.html"><a href="fOpt.html#processing-optmization-results"><i class="fa fa-check"></i><b>8.2.2</b> Processing optmization results</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="peakQual.html"><a href="peakQual.html"><i class="fa fa-check"></i><b>8.3</b> Chromatographic peak qualities</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="peakQual.html"><a href="peakQual.html#applying-machine-learning-with-metaclean"><i class="fa fa-check"></i><b>8.3.1</b> Applying machine learning with MetaClean</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="exporting-and-converting-feature-data.html"><a href="exporting-and-converting-feature-data.html"><i class="fa fa-check"></i><b>8.4</b> Exporting and converting feature data</a></li>
<li class="chapter" data-level="8.5" data-path="consensus.html"><a href="consensus.html"><i class="fa fa-check"></i><b>8.5</b> Algorithm consensus</a></li>
<li class="chapter" data-level="8.6" data-path="compclust.html"><a href="compclust.html"><i class="fa fa-check"></i><b>8.6</b> Compound clustering</a></li>
<li class="chapter" data-level="8.7" data-path="basic-quantitative-and-regression-analysis.html"><a href="basic-quantitative-and-regression-analysis.html"><i class="fa fa-check"></i><b>8.7</b> Basic quantitative and regression analysis</a></li>
<li class="chapter" data-level="8.8" data-path="FCCalc.html"><a href="FCCalc.html"><i class="fa fa-check"></i><b>8.8</b> Fold changes</a></li>
<li class="chapter" data-level="8.9" data-path="caching.html"><a href="caching.html"><i class="fa fa-check"></i><b>8.9</b> Caching</a></li>
<li class="chapter" data-level="8.10" data-path="parallelization.html"><a href="parallelization.html"><i class="fa fa-check"></i><b>8.10</b> Parallelization</a>
<ul>
<li class="chapter" data-level="8.10.1" data-path="parallelization.html"><a href="parallelization.html#parellization-of-r-functions"><i class="fa fa-check"></i><b>8.10.1</b> Parellization of R functions</a></li>
<li class="chapter" data-level="8.10.2" data-path="parallelization.html"><a href="parallelization.html#multiprocessing"><i class="fa fa-check"></i><b>8.10.2</b> Multiprocessing</a></li>
<li class="chapter" data-level="8.10.3" data-path="parallelization.html"><a href="parallelization.html#notes-when-using-parallelization-with-futures"><i class="fa fa-check"></i><b>8.10.3</b> Notes when using parallelization with futures</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>9</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">patRoon handbook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="features" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Features</h2>
<p>Collecting features from the analyses consists of finding all features, grouping them across analyses (optionally after retention time alignment), and if desired suspect screening:</p>
<div id="htmlwidget-283aba5890ac0b93cf24" style="width:500px;height:70px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-283aba5890ac0b93cf24">{"x":{"diagram":"\ndigraph Features {\n  graph [ rankdir = LR, compound = true ]\n  node [ shape = box,\n         fixedsize = true,\n         width = 2.2,\n         height = 1,\n         fontsize = 18,\n         fillcolor = darkseagreen1,\n         style = filled ]\n\n    \"Find features\" -> \"Group features\"\n    \"Suspect screening\"\n    \"Group features\" -> \"Suspect screening\" [style=dashed]\n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<div id="finding-and-grouping-features" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Finding and grouping features</h3>
<p>Several algorithms are available for finding features. These are listed in the table below alongside their usage and general remarks.</p>
<table>
<colgroup>
<col width="21%" />
<col width="58%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Usage</th>
<th>Remarks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="http://openms.de/">OpenMS</a></td>
<td><code>findFeatures(algorithm = "openms", ...)</code></td>
<td>Uses the <a href="https://abibuilder.informatik.uni-tuebingen.de/archive/openms/Documentation/release/latest/html/TOPP_FeatureFinderMetabo.html">FeatureFinderMetabo</a> algorithm</td>
</tr>
<tr class="even">
<td><a href="https://www.bioconductor.org/packages/release/bioc/html/xcms.html">XCMS</a></td>
<td><code>findFeatures(algorithm = "xcms", ...)</code></td>
<td>Uses <code>xcms::xcmsSet()</code> function</td>
</tr>
<tr class="odd">
<td><a href="https://www.bioconductor.org/packages/release/bioc/html/xcms.html">XCMS</a> (import)</td>
<td><code>importFeatures(algorithm = "xcms", ...)</code></td>
<td>Imports an existing <code>xcmsSet</code> object</td>
</tr>
<tr class="even">
<td><a href="https://www.bioconductor.org/packages/release/bioc/html/xcms.html">XCMS3</a></td>
<td><code>findFeatures(algorithm = "xcms3", ...)</code></td>
<td>Uses <code>xcms::findChromPeaks()</code> from the new XCMS3 interface</td>
</tr>
<tr class="odd">
<td><a href="https://www.bioconductor.org/packages/release/bioc/html/xcms.html">XCMS3</a> (import)</td>
<td><code>importFeatures(algorithm = "xcms3", ...)</code></td>
<td>Imports an existing <code>XCMSnExp</code> object</td>
</tr>
<tr class="even">
<td><a href="https://cran.r-project.org/web/packages/enviPick/index.html">enviPick</a></td>
<td><code>findFeatures(algorithm = "envipick", ...)</code></td>
<td>Uses <code>enviPick::enviPickwrap()</code></td>
</tr>
<tr class="odd">
<td><a href="https://github.com/hcji/KPIC2">KPIC2</a></td>
<td><code>findFeatures(algorithm = "kpic2", ...)</code></td>
<td>Uses the <a href="https://github.com/hcji/KPIC2">KPIC2</a> <code>R</code> package</td>
</tr>
<tr class="even">
<td><a href="https://github.com/hcji/KPIC2">KPIC2</a> (import)</td>
<td><code>importFeatures(algorithm = "kpic2", ...)</code></td>
<td>Imports features from <a href="https://github.com/hcji/KPIC2">KPIC2</a></td>
</tr>
<tr class="odd">
<td><a href="https://bio.informatik.uni-jena.de/software/sirius/">SIRIUS</a></td>
<td><code>findFeatures(algorithm = "sirius", ...)</code></td>
<td>Uses <a href="https://bio.informatik.uni-jena.de/software/sirius/">SIRIUS</a> to find features</td>
</tr>
<tr class="even">
<td><a href="https://bitbucket.org/SSamanipour/safd.jl/src/master/">SAFD</a></td>
<td><code>findFeatures(algorithm = "safd", ...)</code></td>
<td>Uses the <a href="https://bitbucket.org/SSamanipour/safd.jl/src/master/">SAFD</a> algorithm (experimental)</td>
</tr>
<tr class="odd">
<td>DataAnalysis</td>
<td><code>findFeatures(algorithm = "bruker", ...)</code></td>
<td>Uses Find Molecular Features from DataAnalysis (Bruker only)</td>
</tr>
</tbody>
</table>
<p>Most often the performance of these algorithms heavily depend on the data and parameter settings that are used. Since obtaining a good feature dataset is crucial for the rest of the workflow, it is highly recommended to experiment with different settings (this process can also be automated, see <a href="fOpt.html#fOpt">the feature optimization section</a> for more details). Some common parameters to look at are listed in the table below. However, there are many more parameters that can be set, please see the reference documentation for these (e.g. <code>?findFeatures</code>).</p>
<table>
<colgroup>
<col width="16%" />
<col width="83%" />
</colgroup>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Common parameters</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="http://openms.de/">OpenMS</a></td>
<td><code>noiseThrInt</code>, <code>chromSNR</code>, <code>chromFWHM</code>, <code>mzPPM</code>, <code>minFWHM</code>, <code>maxFWHM</code> (see <code>?findFeatures</code>)</td>
</tr>
<tr class="even">
<td><a href="https://www.bioconductor.org/packages/release/bioc/html/xcms.html">XCMS</a> / <a href="https://www.bioconductor.org/packages/release/bioc/html/xcms.html">XCMS3</a></td>
<td><code>peakwidth</code>, <code>mzdiff</code>, <code>prefilter</code>, <code>noise</code> (assuming default <code>centWave</code> algorithm, see <code>?findPeaks.centWave</code> / <code>?CentWaveParam</code>)</td>
</tr>
<tr class="odd">
<td><a href="https://cran.r-project.org/web/packages/enviPick/index.html">enviPick</a></td>
<td><code>dmzgap</code>, <code>dmzdens</code>, <code>drtgap</code>, <code>drtsmall</code>, <code>drtdens</code>, <code>drtfill</code>, <code>drttotal</code>, <code>minpeak</code>, <code>minint</code>, <code>maxint</code> (see <code>?enviPickwrap</code>)</td>
</tr>
<tr class="even">
<td><a href="https://github.com/hcji/KPIC2">KPIC2</a></td>
<td><code>kmeans</code>, <code>level</code>, <code>min_snr</code> (see <code>?findFeatures</code> and <code>?getPIC</code> / <code>?getPIC.kmeans</code>)</td>
</tr>
<tr class="odd">
<td><a href="https://bio.informatik.uni-jena.de/software/sirius/">SIRIUS</a></td>
<td>The <code>sirius</code> algorithm is currently parameterless</td>
</tr>
<tr class="even">
<td><a href="https://bitbucket.org/SSamanipour/safd.jl/src/master/">SAFD</a></td>
<td><code>mzRange</code>, <code>maxNumbIter</code>, <code>resolution</code>, <code>minInt</code> (see <code>?findFeatures</code>)</td>
</tr>
<tr class="odd">
<td>DataAnalysis</td>
<td>See <em>Find</em> -&gt; <em>Parameters…</em> -&gt; <em>Molecular Features</em> in DataAnalysis.</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong><em>NOTE</em></strong> Support for SAFD is still experimental and some extra work is required to set everything up. Please see the reference documentation for this algorithm (<code>?findFeatures</code>).</p>
</blockquote>
<blockquote>
<p><strong><em>NOTE</em></strong> DataAnalysis feature settings have to be configured in DataAnalysis prior to calling <code>findFeatures()</code>.</p>
</blockquote>
<p>Similarly, for grouping features across analyses several algorithms are supported.</p>
<table>
<colgroup>
<col width="14%" />
<col width="51%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Usage</th>
<th>Remarks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="http://openms.de/">OpenMS</a></td>
<td><code>groupFeatures(algorithm = "openms", ...)</code></td>
<td>Uses the <a href="https://abibuilder.informatik.uni-tuebingen.de/archive/openms/Documentation/release/latest/html/TOPP_FeatureLinkerUnlabeled.html">FeatureLinkerUnlabeled</a> algorithm (and <a href="https://abibuilder.informatik.uni-tuebingen.de/archive/openms/Documentation/release/latest/html/TOPP_MapAlignerPoseClustering.html">MapAlignerPoseClustering</a> for retention alignment)</td>
</tr>
<tr class="even">
<td><a href="https://www.bioconductor.org/packages/release/bioc/html/xcms.html">XCMS</a></td>
<td><code>groupFeatures(algorithm = "xcms", ...)</code></td>
<td>Uses <code>xcms::group()</code> <code>xcms::retcor()</code> functions</td>
</tr>
<tr class="odd">
<td><a href="https://www.bioconductor.org/packages/release/bioc/html/xcms.html">XCMS</a> (import)</td>
<td><code>importFeatureGroupsXCMS(...)</code></td>
<td>Imports an existing <code>xcmsSet</code> object.</td>
</tr>
<tr class="even">
<td><a href="https://www.bioconductor.org/packages/release/bioc/html/xcms.html">XCMS3</a></td>
<td><code>groupFeatures(algorithm = "xcms3", ...)</code></td>
<td>Uses <code>xcms::groupChromPeaks()</code> and <code>xcms::adjustRtime()</code> functions</td>
</tr>
<tr class="odd">
<td><a href="https://www.bioconductor.org/packages/release/bioc/html/xcms.html">XCMS3</a> (import)</td>
<td><code>importFeatureGroupsXCMS3(...)</code></td>
<td>Imports an existing <code>XCMSnExp</code> object.</td>
</tr>
<tr class="even">
<td><a href="https://github.com/hcji/KPIC2">KPIC2</a></td>
<td><code>groupFeatures(algorithm = "kpic2", ...)</code></td>
<td>Uses the <a href="https://github.com/hcji/KPIC2">KPIC2</a> package</td>
</tr>
<tr class="odd">
<td><a href="https://github.com/hcji/KPIC2">KPIC2</a> (import)</td>
<td><code>importFeatureGroupsKPIC2(...)</code></td>
<td>Imports a <code>PIC set</code> object</td>
</tr>
<tr class="even">
<td><a href="https://bio.informatik.uni-jena.de/software/sirius/">SIRIUS</a></td>
<td><code>groupFeatures(anaInfo, algorithm = "sirius")</code></td>
<td>Finds <em>and</em> groups features with <a href="https://bio.informatik.uni-jena.de/software/sirius/">SIRIUS</a></td>
</tr>
<tr class="odd">
<td>ProfileAnalysis</td>
<td><code>importFeatureGroups(algorithm = "brukerpa", ...)</code></td>
<td>Import <code>.csv</code> file exported from Bruker ProfileAnalysis</td>
</tr>
<tr class="even">
<td>TASQ</td>
<td><code>importFeatureGroups(algorithm = "brukertasq", ...)</code></td>
<td>Imports a <em>Global result table</em> (exported to Excel file and then saved as <code>.csv</code> file)</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong><em>NOTE</em></strong>: Grouping features with the <code>sirius</code> algorithm will perform both finding and grouping features with <a href="https://bio.informatik.uni-jena.de/software/sirius/">SIRIUS</a>. This algorithm cannot work with features from another algorithm.</p>
</blockquote>
<p>Just like finding features, each algorithm has their own set of parameters. Often the defaults are a good start but it is recommended to have look at them. See <code>?groupFeatures</code> for more details.</p>
<p>When using the <a href="https://www.bioconductor.org/packages/release/bioc/html/xcms.html">XCMS</a> algorithms both the ‘classical’ interface and latest <code>XCMS3</code> interfaces are supported. Currently, both interfaces are mostly the same regarding functionalities and implementation. However, since future developments of XCMS are primarily focused the latter this interface is recommended.</p>
<p>Some examples of finding and grouping features are shown below.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="features.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The anaInfo variable contains analysis information, see the previous section</span></span>
<span id="cb14-2"><a href="features.html#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="features.html#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Finding features</span></span>
<span id="cb14-4"><a href="features.html#cb14-4" aria-hidden="true" tabindex="-1"></a>fListOMS <span class="ot">&lt;-</span> <span class="fu">findFeatures</span>(anaInfo, <span class="st">&quot;openms&quot;</span>) <span class="co"># OpenMS, with default settings</span></span>
<span id="cb14-5"><a href="features.html#cb14-5" aria-hidden="true" tabindex="-1"></a>fListOMS2 <span class="ot">&lt;-</span> <span class="fu">findFeatures</span>(anaInfo, <span class="st">&quot;openms&quot;</span>, <span class="at">noiseThrInt =</span> <span class="dv">500</span>, <span class="at">chromSNR =</span> <span class="dv">10</span>) <span class="co"># OpenMS, adjusted minimum intensity and S/N</span></span>
<span id="cb14-6"><a href="features.html#cb14-6" aria-hidden="true" tabindex="-1"></a>fListXCMS <span class="ot">&lt;-</span> <span class="fu">findFeatures</span>(anaInfo, <span class="st">&quot;xcms&quot;</span>, <span class="at">ppm =</span> <span class="dv">10</span>) <span class="co"># XCMS</span></span>
<span id="cb14-7"><a href="features.html#cb14-7" aria-hidden="true" tabindex="-1"></a>fListXCMSImp <span class="ot">&lt;-</span> <span class="fu">importFeatures</span>(anaInfo, <span class="st">&quot;xcms&quot;</span>, xset) <span class="co"># import XCMS xcmsSet object</span></span>
<span id="cb14-8"><a href="features.html#cb14-8" aria-hidden="true" tabindex="-1"></a>fListXCMS3 <span class="ot">&lt;-</span> <span class="fu">findFeatures</span>(anaInfo, <span class="st">&quot;xcms3&quot;</span>, <span class="fu">CentWaveParam</span>(<span class="at">peakwidth =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">15</span>))) <span class="co"># XCMS3</span></span>
<span id="cb14-9"><a href="features.html#cb14-9" aria-hidden="true" tabindex="-1"></a>fListEP <span class="ot">&lt;-</span> <span class="fu">findFeatures</span>(anaInfo, <span class="st">&quot;envipick&quot;</span>, <span class="at">minint =</span> <span class="fl">1E3</span>) <span class="co"># enviPick</span></span>
<span id="cb14-10"><a href="features.html#cb14-10" aria-hidden="true" tabindex="-1"></a>fListKPIC2 <span class="ot">&lt;-</span> <span class="fu">findFeatures</span>(anaInfo, <span class="st">&quot;kpic2&quot;</span>, <span class="at">kmeans =</span> <span class="cn">TRUE</span>, <span class="at">level =</span> <span class="fl">1E4</span>) <span class="co"># KPIC2</span></span>
<span id="cb14-11"><a href="features.html#cb14-11" aria-hidden="true" tabindex="-1"></a>fListSIRIUS <span class="ot">&lt;-</span> <span class="fu">findFeatures</span>(anaInfo, <span class="st">&quot;sirius&quot;</span>) <span class="co"># SIRIUS</span></span>
<span id="cb14-12"><a href="features.html#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="features.html#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Grouping features</span></span>
<span id="cb14-14"><a href="features.html#cb14-14" aria-hidden="true" tabindex="-1"></a>fGroupsOMS <span class="ot">&lt;-</span> <span class="fu">groupFeatures</span>(fListOMS, <span class="st">&quot;openms&quot;</span>) <span class="co"># OpenMS grouping, default settings</span></span>
<span id="cb14-15"><a href="features.html#cb14-15" aria-hidden="true" tabindex="-1"></a>fGroupsOMS2 <span class="ot">&lt;-</span> <span class="fu">groupFeatures</span>(fListOMS2, <span class="st">&quot;openms&quot;</span>, <span class="at">rtalign =</span> <span class="cn">FALSE</span>) <span class="co"># OpenMS grouping, no RT alignment</span></span>
<span id="cb14-16"><a href="features.html#cb14-16" aria-hidden="true" tabindex="-1"></a>fGroupsOMS3 <span class="ot">&lt;-</span> <span class="fu">groupFeatures</span>(fListXCMS, <span class="st">&quot;openms&quot;</span>, <span class="at">maxGroupRT =</span> <span class="dv">6</span>) <span class="co"># group XCMS features with OpenMS, adjusted grouping parameter</span></span>
<span id="cb14-17"><a href="features.html#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co"># group enviPick features with XCMS3, disable minFraction</span></span>
<span id="cb14-18"><a href="features.html#cb14-18" aria-hidden="true" tabindex="-1"></a>fGroupsXCMS <span class="ot">&lt;-</span> <span class="fu">groupFeatures</span>(fListEP, <span class="st">&quot;xcms3&quot;</span>,</span>
<span id="cb14-19"><a href="features.html#cb14-19" aria-hidden="true" tabindex="-1"></a>                             xcms<span class="sc">::</span><span class="fu">PeakDensityParam</span>(<span class="at">sampleGroups =</span> analInfo<span class="sc">$</span>group,</span>
<span id="cb14-20"><a href="features.html#cb14-20" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">minFraction =</span> <span class="dv">0</span>))</span>
<span id="cb14-21"><a href="features.html#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="co"># group with KPIC2 and set some custom grouping/aligning parameters</span></span>
<span id="cb14-22"><a href="features.html#cb14-22" aria-hidden="true" tabindex="-1"></a>fGroupsKPIC2 <span class="ot">&lt;-</span> <span class="fu">groupFeatures</span>(fListKPIC2, <span class="st">&quot;kpic2&quot;</span>, <span class="at">groupArgs =</span> <span class="fu">list</span>(<span class="at">tolerance =</span> <span class="fu">c</span>(<span class="fl">0.002</span>, <span class="dv">18</span>)),</span>
<span id="cb14-23"><a href="features.html#cb14-23" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alignArgs =</span> <span class="fu">list</span>(<span class="at">move =</span> <span class="st">&quot;loess&quot;</span>))</span>
<span id="cb14-24"><a href="features.html#cb14-24" aria-hidden="true" tabindex="-1"></a>fGroupsSIRIUS <span class="ot">&lt;-</span> <span class="fu">groupFeatures</span>(anaInfo, <span class="st">&quot;sirius&quot;</span>) <span class="co"># find/group features with SIRIUS</span></span></code></pre></div>
</div>
<div id="suspscr" class="section level3" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Suspect screening</h3>
<blockquote>
<p><strong><em>NOTE</em></strong>: you may need to install <a href="http://openbabel.org/wiki/Main_Page">OpenBabel</a>, for instance, when only InChI data is available for mass calculation.</p>
</blockquote>
<p>After features have been grouped a so called suspect screening step may be performed to find features that may correspond to suspects within a given suspect list. The <code>screenSuspects()</code> function is used for this purpose, for instance:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="features.html#cb15-1" aria-hidden="true" tabindex="-1"></a>suspects <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;1H-benzotriazole&quot;</span>, <span class="st">&quot;N-Phenyl urea&quot;</span>, <span class="st">&quot;2-Hydroxyquinoline&quot;</span>),</span>
<span id="cb15-2"><a href="features.html#cb15-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mz =</span> <span class="fu">c</span>(<span class="fl">120.0556</span>, <span class="fl">137.0709</span>, <span class="fl">146.0600</span>))</span>
<span id="cb15-3"><a href="features.html#cb15-3" aria-hidden="true" tabindex="-1"></a>fGroupsSusp <span class="ot">&lt;-</span> <span class="fu">screenSuspects</span>(fGroups, suspects)</span></code></pre></div>
<div id="suspect-list-format" class="section level4" number="4.2.2.1">
<h4><span class="header-section-number">4.2.2.1</span> Suspect list format</h4>
<p>The example above has a very simple suspect list with just three compounds. The format of the suspect list is quite flexible, and can contain the following columns:</p>
<ul>
<li><code>name</code>: The name of the suspect. Mandatory and should be unique and file-name compatible (if not, the name will be automatically re-named to make it compatible).</li>
<li><code>rt</code>: The retention time in seconds. Optional. If specified any feature groups with a different retention time will not be considered to match suspects.</li>
<li><code>mz</code>, <code>SMILES</code>, <code>InChI</code>, <code>formula</code>, <code>neutralMass</code>: <em>at least</em> one of these columns must hold data for each suspect row. The <code>mz</code> column specifies the ionized mass of the suspect. If this is not available then data from any of the other columns is used to determine the suspect mass.</li>
<li><code>adduct</code>: The adduct of the suspect. Optional. Set this if you are sure that a suspect should be matched by a particular adduct ion and no data in the <code>mz</code> column is available.</li>
<li><code>fragments_mz</code> and <code>fragments_formula</code>: optional columns that may assist <a href="annotation.html#suspAnn">suspect annotation</a>.</li>
</ul>
<p>In most cases a suspect list is best made as a <code>csv</code> file which can then be imported with e.g. the <code>read.csv()</code> function. This is exactly what happen when you specify a suspect list when using the <code>newProject()</code> function.</p>
<p>Quite often, the ionized masses are not readily available and these have to be calculated. In this case, data in any of the <code>SMILES</code>/<code>InChI</code>/<code>formula</code>/<code>neutralMass</code> columns should be provided. Whenever possible, it is <em>strongly</em> recommended to fill in <code>SMILES</code> column (or <code>InChI</code>), as this will assist <a href="annotation.html#suspAnn">annotation</a>. Applying this to the above example:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="features.html#cb16-1" aria-hidden="true" tabindex="-1"></a>suspects <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;1H-benzotriazole&quot;</span>, <span class="st">&quot;N-Phenyl urea&quot;</span>, <span class="st">&quot;2-Hydroxyquinoline&quot;</span>),</span>
<span id="cb16-2"><a href="features.html#cb16-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">SMILES =</span> <span class="fu">c</span>(<span class="st">&quot;[nH]1nnc2ccccc12&quot;</span>, <span class="st">&quot;NC(=O)Nc1ccccc1&quot;</span>, <span class="st">&quot;Oc1ccc2ccccc2n1&quot;</span>))</span>
<span id="cb16-3"><a href="features.html#cb16-3" aria-hidden="true" tabindex="-1"></a>fGroupsSusp <span class="ot">&lt;-</span> <span class="fu">screenSuspects</span>(fGroups, suspects, <span class="at">adduct =</span> <span class="st">&quot;[M+H]+&quot;</span>)</span></code></pre></div>
<p>Since suspect matching now occurs by the neutral mass it is required that the adduct information for the feature groups are set. This is done either by setting the <code>adduct</code> function argument to <code>screenSuspects</code> or by <a href="incorpAdductIso.html#incorpAdductIso">feature group adduct annotations</a>.</p>
<p>Finally, when the adduct is known for a suspect it can be specified in the suspect list:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="features.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aldicarb is measured with a sodium adduct.</span></span>
<span id="cb17-2"><a href="features.html#cb17-2" aria-hidden="true" tabindex="-1"></a>suspects <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;1H-benzotriazole&quot;</span>, <span class="st">&quot;N-Phenyl urea&quot;</span>, <span class="st">&quot;Aldicarb&quot;</span>),</span>
<span id="cb17-3"><a href="features.html#cb17-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">SMILES =</span> <span class="fu">c</span>(<span class="st">&quot;[nH]1nnc2ccccc12&quot;</span>, <span class="st">&quot;NC(=O)Nc1ccccc1&quot;</span>, <span class="st">&quot;CC(C)(C=NOC(=O)NC)SC&quot;</span>),</span>
<span id="cb17-4"><a href="features.html#cb17-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">adduct =</span> <span class="fu">c</span>(<span class="st">&quot;[M+H]+&quot;</span>, <span class="st">&quot;[M+H]+&quot;</span>, <span class="st">&quot;[M+Na]+&quot;</span>))</span>
<span id="cb17-5"><a href="features.html#cb17-5" aria-hidden="true" tabindex="-1"></a>fGroupsSusp <span class="ot">&lt;-</span> <span class="fu">screenSuspects</span>(fGroups, suspects)</span></code></pre></div>
<p>To summarize:</p>
<ul>
<li>If a suspect has data in the <code>mz</code> column it will be directly matched with the <em>m/z</em> value of a feature group.</li>
<li>Otherwise, if the suspect has data in the <code>adduct</code> column, the <code>m/z</code> value for the suspect is calculated from its neutral mass and the adduct and then matched with the <code>m/z</code> of a feature group.</li>
<li>Otherwise, suspects and feature groups are matched by their the neutral mass.</li>
</ul>
<p>The <code>fragments_mz</code> and <code>fragments_formula</code> columns in the suspect list can be used to specify known fragments for a suspect, which can help <a href="annotation.html#suspAnn">suspect annotation</a>. The former specifies the ionized <em>m/z</em> of known MS/MS peaks, whereas the second specifies known formulas. Multiple values can be given by separating them with a semicolon:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="features.html#cb18-1" aria-hidden="true" tabindex="-1"></a>suspects <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;1H-benzotriazole&quot;</span>, <span class="st">&quot;N-Phenyl urea&quot;</span>, <span class="st">&quot;2-Hydroxyquinoline&quot;</span>),</span>
<span id="cb18-2"><a href="features.html#cb18-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">SMILES =</span> <span class="fu">c</span>(<span class="st">&quot;[nH]1nnc2ccccc12&quot;</span>, <span class="st">&quot;NC(=O)Nc1ccccc1&quot;</span>, <span class="st">&quot;Oc1ccc2ccccc2n1&quot;</span>),</span>
<span id="cb18-3"><a href="features.html#cb18-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fragments_formula =</span> <span class="fu">c</span>(<span class="st">&quot;C6H6N&quot;</span>, <span class="st">&quot;C6H8N;C7H6NO&quot;</span>, <span class="st">&quot;&quot;</span>),</span>
<span id="cb18-4"><a href="features.html#cb18-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fragments_mz =</span> <span class="fu">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;118.0652&quot;</span>))</span></code></pre></div>
</div>
<div id="removing-feature-groups-without-hits" class="section level4" number="4.2.2.2">
<h4><span class="header-section-number">4.2.2.2</span> Removing feature groups without hits</h4>
<p>Note that any feature groups that were not matched to a suspect are <em>not</em> removed by default. If you want to remove these, you can use the <code>onlyHits</code> parameter:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="features.html#cb19-1" aria-hidden="true" tabindex="-1"></a>fGroupsSusp <span class="ot">&lt;-</span> <span class="fu">screenSuspects</span>(fGroups, suspects, <span class="at">onlyHits =</span> <span class="cn">TRUE</span>) <span class="co"># remove any non-hits immediately</span></span></code></pre></div>
<p>The advantage of removing non-hits is that it may significantly reduce the complexity of your dataset. On the other hand, retaining all features allows you to mix a full non-target analysis with a suspect screening workflow. The <code>filter()</code> function (discussed <a href="filtering.html#filtering">here</a>) can also be used to remove feature groups without a hit at a later stage.</p>
</div>
<div id="combining-screening-results" class="section level4" number="4.2.2.3">
<h4><span class="header-section-number">4.2.2.3</span> Combining screening results</h4>
<p>The <code>amend</code> function argument to <code>screenSuspects</code> can be used to combine screening results from different suspect lists.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="features.html#cb20-1" aria-hidden="true" tabindex="-1"></a>fGroupsSusp <span class="ot">&lt;-</span> <span class="fu">screenSuspects</span>(fGroups, suspects)</span>
<span id="cb20-2"><a href="features.html#cb20-2" aria-hidden="true" tabindex="-1"></a>fGroupsSusp <span class="ot">&lt;-</span> <span class="fu">screenSuspects</span>(fGroupsSusp, suspects2, <span class="at">onlyHits =</span> <span class="cn">TRUE</span>, <span class="at">amend =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>In this example the suspect lists defined in <code>suspects</code> and <code>suspects2</code> are both used for screening. By setting <code>amend=TRUE</code> the original screening results (i.e. from <code>suspects</code>) are preserved. Note that <code>onlyHits</code> should only be set in the final call to <code>screenSuspects</code> to ensure that all feature groups are screened.</p>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="preparations.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="componentization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": false
}
});
});
</script>

</body>

</html>
