<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5.2 Filtering | patRoon handbook</title>
  <meta name="description" content="5.2 Filtering | patRoon handbook" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="5.2 Filtering | patRoon handbook" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5.2 Filtering | patRoon handbook" />
  
  
  

<meta name="author" content="Rick Helmus" />


<meta name="date" content="2022-09-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="inspecting-results.html"/>
<link rel="next" href="subset.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.9/grViz.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet" />
<script src="libs/vis-9.1.0/vis-network.min.js"></script>
<script src="libs/visNetwork-binding-2.1.0/visNetwork.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>2</b> Installation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="automatic-installation-windows-only.html"><a href="automatic-installation-windows-only.html"><i class="fa fa-check"></i><b>2.1</b> Automatic installation (Windows only)</a></li>
<li class="chapter" data-level="2.2" data-path="docker-image.html"><a href="docker-image.html"><i class="fa fa-check"></i><b>2.2</b> Docker image</a></li>
<li class="chapter" data-level="2.3" data-path="manual-installation.html"><a href="manual-installation.html"><i class="fa fa-check"></i><b>2.3</b> Manual installation</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="manual-installation.html"><a href="manual-installation.html#r-prerequisites"><i class="fa fa-check"></i><b>2.3.1</b> R prerequisites</a></li>
<li class="chapter" data-level="2.3.2" data-path="manual-installation.html"><a href="manual-installation.html#other-dependencies"><i class="fa fa-check"></i><b>2.3.2</b> Other dependencies</a></li>
<li class="chapter" data-level="2.3.3" data-path="manual-installation.html"><a href="manual-installation.html#patroon-installation"><i class="fa fa-check"></i><b>2.3.3</b> patRoon installation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="workflow-concepts.html"><a href="workflow-concepts.html"><i class="fa fa-check"></i><b>3</b> Workflow concepts</a></li>
<li class="chapter" data-level="4" data-path="generating-workflow-data.html"><a href="generating-workflow-data.html"><i class="fa fa-check"></i><b>4</b> Generating workflow data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i><b>4.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="introduction-1.html"><a href="introduction-1.html#workflow-functions"><i class="fa fa-check"></i><b>4.1.1</b> Workflow functions</a></li>
<li class="chapter" data-level="4.1.2" data-path="introduction-1.html"><a href="introduction-1.html#workflow-output"><i class="fa fa-check"></i><b>4.1.2</b> Workflow output</a></li>
<li class="chapter" data-level="4.1.3" data-path="introduction-1.html"><a href="introduction-1.html#overview-of-all-functions-and-their-output"><i class="fa fa-check"></i><b>4.1.3</b> Overview of all functions and their output</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="preparations.html"><a href="preparations.html"><i class="fa fa-check"></i><b>4.2</b> Preparations</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="preparations.html"><a href="preparations.html#data-pre-treatment"><i class="fa fa-check"></i><b>4.2.1</b> Data pre-treatment</a></li>
<li class="chapter" data-level="4.2.2" data-path="preparations.html"><a href="preparations.html#anaInfo"><i class="fa fa-check"></i><b>4.2.2</b> Analysis information</a></li>
<li class="chapter" data-level="4.2.3" data-path="preparations.html"><a href="preparations.html#newProject"><i class="fa fa-check"></i><b>4.2.3</b> Automatic project generation with newProject()</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="features.html"><a href="features.html"><i class="fa fa-check"></i><b>4.3</b> Features</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="features.html"><a href="features.html#finding-and-grouping-features"><i class="fa fa-check"></i><b>4.3.1</b> Finding and grouping features</a></li>
<li class="chapter" data-level="4.3.2" data-path="features.html"><a href="features.html#suspscr"><i class="fa fa-check"></i><b>4.3.2</b> Suspect screening</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="componentization.html"><a href="componentization.html"><i class="fa fa-check"></i><b>4.4</b> Componentization</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="componentization.html"><a href="componentization.html#componentsChrom"><i class="fa fa-check"></i><b>4.4.1</b> Features with similar chromatographic behaviour</a></li>
<li class="chapter" data-level="4.4.2" data-path="componentization.html"><a href="componentization.html#homologues-series"><i class="fa fa-check"></i><b>4.4.2</b> Homologues series</a></li>
<li class="chapter" data-level="4.4.3" data-path="componentization.html"><a href="componentization.html#compClust"><i class="fa fa-check"></i><b>4.4.3</b> Intensity and MS/MS similarity</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="incorpAdductIso.html"><a href="incorpAdductIso.html"><i class="fa fa-check"></i><b>4.5</b> Incorporating adduct and isotopic data</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="incorpAdductIso.html"><a href="incorpAdductIso.html#selecting-features-with-preferential-adductsisotopes"><i class="fa fa-check"></i><b>4.5.1</b> Selecting features with preferential adducts/isotopes</a></li>
<li class="chapter" data-level="4.5.2" data-path="incorpAdductIso.html"><a href="incorpAdductIso.html#setting-adduct-annotations-for-feature-groups"><i class="fa fa-check"></i><b>4.5.2</b> Setting adduct annotations for feature groups</a></li>
<li class="chapter" data-level="4.5.3" data-path="incorpAdductIso.html"><a href="incorpAdductIso.html#useAdductAnn"><i class="fa fa-check"></i><b>4.5.3</b> Using adduct annotations in the workflow</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="annotation.html"><a href="annotation.html"><i class="fa fa-check"></i><b>4.6</b> Annotation</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="annotation.html"><a href="annotation.html#ms-peak-lists"><i class="fa fa-check"></i><b>4.6.1</b> MS peak lists</a></li>
<li class="chapter" data-level="4.6.2" data-path="annotation.html"><a href="annotation.html#formulae"><i class="fa fa-check"></i><b>4.6.2</b> Formulae</a></li>
<li class="chapter" data-level="4.6.3" data-path="annotation.html"><a href="annotation.html#compounds"><i class="fa fa-check"></i><b>4.6.3</b> Compounds</a></li>
<li class="chapter" data-level="4.6.4" data-path="annotation.html"><a href="annotation.html#suspAnn"><i class="fa fa-check"></i><b>4.6.4</b> Suspect annotation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="processing.html"><a href="processing.html"><i class="fa fa-check"></i><b>5</b> Processing workflow data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="inspecting-results.html"><a href="inspecting-results.html"><i class="fa fa-check"></i><b>5.1</b> Inspecting results</a></li>
<li class="chapter" data-level="5.2" data-path="filtering.html"><a href="filtering.html"><i class="fa fa-check"></i><b>5.2</b> Filtering</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="filtering.html"><a href="filtering.html#features-1"><i class="fa fa-check"></i><b>5.2.1</b> Features</a></li>
<li class="chapter" data-level="5.2.2" data-path="filtering.html"><a href="filtering.html#suspect-screening"><i class="fa fa-check"></i><b>5.2.2</b> Suspect screening</a></li>
<li class="chapter" data-level="5.2.3" data-path="filtering.html"><a href="filtering.html#annotation-1"><i class="fa fa-check"></i><b>5.2.3</b> Annotation</a></li>
<li class="chapter" data-level="5.2.4" data-path="filtering.html"><a href="filtering.html#components"><i class="fa fa-check"></i><b>5.2.4</b> Components</a></li>
<li class="chapter" data-level="5.2.5" data-path="filtering.html"><a href="filtering.html#negation"><i class="fa fa-check"></i><b>5.2.5</b> Negation</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="subset.html"><a href="subset.html"><i class="fa fa-check"></i><b>5.3</b> Subsetting</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="subset.html"><a href="subset.html#prioritization-workflow"><i class="fa fa-check"></i><b>5.3.1</b> Prioritization workflow</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="deleting-data.html"><a href="deleting-data.html"><i class="fa fa-check"></i><b>5.4</b> Deleting data</a></li>
<li class="chapter" data-level="5.5" data-path="unOv.html"><a href="unOv.html"><i class="fa fa-check"></i><b>5.5</b> Unique and overlapping features</a></li>
<li class="chapter" data-level="5.6" data-path="specSim.html"><a href="specSim.html"><i class="fa fa-check"></i><b>5.6</b> MS similarity</a></li>
<li class="chapter" data-level="5.7" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>5.7</b> Visualization</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="visualization.html"><a href="visualization.html#vis_feat_ann"><i class="fa fa-check"></i><b>5.7.1</b> Features and annatation data</a></li>
<li class="chapter" data-level="5.7.2" data-path="visualization.html"><a href="visualization.html#visComp"><i class="fa fa-check"></i><b>5.7.2</b> Overlapping and unique data</a></li>
<li class="chapter" data-level="5.7.3" data-path="visualization.html"><a href="visualization.html#ms-similarity"><i class="fa fa-check"></i><b>5.7.3</b> MS similarity</a></li>
<li class="chapter" data-level="5.7.4" data-path="visualization.html"><a href="visualization.html#plotClust"><i class="fa fa-check"></i><b>5.7.4</b> Hierarchical clustering results</a></li>
<li class="chapter" data-level="5.7.5" data-path="visualization.html"><a href="visualization.html#generating-eics-in-dataanalysis"><i class="fa fa-check"></i><b>5.7.5</b> Generating EICs in DataAnalysis</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="intReview.html"><a href="intReview.html"><i class="fa fa-check"></i><b>5.8</b> Interactively explore and review data</a></li>
<li class="chapter" data-level="5.9" data-path="report.html"><a href="report.html"><i class="fa fa-check"></i><b>5.9</b> Reporting</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="setsWorkflow.html"><a href="setsWorkflow.html"><i class="fa fa-check"></i><b>6</b> Sets workflows</a>
<ul>
<li class="chapter" data-level="6.1" data-path="initiating-a-sets-workflow.html"><a href="initiating-a-sets-workflow.html"><i class="fa fa-check"></i><b>6.1</b> Initiating a sets workflow</a></li>
<li class="chapter" data-level="6.2" data-path="generating-sets-workflow-data.html"><a href="generating-sets-workflow-data.html"><i class="fa fa-check"></i><b>6.2</b> Generating sets workflow data</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="generating-sets-workflow-data.html"><a href="generating-sets-workflow-data.html#componentization-1"><i class="fa fa-check"></i><b>6.2.1</b> Componentization</a></li>
<li class="chapter" data-level="6.2.2" data-path="generating-sets-workflow-data.html"><a href="generating-sets-workflow-data.html#formula-and-compound-annotation"><i class="fa fa-check"></i><b>6.2.2</b> Formula and compound annotation</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="setsAdducts.html"><a href="setsAdducts.html"><i class="fa fa-check"></i><b>6.3</b> Selecting adducts to improve grouping</a></li>
<li class="chapter" data-level="6.4" data-path="processing-data.html"><a href="processing-data.html"><i class="fa fa-check"></i><b>6.4</b> Processing data</a></li>
<li class="chapter" data-level="6.5" data-path="advanced.html"><a href="advanced.html"><i class="fa fa-check"></i><b>6.5</b> Advanced</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="advanced.html"><a href="advanced.html#initiating-a-sets-workflow-from-feature-groups"><i class="fa fa-check"></i><b>6.5.1</b> Initiating a sets workflow from feature groups</a></li>
<li class="chapter" data-level="6.5.2" data-path="advanced.html"><a href="advanced.html#inspecting-and-converting-set-objects"><i class="fa fa-check"></i><b>6.5.2</b> Inspecting and converting set objects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="TPs.html"><a href="TPs.html"><i class="fa fa-check"></i><b>7</b> Transformation product screening</a>
<ul>
<li class="chapter" data-level="7.1" data-path="genTPs.html"><a href="genTPs.html"><i class="fa fa-check"></i><b>7.1</b> Obtaining transformation product data</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="genTPs.html"><a href="genTPs.html#parent-input"><i class="fa fa-check"></i><b>7.1.1</b> Parent input</a></li>
<li class="chapter" data-level="7.1.2" data-path="genTPs.html"><a href="genTPs.html#processing-data-1"><i class="fa fa-check"></i><b>7.1.2</b> Processing data</a></li>
<li class="chapter" data-level="7.1.3" data-path="genTPs.html"><a href="genTPs.html#TPsCustom"><i class="fa fa-check"></i><b>7.1.3</b> (Custom) Libraries and transformations</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="linking-parent-and-transformation-product-features.html"><a href="linking-parent-and-transformation-product-features.html"><i class="fa fa-check"></i><b>7.2</b> Linking parent and transformation product features</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="linking-parent-and-transformation-product-features.html"><a href="linking-parent-and-transformation-product-features.html#componentization-2"><i class="fa fa-check"></i><b>7.2.1</b> Componentization</a></li>
<li class="chapter" data-level="7.2.2" data-path="linking-parent-and-transformation-product-features.html"><a href="linking-parent-and-transformation-product-features.html#TPsProc"><i class="fa fa-check"></i><b>7.2.2</b> Processing data</a></li>
<li class="chapter" data-level="7.2.3" data-path="linking-parent-and-transformation-product-features.html"><a href="linking-parent-and-transformation-product-features.html#omitting-transformation-product-input"><i class="fa fa-check"></i><b>7.2.3</b> Omitting transformation product input</a></li>
<li class="chapter" data-level="7.2.4" data-path="linking-parent-and-transformation-product-features.html"><a href="linking-parent-and-transformation-product-features.html#reporting-tp-components"><i class="fa fa-check"></i><b>7.2.4</b> Reporting TP components</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="TPsExamples.html"><a href="TPsExamples.html"><i class="fa fa-check"></i><b>7.3</b> Example workflows</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="TPsExamples.html"><a href="TPsExamples.html#TPsEx1"><i class="fa fa-check"></i><b>7.3.1</b> Screen predicted TPs for targets</a></li>
<li class="chapter" data-level="7.3.2" data-path="TPsExamples.html"><a href="TPsExamples.html#TPsEx2"><i class="fa fa-check"></i><b>7.3.2</b> Screening TPs from a library for suspects</a></li>
<li class="chapter" data-level="7.3.3" data-path="TPsExamples.html"><a href="TPsExamples.html#TPsEx3"><i class="fa fa-check"></i><b>7.3.3</b> Non-target screening of predicted TPs</a></li>
<li class="chapter" data-level="7.3.4" data-path="TPsExamples.html"><a href="TPsExamples.html#TPsEx4"><i class="fa fa-check"></i><b>7.3.4</b> Non-target screening of TPs by annotation similarities</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="advanced_usage.html"><a href="advanced_usage.html"><i class="fa fa-check"></i><b>8</b> Advanced usage</a>
<ul>
<li class="chapter" data-level="8.1" data-path="adducts.html"><a href="adducts.html"><i class="fa fa-check"></i><b>8.1</b> Adducts</a></li>
<li class="chapter" data-level="8.2" data-path="fNorm.html"><a href="fNorm.html"><i class="fa fa-check"></i><b>8.2</b> Feature intensity normalization</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="fNorm.html"><a href="fNorm.html#feature-normalization"><i class="fa fa-check"></i><b>8.2.1</b> Feature normalization</a></li>
<li class="chapter" data-level="8.2.2" data-path="fNorm.html"><a href="fNorm.html#group-normalization"><i class="fa fa-check"></i><b>8.2.2</b> Group normalization</a></li>
<li class="chapter" data-level="8.2.3" data-path="fNorm.html"><a href="fNorm.html#using-normalized-intensities"><i class="fa fa-check"></i><b>8.2.3</b> Using normalized intensities</a></li>
<li class="chapter" data-level="8.2.4" data-path="fNorm.html"><a href="fNorm.html#default-normalization"><i class="fa fa-check"></i><b>8.2.4</b> Default normalization</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="fOpt.html"><a href="fOpt.html"><i class="fa fa-check"></i><b>8.3</b> Feature parameter optimization</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="fOpt.html"><a href="fOpt.html#parameter-sets"><i class="fa fa-check"></i><b>8.3.1</b> Parameter sets</a></li>
<li class="chapter" data-level="8.3.2" data-path="fOpt.html"><a href="fOpt.html#processing-optmization-results"><i class="fa fa-check"></i><b>8.3.2</b> Processing optmization results</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="peakQual.html"><a href="peakQual.html"><i class="fa fa-check"></i><b>8.4</b> Chromatographic peak qualities</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="peakQual.html"><a href="peakQual.html#applying-machine-learning-with-metaclean"><i class="fa fa-check"></i><b>8.4.1</b> Applying machine learning with MetaClean</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="exporting-and-converting-feature-data.html"><a href="exporting-and-converting-feature-data.html"><i class="fa fa-check"></i><b>8.5</b> Exporting and converting feature data</a></li>
<li class="chapter" data-level="8.6" data-path="consensus.html"><a href="consensus.html"><i class="fa fa-check"></i><b>8.6</b> Algorithm consensus</a></li>
<li class="chapter" data-level="8.7" data-path="MSLibraries.html"><a href="MSLibraries.html"><i class="fa fa-check"></i><b>8.7</b> MS libraries</a></li>
<li class="chapter" data-level="8.8" data-path="compclust.html"><a href="compclust.html"><i class="fa fa-check"></i><b>8.8</b> Compound clustering</a></li>
<li class="chapter" data-level="8.9" data-path="basic-quantitative-and-regression-analysis.html"><a href="basic-quantitative-and-regression-analysis.html"><i class="fa fa-check"></i><b>8.9</b> Basic quantitative and regression analysis</a></li>
<li class="chapter" data-level="8.10" data-path="FCCalc.html"><a href="FCCalc.html"><i class="fa fa-check"></i><b>8.10</b> Fold changes</a></li>
<li class="chapter" data-level="8.11" data-path="caching.html"><a href="caching.html"><i class="fa fa-check"></i><b>8.11</b> Caching</a></li>
<li class="chapter" data-level="8.12" data-path="parallelization.html"><a href="parallelization.html"><i class="fa fa-check"></i><b>8.12</b> Parallelization</a>
<ul>
<li class="chapter" data-level="8.12.1" data-path="parallelization.html"><a href="parallelization.html#parellization-of-r-functions"><i class="fa fa-check"></i><b>8.12.1</b> Parellization of R functions</a></li>
<li class="chapter" data-level="8.12.2" data-path="parallelization.html"><a href="parallelization.html#multiprocessing"><i class="fa fa-check"></i><b>8.12.2</b> Multiprocessing</a></li>
<li class="chapter" data-level="8.12.3" data-path="parallelization.html"><a href="parallelization.html#notes-when-using-parallelization-with-futures"><i class="fa fa-check"></i><b>8.12.3</b> Notes when using parallelization with futures</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>9</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">patRoon handbook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="filtering" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Filtering<a href="filtering.html#filtering" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>During a non-target workflow it is not uncommon that some kind of data-cleanup is necessary. Datasets are often highly complex, which makes separating data of interest from the rest highly important. Furthermore, general cleanup typically improves the quality of the dataset, for instance by removing low scoring annotation results or features that are unlikely to be ‘correct’ (e.g. noise or present in blanks). For this reason <code>patRoon</code> supports <em>many</em> different filters that easily clean data produced during the workflow in a highly customizable way.</p>
<p>All major workflow objects (e.g. <code>featureGroups</code>, <code>compounds</code>, <code>components</code> etc.) support filtering operations by the <code>filter()</code> generic. This function takes the object to be filtered as first argument and any remaining arguments describe the desired filter options. The <code>filter()</code> generic function then returns the modified object back. Some examples are shown below.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="filtering.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove low intensity (&lt;500) features</span></span>
<span id="cb76-2"><a href="filtering.html#cb76-2" aria-hidden="true" tabindex="-1"></a>features <span class="ot">&lt;-</span> <span class="fu">filter</span>(features, <span class="at">absMinIntensity =</span> <span class="dv">500</span>)</span>
<span id="cb76-3"><a href="filtering.html#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="filtering.html#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co"># remove features with intensities lower than 5 times the blank</span></span>
<span id="cb76-5"><a href="filtering.html#cb76-5" aria-hidden="true" tabindex="-1"></a>fGroups <span class="ot">&lt;-</span> <span class="fu">filter</span>(fGroups, <span class="at">blankThreshold =</span> <span class="dv">5</span>)</span>
<span id="cb76-6"><a href="filtering.html#cb76-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-7"><a href="filtering.html#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="co"># only retain compounds with &gt;1 explained MS/MS peaks</span></span>
<span id="cb76-8"><a href="filtering.html#cb76-8" aria-hidden="true" tabindex="-1"></a>compounds <span class="ot">&lt;-</span> <span class="fu">filter</span>(compounds, <span class="at">minExplainedPeaks =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>The following sections will provide a more detailed overview of available data filters.</p>
<blockquote>
<p><strong><em>NOTE</em></strong> Some other <code>R</code> packages (notably <code>dplyr</code>) also provide a <code>filter()</code> generic function. To use the <code>filter()</code> function from different packages you may need to explicitly specify which one to use in your script. This can be done by prefixing it with the package name, e.g. <code>patRoon::filter(...)</code>, <code>dplyr::filter(...)</code> etc.</p>
</blockquote>
<div id="features-1" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Features<a href="filtering.html#features-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are many filters available for feature data:</p>
<table>
<colgroup>
<col width="33%" />
<col width="21%" />
<col width="45%" />
</colgroup>
<thead>
<tr class="header">
<th>Filter</th>
<th>Classes</th>
<th>Remarks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>absMinIntensity</code>, <code>relMinIntensity</code></td>
<td><code>features</code>, <code>featureGroups</code></td>
<td>Minimum intensity</td>
</tr>
<tr class="even">
<td><code>preAbsMinIntensity</code>, <code>preRelMinIntensity</code></td>
<td><code>featureGroups</code></td>
<td>Minimum intensity prior to other filtering (see below)</td>
</tr>
<tr class="odd">
<td><code>retentionRange</code>, <code>mzRange</code>, <code>mzDefectRange</code>, <code>chromWidthRange</code></td>
<td><code>features</code>, <code>featureGroups</code></td>
<td>Filter by feature properties</td>
</tr>
<tr class="even">
<td><code>absMinAnalyses</code>, <code>relMinAnalyses</code></td>
<td><code>featureGroups</code></td>
<td>Minimum feature abundance in all analyses</td>
</tr>
<tr class="odd">
<td><code>absMinReplicates</code>, <code>relMinReplicates</code></td>
<td><code>featureGroups</code></td>
<td>Minimum feature abundance in different replicates</td>
</tr>
<tr class="even">
<td><code>absMinFeatures</code>, <code>relMinFeatures</code></td>
<td><code>featureGroups</code></td>
<td>Only keep analyses with at least this amount of features</td>
</tr>
<tr class="odd">
<td><code>absMinReplicateAbundance</code>, <code>relMinReplicateAbundance</code></td>
<td><code>featureGroups</code></td>
<td>Minimum feature abundance in a replicate group</td>
</tr>
<tr class="even">
<td><code>maxReplicateIntRSD</code></td>
<td><code>featureGroups</code></td>
<td>Maximum relative standard deviation of feature intensities in a replicate group.</td>
</tr>
<tr class="odd">
<td><code>blankThreshold</code></td>
<td><code>featureGroups</code></td>
<td>Minimum intensity factor above blank intensity</td>
</tr>
<tr class="even">
<td><code>rGroups</code></td>
<td><code>featureGroups</code></td>
<td>Only keep (features of) these replicate groups</td>
</tr>
<tr class="odd">
<td><code>results</code></td>
<td><code>featureGroups</code></td>
<td>Only keep feature groups with formula/compound annotations or componentization results</td>
</tr>
</tbody>
</table>
<p>Application of filters to feature data is important for (environmental) non-target analysis. Especially blank and replicate filters (i.e. <code>blankThreshold</code> and <code>absMinReplicateAbundance</code>/<code>relMinReplicateAbundance</code>) are important filters and are highly recommended to always apply for cleaning up your dataset.</p>
<p>All filters are available for feature group data, whereas only a subset is available for feature objects. The main reason is that other filters need grouping of features between analyses. Regardless, in <code>patRoon</code> filtering feature data is less important, and typically only needed when the number of features are extremely large and direct grouping is undesired.</p>
<p>From the table above you can notice that many filters concern both <em>absolute</em> and <em>relative</em> data (i.e. as prefixed with <code>abs</code> and <code>rel</code>). When a relative filter is used the value is scaled between <em>0</em> and <em>1</em>. For instance:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="filtering.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove features not present in at least half of the analyses within a replicate group</span></span>
<span id="cb77-2"><a href="filtering.html#cb77-2" aria-hidden="true" tabindex="-1"></a>fGroups <span class="ot">&lt;-</span> <span class="fu">filter</span>(fGroups, <span class="at">relMinReplicateAbundance =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p>An advantage of relative filters is that you will not have to worry about the data size involved. For instance, in the above example the filter always takes half of the number of analyses within a replicate group, even when replicate groups have different number of analyses.</p>
<p>Note that multiple filters can be specified at once. Especially for feature group data the order of filtering may impact the final results, this is explained further in the reference manual (i.e. <code>?`feature-filtering`</code>).</p>
<p>Some examples are shown below.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="filtering.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># filter features prior to grouping: remove any features eluting before first 2 minutes</span></span>
<span id="cb78-2"><a href="filtering.html#cb78-2" aria-hidden="true" tabindex="-1"></a>fList <span class="ot">&lt;-</span> <span class="fu">filter</span>(fList, <span class="at">retentionRange =</span> <span class="fu">c</span>(<span class="dv">120</span>, <span class="cn">Inf</span>))</span>
<span id="cb78-3"><a href="filtering.html#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="filtering.html#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="co"># common filters for feature groups</span></span>
<span id="cb78-5"><a href="filtering.html#cb78-5" aria-hidden="true" tabindex="-1"></a>fGroups <span class="ot">&lt;-</span> <span class="fu">filter</span>(fGroups,</span>
<span id="cb78-6"><a href="filtering.html#cb78-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">absMinIntensity =</span> <span class="dv">500</span>, <span class="co"># remove features &lt;500 intensity</span></span>
<span id="cb78-7"><a href="filtering.html#cb78-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">relMinReplicateAbundance =</span> <span class="dv">1</span>, <span class="co"># features should be in all analysis of replicate groups</span></span>
<span id="cb78-8"><a href="filtering.html#cb78-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">maxReplicateIntRSD =</span> <span class="fl">0.75</span>, <span class="co"># remove features with intensity RSD in replicates &gt;75%</span></span>
<span id="cb78-9"><a href="filtering.html#cb78-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">blankThreshold =</span> <span class="dv">5</span>, <span class="co"># remove features &lt;5x intensity of (average) blank intensity</span></span>
<span id="cb78-10"><a href="filtering.html#cb78-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">removeBlanks =</span> <span class="cn">TRUE</span>) <span class="co"># remove blank analyses from object afterwards</span></span>
<span id="cb78-11"><a href="filtering.html#cb78-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-12"><a href="filtering.html#cb78-12" aria-hidden="true" tabindex="-1"></a><span class="co"># filter by feature properties</span></span>
<span id="cb78-13"><a href="filtering.html#cb78-13" aria-hidden="true" tabindex="-1"></a>fGroups <span class="ot">&lt;-</span> <span class="fu">filter</span>(<span class="at">mzDefectRange =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.9</span>),</span>
<span id="cb78-14"><a href="filtering.html#cb78-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">chromWidthRange =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">120</span>))</span>
<span id="cb78-15"><a href="filtering.html#cb78-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-16"><a href="filtering.html#cb78-16" aria-hidden="true" tabindex="-1"></a><span class="co"># remove features not present in at least 3 analyses</span></span>
<span id="cb78-17"><a href="filtering.html#cb78-17" aria-hidden="true" tabindex="-1"></a>fGroups <span class="ot">&lt;-</span> <span class="fu">filter</span>(fGroups, <span class="at">absMinAnalyses =</span> <span class="dv">3</span>)</span>
<span id="cb78-18"><a href="filtering.html#cb78-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-19"><a href="filtering.html#cb78-19" aria-hidden="true" tabindex="-1"></a><span class="co"># remove features not present in at least 20% of all replicate groups</span></span>
<span id="cb78-20"><a href="filtering.html#cb78-20" aria-hidden="true" tabindex="-1"></a>fGroups <span class="ot">&lt;-</span> <span class="fu">filter</span>(fGroups, <span class="at">relMinReplicates =</span> <span class="fl">0.2</span>)</span>
<span id="cb78-21"><a href="filtering.html#cb78-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-22"><a href="filtering.html#cb78-22" aria-hidden="true" tabindex="-1"></a><span class="co"># only keep data present in replicate groups &quot;repl1&quot; and &quot;repl2&quot;</span></span>
<span id="cb78-23"><a href="filtering.html#cb78-23" aria-hidden="true" tabindex="-1"></a><span class="co"># all other features and analyses will be removed</span></span>
<span id="cb78-24"><a href="filtering.html#cb78-24" aria-hidden="true" tabindex="-1"></a>fGroups <span class="ot">&lt;-</span> <span class="fu">filter</span>(fGroups, <span class="at">rGroups =</span> <span class="fu">c</span>(<span class="st">&quot;repl1&quot;</span>, <span class="st">&quot;repl2&quot;</span>))</span>
<span id="cb78-25"><a href="filtering.html#cb78-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-26"><a href="filtering.html#cb78-26" aria-hidden="true" tabindex="-1"></a><span class="co"># only keep feature groups with compound annotations</span></span>
<span id="cb78-27"><a href="filtering.html#cb78-27" aria-hidden="true" tabindex="-1"></a>fGroups <span class="ot">&lt;-</span> <span class="fu">filter</span>(fGroups, <span class="at">results =</span> compounds)</span>
<span id="cb78-28"><a href="filtering.html#cb78-28" aria-hidden="true" tabindex="-1"></a><span class="co"># only keep feature groups with formula or compound annotations</span></span>
<span id="cb78-29"><a href="filtering.html#cb78-29" aria-hidden="true" tabindex="-1"></a>fGroups <span class="ot">&lt;-</span> <span class="fu">filter</span>(fGroups, <span class="at">results =</span> <span class="fu">list</span>(formulas, compounds))</span></code></pre></div>
</div>
<div id="suspect-screening" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Suspect screening<a href="filtering.html#suspect-screening" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Several additional filters are available for feature groups obtained with <code>screenSuspects()</code>:</p>
<table>
<colgroup>
<col width="33%" />
<col width="19%" />
<col width="46%" />
</colgroup>
<thead>
<tr class="header">
<th>Filter</th>
<th>Classes</th>
<th>Remarks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>onlyHits</code></td>
<td><code>featureGroupsScreening</code></td>
<td>Only retain feature groups assigned to one or more suspects.</td>
</tr>
<tr class="even">
<td><code>selectHitsBy</code></td>
<td><code>featureGroupsScreening</code></td>
<td>Select the feature group that matches best with a suspect (in case there are multiple).</td>
</tr>
<tr class="odd">
<td><code>selectBestFGroups</code></td>
<td><code>featureGroupsScreening</code></td>
<td>Select the suspect that matches best with a feature group (in case there are multiple).</td>
</tr>
<tr class="even">
<td><code>maxLevel</code>, <code>maxFormRank</code>, <code>maxCompRank</code></td>
<td><code>featureGroupsScreening</code></td>
<td>Only retain suspect hits with identification/annotation ranks below a threshold.</td>
</tr>
<tr class="odd">
<td><code>minAnnSimForm</code>, <code>minAnnSimComp</code>, <code>minAnnSimBoth</code></td>
<td><code>featureGroupsScreening</code></td>
<td>Remove suspect hits with annotation similarity scores below this value.</td>
</tr>
<tr class="even">
<td><code>absMinFragMatches</code>, <code>relMinFragMatches</code></td>
<td><code>featureGroupsScreening</code></td>
<td>Only keep suspect hits with a minimum (relative) number of fragment matches from the suspect list.</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong><em>NOTE</em></strong>: most filters only remove suspect hit results. Set <code>onlyHits=TRUE</code> to also remove any feature groups that end up without suspect hits.</p>
</blockquote>
<p>The <code>selectHitsBy</code> and <code>selectBestFGroups</code> filters are useful to remove duplicate hits (one suspect assigned to multiple feature groups or multiple feature groups assigned to the same suspect, respectively). The former selects based on either best identification level (<code>selectHitsBy="level"</code>) or highest mean intensity (<code>selectHitsBy="intensity"</code>). The <code>selectBestFGroups</code> can only be <code>TRUE</code>/<code>FALSE</code> and always selects by best identification level.</p>
<p>Some examples are shown below.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="filtering.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># only keep feature groups assigned to at least one suspect</span></span>
<span id="cb79-2"><a href="filtering.html#cb79-2" aria-hidden="true" tabindex="-1"></a>fGroupsSusp <span class="ot">&lt;-</span> <span class="fu">filter</span>(fGroupsSusp, <span class="at">onlyHits =</span> <span class="cn">TRUE</span>)</span>
<span id="cb79-3"><a href="filtering.html#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co"># remove duplicate suspect to feature group matches and keep the best</span></span>
<span id="cb79-4"><a href="filtering.html#cb79-4" aria-hidden="true" tabindex="-1"></a>fGroupsSusp <span class="ot">&lt;-</span> <span class="fu">filter</span>(fGroupsSusp, <span class="at">selectHitsBy =</span> <span class="st">&quot;level&quot;</span>)</span>
<span id="cb79-5"><a href="filtering.html#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="co"># remove suspect hits with ID levels &gt;3 and make sure no feature groups</span></span>
<span id="cb79-6"><a href="filtering.html#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="co"># are present without suspect hits afterwards</span></span>
<span id="cb79-7"><a href="filtering.html#cb79-7" aria-hidden="true" tabindex="-1"></a>fGroupsSusp <span class="ot">&lt;-</span> <span class="fu">filter</span>(fGroupsSusp, <span class="at">maxLevel =</span> <span class="dv">3</span>, <span class="at">onlyHits =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="annotation-1" class="section level3 hasAnchor" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Annotation<a href="filtering.html#annotation-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are various filters available for handling annotation data:</p>
<table>
<colgroup>
<col width="36%" />
<col width="24%" />
<col width="39%" />
</colgroup>
<thead>
<tr class="header">
<th>Filter</th>
<th>Classes</th>
<th>Remarks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>absMSIntThr</code>, <code>absMSMSIntThr</code>, <code>relMSIntThr</code>, <code>relMSMSIntThr</code></td>
<td><code>MSPeakLists</code></td>
<td>Minimum intensity of mass peaks</td>
</tr>
<tr class="even">
<td><code>topMSPeaks</code>, <code>topMSMSPeaks</code></td>
<td><code>MSPeakLists</code></td>
<td>Only keep most intense mass peaks</td>
</tr>
<tr class="odd">
<td><code>withMSMS</code></td>
<td><code>MSPeakLists</code></td>
<td>Only keep results with MS/MS data</td>
</tr>
<tr class="even">
<td><code>minMSMSPeaks</code></td>
<td><code>MSPeakLists</code></td>
<td>Only keep an MS/MS peak list if it contains a minimum number of peaks (excluding the precursor peak)</td>
</tr>
<tr class="odd">
<td><code>annotatedBy</code></td>
<td><code>MSPeakLists</code></td>
<td>Only keep MS/MS peaks that have formula or compound annotations</td>
</tr>
<tr class="even">
<td><code>minExplainedPeaks</code></td>
<td><code>formulas</code>, <code>compounds</code></td>
<td>Minimum number of annotated mass peaks</td>
</tr>
<tr class="odd">
<td><code>elements</code>, <code>fragElements</code>, <code>lossElements</code></td>
<td><code>formulas</code>, <code>compounds</code></td>
<td>Restrain elemental composition</td>
</tr>
<tr class="even">
<td><code>topMost</code></td>
<td><code>formulas</code>, <code>compounds</code></td>
<td>Only keep highest ranked candidates</td>
</tr>
<tr class="odd">
<td><code>minScore</code>, <code>minFragScore</code>, <code>minFormulaScore</code></td>
<td><code>compounds</code></td>
<td>Minimum compound scorings</td>
</tr>
<tr class="even">
<td><code>scoreLimits</code></td>
<td><code>formulas</code>, <code>compounds</code></td>
<td>Minimum/Maximum scorings</td>
</tr>
<tr class="odd">
<td><code>OM</code></td>
<td><code>formulas</code>, <code>compounds</code></td>
<td>Only keep candidates with likely elemental composition found in organic matter</td>
</tr>
</tbody>
</table>
<p>Several intensity related filters are available to clean-up MS peak list data. For instance, the <code>topMSPeaks</code>/<code>topMSMSPeaks</code> filters provide a simple way to remove noisy data by only retaining a defined number of most intense mass peaks. Note that none of these filters will remove the precursor mass peak of the feature itself.</p>
<p>The filters applicable to formula and compound annotation generally concern minimal scoring or chemical properties. The former is useful to remove unlikely candidates, whereas the second is useful to focus on certain study specific chemical properties (e.g. known neutral losses).</p>
<p>Common examples are shown below.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="filtering.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># intensity filtering</span></span>
<span id="cb80-2"><a href="filtering.html#cb80-2" aria-hidden="true" tabindex="-1"></a>mslists <span class="ot">&lt;-</span> <span class="fu">filter</span>(mslists,</span>
<span id="cb80-3"><a href="filtering.html#cb80-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">absMSIntThr =</span> <span class="dv">500</span>, <span class="co"># minimum MS mass peak intensity of 500</span></span>
<span id="cb80-4"><a href="filtering.html#cb80-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">relMSMSIntThr =</span> <span class="fl">0.1</span>) <span class="co"># minimum MS/MS mass peak intensity of 10%</span></span>
<span id="cb80-5"><a href="filtering.html#cb80-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-6"><a href="filtering.html#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="co"># only retain 10 most intens mass peaks</span></span>
<span id="cb80-7"><a href="filtering.html#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="co"># (feature mass is always retained)</span></span>
<span id="cb80-8"><a href="filtering.html#cb80-8" aria-hidden="true" tabindex="-1"></a>mslists <span class="ot">&lt;-</span> <span class="fu">filter</span>(mslists, <span class="at">topMSPeaks =</span> <span class="dv">10</span>)</span>
<span id="cb80-9"><a href="filtering.html#cb80-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-10"><a href="filtering.html#cb80-10" aria-hidden="true" tabindex="-1"></a><span class="co"># remove MS/MS peaks without compound annotations</span></span>
<span id="cb80-11"><a href="filtering.html#cb80-11" aria-hidden="true" tabindex="-1"></a>mslists <span class="ot">&lt;-</span> <span class="fu">filter</span>(mslists, <span class="at">annotatedBy =</span> compounds)</span>
<span id="cb80-12"><a href="filtering.html#cb80-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-13"><a href="filtering.html#cb80-13" aria-hidden="true" tabindex="-1"></a><span class="co"># remove MS/MS peaks not annotated by either a formula or compound candidate</span></span>
<span id="cb80-14"><a href="filtering.html#cb80-14" aria-hidden="true" tabindex="-1"></a>mslists <span class="ot">&lt;-</span> <span class="fu">filter</span>(mslists, <span class="at">annotatedBy =</span> <span class="fu">list</span>(formulas, compounds))</span>
<span id="cb80-15"><a href="filtering.html#cb80-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-16"><a href="filtering.html#cb80-16" aria-hidden="true" tabindex="-1"></a><span class="co"># only keep formulae with 1-10 sulphur or phosphorus elements</span></span>
<span id="cb80-17"><a href="filtering.html#cb80-17" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">filter</span>(formulas, <span class="at">elements =</span> <span class="fu">c</span>(<span class="st">&quot;S1-10&quot;</span>, <span class="st">&quot;P1-10&quot;</span>))</span>
<span id="cb80-18"><a href="filtering.html#cb80-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-19"><a href="filtering.html#cb80-19" aria-hidden="true" tabindex="-1"></a><span class="co"># only keep candidates with MS/MS fragments that contain 1-10 carbons and 0-2 oxygens</span></span>
<span id="cb80-20"><a href="filtering.html#cb80-20" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">filter</span>(formulas, <span class="at">fragElements =</span> <span class="st">&quot;C1-10O0-2&quot;</span>)</span>
<span id="cb80-21"><a href="filtering.html#cb80-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-22"><a href="filtering.html#cb80-22" aria-hidden="true" tabindex="-1"></a><span class="co"># only keep candidates with CO2 neutral loss</span></span>
<span id="cb80-23"><a href="filtering.html#cb80-23" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">filter</span>(formulas, <span class="at">lossElements =</span> <span class="st">&quot;CO2&quot;</span>)</span>
<span id="cb80-24"><a href="filtering.html#cb80-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-25"><a href="filtering.html#cb80-25" aria-hidden="true" tabindex="-1"></a><span class="co"># only keep the 15 highest ranked candidates with at least 1 annotated MS/MS peak</span></span>
<span id="cb80-26"><a href="filtering.html#cb80-26" aria-hidden="true" tabindex="-1"></a>compounds <span class="ot">&lt;-</span> <span class="fu">filter</span>(compounds, <span class="at">minExplainedPeaks =</span> <span class="dv">1</span>, <span class="at">topMost =</span> <span class="dv">15</span>)</span>
<span id="cb80-27"><a href="filtering.html#cb80-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-28"><a href="filtering.html#cb80-28" aria-hidden="true" tabindex="-1"></a><span class="co"># minimum in-silico score</span></span>
<span id="cb80-29"><a href="filtering.html#cb80-29" aria-hidden="true" tabindex="-1"></a>compounds <span class="ot">&lt;-</span> <span class="fu">filter</span>(compounds, <span class="at">minFragScore =</span> <span class="dv">10</span>)</span>
<span id="cb80-30"><a href="filtering.html#cb80-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-31"><a href="filtering.html#cb80-31" aria-hidden="true" tabindex="-1"></a><span class="co"># candidate should be referenced in at least 1 patent</span></span>
<span id="cb80-32"><a href="filtering.html#cb80-32" aria-hidden="true" tabindex="-1"></a><span class="co"># (only works if database lists number of patents, e.g. PubChem)</span></span>
<span id="cb80-33"><a href="filtering.html#cb80-33" aria-hidden="true" tabindex="-1"></a>compounds <span class="ot">&lt;-</span> <span class="fu">filter</span>(compounds,</span>
<span id="cb80-34"><a href="filtering.html#cb80-34" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scoreLimits =</span> <span class="fu">list</span>(<span class="at">numberPatents =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="cn">Inf</span>))</span></code></pre></div>
<blockquote>
<p><strong><em>NOTE</em></strong> As of <code>patRoon 2.0</code> MS peak lists are <strong>not</strong> re-generated after a filtering operation (unless the <code>reAverage</code> parameter is explicity set to <code>TRUE</code>). The reason for this change is that re-averaging invalidates any formula/compound annotation data (e.g. used for plotting and reporting) that were generated prior to the filter operation.</p>
</blockquote>
</div>
<div id="components" class="section level3 hasAnchor" number="5.2.4">
<h3><span class="header-section-number">5.2.4</span> Components<a href="filtering.html#components" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Finally several filters are available for components:</p>
<table>
<colgroup>
<col width="62%" />
<col width="37%" />
</colgroup>
<thead>
<tr class="header">
<th>Filter</th>
<th>Remarks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>size</code></td>
<td>Minimum component size</td>
</tr>
<tr class="even">
<td><code>adducts</code>, <code>isotopes</code></td>
<td>Filter features by adduct/istopes annotation</td>
</tr>
<tr class="odd">
<td><code>rtIncrement</code>, <code>mzIncrement</code></td>
<td>Filter homologs by retention/mz increment range</td>
</tr>
</tbody>
</table>
<p>Note that these filters are only applied if the components contain the data the filter works on. For instance, filtering by adducts will <em>not</em> affect components obtained from homologous series.</p>
<p>As before, some typical examples are shown below.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="filtering.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># only keep components with at least 4 features</span></span>
<span id="cb81-2"><a href="filtering.html#cb81-2" aria-hidden="true" tabindex="-1"></a>componInt <span class="ot">&lt;-</span> <span class="fu">filter</span>(componInt, <span class="at">minSize =</span> <span class="dv">4</span>)</span>
<span id="cb81-3"><a href="filtering.html#cb81-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-4"><a href="filtering.html#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all features from components are not annotated as an adduct</span></span>
<span id="cb81-5"><a href="filtering.html#cb81-5" aria-hidden="true" tabindex="-1"></a>componRC <span class="ot">&lt;-</span> <span class="fu">filter</span>(componRC, <span class="at">adducts =</span> <span class="cn">TRUE</span>)</span>
<span id="cb81-6"><a href="filtering.html#cb81-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-7"><a href="filtering.html#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="co"># only keep protonated and sodium adducts</span></span>
<span id="cb81-8"><a href="filtering.html#cb81-8" aria-hidden="true" tabindex="-1"></a>componRC <span class="ot">&lt;-</span> <span class="fu">filter</span>(componRC, <span class="at">adducts =</span> <span class="fu">c</span>(<span class="st">&quot;[M+H]+&quot;</span>, <span class="st">&quot;[M+Na]+&quot;</span>))</span>
<span id="cb81-9"><a href="filtering.html#cb81-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-10"><a href="filtering.html#cb81-10" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all features not recognized as isotopes</span></span>
<span id="cb81-11"><a href="filtering.html#cb81-11" aria-hidden="true" tabindex="-1"></a>componRC <span class="ot">&lt;-</span> <span class="fu">filter</span>(componRC, <span class="at">isotopes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb81-12"><a href="filtering.html#cb81-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-13"><a href="filtering.html#cb81-13" aria-hidden="true" tabindex="-1"></a><span class="co"># only keep monoisotopic mass</span></span>
<span id="cb81-14"><a href="filtering.html#cb81-14" aria-hidden="true" tabindex="-1"></a>componRC <span class="ot">&lt;-</span> <span class="fu">filter</span>(componRC, <span class="at">isotopes =</span> <span class="dv">0</span>)</span>
<span id="cb81-15"><a href="filtering.html#cb81-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-16"><a href="filtering.html#cb81-16" aria-hidden="true" tabindex="-1"></a><span class="co"># min/max rt/mz increments for homologs</span></span>
<span id="cb81-17"><a href="filtering.html#cb81-17" aria-hidden="true" tabindex="-1"></a>componNT <span class="ot">&lt;-</span> <span class="fu">filter</span>(componNT, <span class="at">rtIncrement =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">30</span>),</span>
<span id="cb81-18"><a href="filtering.html#cb81-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mzIncrement =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">50</span>))</span></code></pre></div>
<blockquote>
<p><strong><em>NOTE</em></strong> As mentioned before, components are still in a relative young development phase and results should always be verified!</p>
</blockquote>
</div>
<div id="negation" class="section level3 hasAnchor" number="5.2.5">
<h3><span class="header-section-number">5.2.5</span> Negation<a href="filtering.html#negation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>All filters support <em>negation</em>: if enabled all specified filters will be executed in an opposite manner. Negation may not be so commonly used, but allows greater flexibility which is sometimes needed for advanced filtering steps. Furthermore, it is also useful to specifically isolate the data that otherwise would have been removed. Some examples are shown below.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="filtering.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># keep all features/analyses _not_ present from replicate groups &quot;repl1&quot; and &quot;repl2&quot;</span></span>
<span id="cb82-2"><a href="filtering.html#cb82-2" aria-hidden="true" tabindex="-1"></a>fGroups <span class="ot">&lt;-</span> <span class="fu">filter</span>(fGroups, <span class="at">rGroups =</span> <span class="fu">c</span>(<span class="st">&quot;repl1&quot;</span>, <span class="st">&quot;repl2&quot;</span>), <span class="at">negate =</span> <span class="cn">TRUE</span>)</span>
<span id="cb82-3"><a href="filtering.html#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="filtering.html#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="co"># only retain features with a mass defect outside 0.8-0.9</span></span>
<span id="cb82-5"><a href="filtering.html#cb82-5" aria-hidden="true" tabindex="-1"></a>fGroups <span class="ot">&lt;-</span> <span class="fu">filter</span>(<span class="at">mzDefectRange =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.9</span>), <span class="at">negate =</span> <span class="cn">TRUE</span>)</span>
<span id="cb82-6"><a href="filtering.html#cb82-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-7"><a href="filtering.html#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="co"># remove duplicate suspect hits and only keep the _worst_ hit</span></span>
<span id="cb82-8"><a href="filtering.html#cb82-8" aria-hidden="true" tabindex="-1"></a>fGroupsSusp <span class="ot">&lt;-</span> <span class="fu">filter</span>(fGroupsSusp, <span class="at">selectHitsBy =</span> <span class="st">&quot;level&quot;</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>)</span>
<span id="cb82-9"><a href="filtering.html#cb82-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-10"><a href="filtering.html#cb82-10" aria-hidden="true" tabindex="-1"></a><span class="co"># remove candidates with CO2 neutral loss</span></span>
<span id="cb82-11"><a href="filtering.html#cb82-11" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">filter</span>(formulas, <span class="at">lossElements =</span> <span class="st">&quot;CO2&quot;</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>)</span>
<span id="cb82-12"><a href="filtering.html#cb82-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-13"><a href="filtering.html#cb82-13" aria-hidden="true" tabindex="-1"></a><span class="co"># select 15 worst ranked candidates</span></span>
<span id="cb82-14"><a href="filtering.html#cb82-14" aria-hidden="true" tabindex="-1"></a>compounds <span class="ot">&lt;-</span> <span class="fu">filter</span>(compounds, <span class="at">topMost =</span> <span class="dv">15</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>)</span>
<span id="cb82-15"><a href="filtering.html#cb82-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-16"><a href="filtering.html#cb82-16" aria-hidden="true" tabindex="-1"></a><span class="co"># only keep components with &lt;5 features</span></span>
<span id="cb82-17"><a href="filtering.html#cb82-17" aria-hidden="true" tabindex="-1"></a>componInt <span class="ot">&lt;-</span> <span class="fu">filter</span>(componInt, <span class="at">minSize =</span> <span class="dv">5</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="inspecting-results.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="subset.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": false
}
});
});
</script>

</body>

</html>
