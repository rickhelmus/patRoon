<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7.1 Obtaining transformation product data | patRoon handbook</title>
  <meta name="description" content="7.1 Obtaining transformation product data | patRoon handbook" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="7.1 Obtaining transformation product data | patRoon handbook" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7.1 Obtaining transformation product data | patRoon handbook" />
  
  
  

<meta name="author" content="Rick Helmus" />


<meta name="date" content="2022-02-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="TPs.html"/>
<link rel="next" href="linking-parent-and-transformation-product-features.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.8/grViz.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet" />
<script src="libs/vis-9.1.0/vis-network.min.js"></script>
<script src="libs/visNetwork-binding-2.1.0/visNetwork.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>2</b> Installation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="automatic-installation-windows-only.html"><a href="automatic-installation-windows-only.html"><i class="fa fa-check"></i><b>2.1</b> Automatic installation (Windows only)</a></li>
<li class="chapter" data-level="2.2" data-path="docker-image.html"><a href="docker-image.html"><i class="fa fa-check"></i><b>2.2</b> Docker image</a></li>
<li class="chapter" data-level="2.3" data-path="manual-installation.html"><a href="manual-installation.html"><i class="fa fa-check"></i><b>2.3</b> Manual installation</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="manual-installation.html"><a href="manual-installation.html#r-prerequisites"><i class="fa fa-check"></i><b>2.3.1</b> R prerequisites</a></li>
<li class="chapter" data-level="2.3.2" data-path="manual-installation.html"><a href="manual-installation.html#other-dependencies"><i class="fa fa-check"></i><b>2.3.2</b> Other dependencies</a></li>
<li class="chapter" data-level="2.3.3" data-path="manual-installation.html"><a href="manual-installation.html#patroon-installation"><i class="fa fa-check"></i><b>2.3.3</b> patRoon installation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="workflow-concepts.html"><a href="workflow-concepts.html"><i class="fa fa-check"></i><b>3</b> Workflow concepts</a></li>
<li class="chapter" data-level="4" data-path="generating-workflow-data.html"><a href="generating-workflow-data.html"><i class="fa fa-check"></i><b>4</b> Generating workflow data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i><b>4.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="introduction-1.html"><a href="introduction-1.html#workflow-functions"><i class="fa fa-check"></i><b>4.1.1</b> Workflow functions</a></li>
<li class="chapter" data-level="4.1.2" data-path="introduction-1.html"><a href="introduction-1.html#workflow-output"><i class="fa fa-check"></i><b>4.1.2</b> Workflow output</a></li>
<li class="chapter" data-level="4.1.3" data-path="introduction-1.html"><a href="introduction-1.html#overview-of-all-functions-and-their-output"><i class="fa fa-check"></i><b>4.1.3</b> Overview of all functions and their output</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="preparations.html"><a href="preparations.html"><i class="fa fa-check"></i><b>4.2</b> Preparations</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="preparations.html"><a href="preparations.html#data-pre-treatment"><i class="fa fa-check"></i><b>4.2.1</b> Data pre-treatment</a></li>
<li class="chapter" data-level="4.2.2" data-path="preparations.html"><a href="preparations.html#anaInfo"><i class="fa fa-check"></i><b>4.2.2</b> Analysis information</a></li>
<li class="chapter" data-level="4.2.3" data-path="preparations.html"><a href="preparations.html#newProject"><i class="fa fa-check"></i><b>4.2.3</b> Automatic project generation with newProject()</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="features.html"><a href="features.html"><i class="fa fa-check"></i><b>4.3</b> Features</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="features.html"><a href="features.html#finding-and-grouping-features"><i class="fa fa-check"></i><b>4.3.1</b> Finding and grouping features</a></li>
<li class="chapter" data-level="4.3.2" data-path="features.html"><a href="features.html#suspscr"><i class="fa fa-check"></i><b>4.3.2</b> Suspect screening</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="componentization.html"><a href="componentization.html"><i class="fa fa-check"></i><b>4.4</b> Componentization</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="componentization.html"><a href="componentization.html#componentsChrom"><i class="fa fa-check"></i><b>4.4.1</b> Features with similar chromatographic behaviour</a></li>
<li class="chapter" data-level="4.4.2" data-path="componentization.html"><a href="componentization.html#homologues-series"><i class="fa fa-check"></i><b>4.4.2</b> Homologues series</a></li>
<li class="chapter" data-level="4.4.3" data-path="componentization.html"><a href="componentization.html#compClust"><i class="fa fa-check"></i><b>4.4.3</b> Intensity and MS/MS similarity</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="incorpAdductIso.html"><a href="incorpAdductIso.html"><i class="fa fa-check"></i><b>4.5</b> Incorporating adduct and isotopic data</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="incorpAdductIso.html"><a href="incorpAdductIso.html#selecting-features-with-preferential-adductsisotopes"><i class="fa fa-check"></i><b>4.5.1</b> Selecting features with preferential adducts/isotopes</a></li>
<li class="chapter" data-level="4.5.2" data-path="incorpAdductIso.html"><a href="incorpAdductIso.html#setting-adduct-annotations-for-feature-groups"><i class="fa fa-check"></i><b>4.5.2</b> Setting adduct annotations for feature groups</a></li>
<li class="chapter" data-level="4.5.3" data-path="incorpAdductIso.html"><a href="incorpAdductIso.html#useAdductAnn"><i class="fa fa-check"></i><b>4.5.3</b> Using adduct annotations in the workflow</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="annotation.html"><a href="annotation.html"><i class="fa fa-check"></i><b>4.6</b> Annotation</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="annotation.html"><a href="annotation.html#ms-peak-lists"><i class="fa fa-check"></i><b>4.6.1</b> MS peak lists</a></li>
<li class="chapter" data-level="4.6.2" data-path="annotation.html"><a href="annotation.html#formulae"><i class="fa fa-check"></i><b>4.6.2</b> Formulae</a></li>
<li class="chapter" data-level="4.6.3" data-path="annotation.html"><a href="annotation.html#compounds"><i class="fa fa-check"></i><b>4.6.3</b> Compounds</a></li>
<li class="chapter" data-level="4.6.4" data-path="annotation.html"><a href="annotation.html#suspAnn"><i class="fa fa-check"></i><b>4.6.4</b> Suspect annotation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="processing.html"><a href="processing.html"><i class="fa fa-check"></i><b>5</b> Processing workflow data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="inspecting-results.html"><a href="inspecting-results.html"><i class="fa fa-check"></i><b>5.1</b> Inspecting results</a></li>
<li class="chapter" data-level="5.2" data-path="filtering.html"><a href="filtering.html"><i class="fa fa-check"></i><b>5.2</b> Filtering</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="filtering.html"><a href="filtering.html#features-1"><i class="fa fa-check"></i><b>5.2.1</b> Features</a></li>
<li class="chapter" data-level="5.2.2" data-path="filtering.html"><a href="filtering.html#suspect-screening"><i class="fa fa-check"></i><b>5.2.2</b> Suspect screening</a></li>
<li class="chapter" data-level="5.2.3" data-path="filtering.html"><a href="filtering.html#annotation-1"><i class="fa fa-check"></i><b>5.2.3</b> Annotation</a></li>
<li class="chapter" data-level="5.2.4" data-path="filtering.html"><a href="filtering.html#components"><i class="fa fa-check"></i><b>5.2.4</b> Components</a></li>
<li class="chapter" data-level="5.2.5" data-path="filtering.html"><a href="filtering.html#negation"><i class="fa fa-check"></i><b>5.2.5</b> Negation</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="subset.html"><a href="subset.html"><i class="fa fa-check"></i><b>5.3</b> Subsetting</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="subset.html"><a href="subset.html#prioritization-workflow"><i class="fa fa-check"></i><b>5.3.1</b> Prioritization workflow</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="deleting-data.html"><a href="deleting-data.html"><i class="fa fa-check"></i><b>5.4</b> Deleting data</a></li>
<li class="chapter" data-level="5.5" data-path="unOv.html"><a href="unOv.html"><i class="fa fa-check"></i><b>5.5</b> Unique and overlapping features</a></li>
<li class="chapter" data-level="5.6" data-path="specSim.html"><a href="specSim.html"><i class="fa fa-check"></i><b>5.6</b> MS similarity</a></li>
<li class="chapter" data-level="5.7" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>5.7</b> Visualization</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="visualization.html"><a href="visualization.html#vis_feat_ann"><i class="fa fa-check"></i><b>5.7.1</b> Features and annatation data</a></li>
<li class="chapter" data-level="5.7.2" data-path="visualization.html"><a href="visualization.html#visComp"><i class="fa fa-check"></i><b>5.7.2</b> Overlapping and unique data</a></li>
<li class="chapter" data-level="5.7.3" data-path="visualization.html"><a href="visualization.html#ms-similarity"><i class="fa fa-check"></i><b>5.7.3</b> MS similarity</a></li>
<li class="chapter" data-level="5.7.4" data-path="visualization.html"><a href="visualization.html#plotClust"><i class="fa fa-check"></i><b>5.7.4</b> Hierarchical clustering results</a></li>
<li class="chapter" data-level="5.7.5" data-path="visualization.html"><a href="visualization.html#generating-eics-in-dataanalysis"><i class="fa fa-check"></i><b>5.7.5</b> Generating EICs in DataAnalysis</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="intReview.html"><a href="intReview.html"><i class="fa fa-check"></i><b>5.8</b> Interactively explore and review data</a></li>
<li class="chapter" data-level="5.9" data-path="report.html"><a href="report.html"><i class="fa fa-check"></i><b>5.9</b> Reporting</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="setsWorkflow.html"><a href="setsWorkflow.html"><i class="fa fa-check"></i><b>6</b> Sets workflows</a>
<ul>
<li class="chapter" data-level="6.1" data-path="initiating-a-sets-workflow.html"><a href="initiating-a-sets-workflow.html"><i class="fa fa-check"></i><b>6.1</b> Initiating a sets workflow</a></li>
<li class="chapter" data-level="6.2" data-path="generating-sets-workflow-data.html"><a href="generating-sets-workflow-data.html"><i class="fa fa-check"></i><b>6.2</b> Generating sets workflow data</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="generating-sets-workflow-data.html"><a href="generating-sets-workflow-data.html#componentization-1"><i class="fa fa-check"></i><b>6.2.1</b> Componentization</a></li>
<li class="chapter" data-level="6.2.2" data-path="generating-sets-workflow-data.html"><a href="generating-sets-workflow-data.html#formula-and-compound-annotation"><i class="fa fa-check"></i><b>6.2.2</b> Formula and compound annotation</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="setsAdducts.html"><a href="setsAdducts.html"><i class="fa fa-check"></i><b>6.3</b> Selecting adducts to improve grouping</a></li>
<li class="chapter" data-level="6.4" data-path="processing-data.html"><a href="processing-data.html"><i class="fa fa-check"></i><b>6.4</b> Processing data</a></li>
<li class="chapter" data-level="6.5" data-path="advanced.html"><a href="advanced.html"><i class="fa fa-check"></i><b>6.5</b> Advanced</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="advanced.html"><a href="advanced.html#initiating-a-sets-workflow-from-feature-groups"><i class="fa fa-check"></i><b>6.5.1</b> Initiating a sets workflow from feature groups</a></li>
<li class="chapter" data-level="6.5.2" data-path="advanced.html"><a href="advanced.html#inspecting-and-converting-set-objects"><i class="fa fa-check"></i><b>6.5.2</b> Inspecting and converting set objects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="TPs.html"><a href="TPs.html"><i class="fa fa-check"></i><b>7</b> Transformation product screening</a>
<ul>
<li class="chapter" data-level="7.1" data-path="genTPs.html"><a href="genTPs.html"><i class="fa fa-check"></i><b>7.1</b> Obtaining transformation product data</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="genTPs.html"><a href="genTPs.html#parent-input"><i class="fa fa-check"></i><b>7.1.1</b> Parent input</a></li>
<li class="chapter" data-level="7.1.2" data-path="genTPs.html"><a href="genTPs.html#processing-data-1"><i class="fa fa-check"></i><b>7.1.2</b> Processing data</a></li>
<li class="chapter" data-level="7.1.3" data-path="genTPs.html"><a href="genTPs.html#TPsCustom"><i class="fa fa-check"></i><b>7.1.3</b> Custom libraries and transformations</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="linking-parent-and-transformation-product-features.html"><a href="linking-parent-and-transformation-product-features.html"><i class="fa fa-check"></i><b>7.2</b> Linking parent and transformation product features</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="linking-parent-and-transformation-product-features.html"><a href="linking-parent-and-transformation-product-features.html#componentization-2"><i class="fa fa-check"></i><b>7.2.1</b> Componentization</a></li>
<li class="chapter" data-level="7.2.2" data-path="linking-parent-and-transformation-product-features.html"><a href="linking-parent-and-transformation-product-features.html#TPsProc"><i class="fa fa-check"></i><b>7.2.2</b> Processing data</a></li>
<li class="chapter" data-level="7.2.3" data-path="linking-parent-and-transformation-product-features.html"><a href="linking-parent-and-transformation-product-features.html#omitting-transformation-product-input"><i class="fa fa-check"></i><b>7.2.3</b> Omitting transformation product input</a></li>
<li class="chapter" data-level="7.2.4" data-path="linking-parent-and-transformation-product-features.html"><a href="linking-parent-and-transformation-product-features.html#reporting-tp-components"><i class="fa fa-check"></i><b>7.2.4</b> Reporting TP components</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="TPsExamples.html"><a href="TPsExamples.html"><i class="fa fa-check"></i><b>7.3</b> Example workflows</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="TPsExamples.html"><a href="TPsExamples.html#TPsEx1"><i class="fa fa-check"></i><b>7.3.1</b> Screen predicted TPs for targets</a></li>
<li class="chapter" data-level="7.3.2" data-path="TPsExamples.html"><a href="TPsExamples.html#TPsEx2"><i class="fa fa-check"></i><b>7.3.2</b> Screening TPs from a library for suspects</a></li>
<li class="chapter" data-level="7.3.3" data-path="TPsExamples.html"><a href="TPsExamples.html#TPsEx3"><i class="fa fa-check"></i><b>7.3.3</b> Non-target screening of predicted TPs</a></li>
<li class="chapter" data-level="7.3.4" data-path="TPsExamples.html"><a href="TPsExamples.html#TPsEx4"><i class="fa fa-check"></i><b>7.3.4</b> Non-target screening of TPs by annotation similarities</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="advanced_usage.html"><a href="advanced_usage.html"><i class="fa fa-check"></i><b>8</b> Advanced usage</a>
<ul>
<li class="chapter" data-level="8.1" data-path="adducts.html"><a href="adducts.html"><i class="fa fa-check"></i><b>8.1</b> Adducts</a></li>
<li class="chapter" data-level="8.2" data-path="fOpt.html"><a href="fOpt.html"><i class="fa fa-check"></i><b>8.2</b> Feature parameter optimization</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="fOpt.html"><a href="fOpt.html#parameter-sets"><i class="fa fa-check"></i><b>8.2.1</b> Parameter sets</a></li>
<li class="chapter" data-level="8.2.2" data-path="fOpt.html"><a href="fOpt.html#processing-optmization-results"><i class="fa fa-check"></i><b>8.2.2</b> Processing optmization results</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="peakQual.html"><a href="peakQual.html"><i class="fa fa-check"></i><b>8.3</b> Chromatographic peak qualities</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="peakQual.html"><a href="peakQual.html#applying-machine-learning-with-metaclean"><i class="fa fa-check"></i><b>8.3.1</b> Applying machine learning with MetaClean</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="exporting-and-converting-feature-data.html"><a href="exporting-and-converting-feature-data.html"><i class="fa fa-check"></i><b>8.4</b> Exporting and converting feature data</a></li>
<li class="chapter" data-level="8.5" data-path="consensus.html"><a href="consensus.html"><i class="fa fa-check"></i><b>8.5</b> Algorithm consensus</a></li>
<li class="chapter" data-level="8.6" data-path="compclust.html"><a href="compclust.html"><i class="fa fa-check"></i><b>8.6</b> Compound clustering</a></li>
<li class="chapter" data-level="8.7" data-path="basic-quantitative-and-regression-analysis.html"><a href="basic-quantitative-and-regression-analysis.html"><i class="fa fa-check"></i><b>8.7</b> Basic quantitative and regression analysis</a></li>
<li class="chapter" data-level="8.8" data-path="FCCalc.html"><a href="FCCalc.html"><i class="fa fa-check"></i><b>8.8</b> Fold changes</a></li>
<li class="chapter" data-level="8.9" data-path="caching.html"><a href="caching.html"><i class="fa fa-check"></i><b>8.9</b> Caching</a></li>
<li class="chapter" data-level="8.10" data-path="parallelization.html"><a href="parallelization.html"><i class="fa fa-check"></i><b>8.10</b> Parallelization</a>
<ul>
<li class="chapter" data-level="8.10.1" data-path="parallelization.html"><a href="parallelization.html#parellization-of-r-functions"><i class="fa fa-check"></i><b>8.10.1</b> Parellization of R functions</a></li>
<li class="chapter" data-level="8.10.2" data-path="parallelization.html"><a href="parallelization.html#multiprocessing"><i class="fa fa-check"></i><b>8.10.2</b> Multiprocessing</a></li>
<li class="chapter" data-level="8.10.3" data-path="parallelization.html"><a href="parallelization.html#notes-when-using-parallelization-with-futures"><i class="fa fa-check"></i><b>8.10.3</b> Notes when using parallelization with futures</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>9</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">patRoon handbook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="genTPs" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Obtaining transformation product data</h2>
<p>The <code>generateTPs</code> function is used to obtain TPs for a particular set of parents. Like other workflow generator functions (<code>findFeatures</code>, <code>generateCompounds</code>), several algorithms are available that do the actual work.</p>
<table>
<colgroup>
<col width="16%" />
<col width="49%" />
<col width="34%" />
</colgroup>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Usage</th>
<th>Remarks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://bitbucket.org/djoumbou/biotransformer/src/master/">BioTransformer</a></td>
<td><code>generateTPs(algorithm = "biotransformer", ...)</code></td>
<td>Predicts TPs with full structural information</td>
</tr>
<tr class="even">
<td>Library</td>
<td><code>generateTPs(algorithm = "library", ...)</code></td>
<td>Obtains transformation products from a library (<a href="https://doi.org/10.5281/zenodo.5644560">PubChem transformations</a> or custom)</td>
</tr>
<tr class="odd">
<td>Metabolic logic</td>
<td><code>generateTPs(algorithm = "logic", ...)</code></td>
<td>Uses pre-defined logic to predict TPs based on common elemental differences (e.g. hydroxylation, demethylation). Based on <span class="citation">Schollee et al. (<a href="#ref-Scholle2015" role="doc-biblioref">2015</a>)</span>.</td>
</tr>
</tbody>
</table>
<p>The <code>biotransformer</code> and <code>library</code> algorithms provide full structural information of the TPs (e.g. formula, SMILES, predicted Log P). However, these algorithms also depend on the full chemical structure of the parent compound. Hence, these algorithms are typically suitable when parents are known in advance or were found by a suspect screening. On the other hand, metabolic logic only requires the feature mass, and this simplicity allows it to predict TPs for all features. This algorithm is most suitable for full non-target analysis, however, extra care must be taken to rule out false positives.</p>
<p>An overview of common arguments for TP generation is listed below.</p>
<table>
<colgroup>
<col width="28%" />
<col width="16%" />
<col width="54%" />
</colgroup>
<thead>
<tr class="header">
<th>Argument</th>
<th>Algorithm(s)</th>
<th>Remarks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>parents</code></td>
<td><code>biotransformer</code>, <code>library</code></td>
<td>The input parents. See section below.</td>
</tr>
<tr class="even">
<td><code>fGroups</code></td>
<td><code>logic</code></td>
<td>The input feature groups to calculate TPs for.</td>
</tr>
<tr class="odd">
<td><code>type</code></td>
<td><code>biotransformer</code></td>
<td>The prediction type: <code>"env"</code>, <code>"ecbased"</code>, <code>"cyp450"</code>, <code>"phaseII"</code>, <code>"hgut"</code>, <code>"superbio"</code>, <code>"allHuman"</code>. See <a href="https://bitbucket.org/djoumbou/biotransformer/src/master/">BioTransformer</a> for more details.</td>
</tr>
<tr class="even">
<td><code>TPLibrary</code>/<code>transformations</code></td>
<td><code>library</code>/<code>logic</code></td>
<td><a href="genTPs.html#TPsCustom">Custom TP library/transformation rules</a>.</td>
</tr>
<tr class="odd">
<td><code>adduct</code></td>
<td><code>logic</code></td>
<td>The assumed adduct of the parents (e.g. <code>"[M+H]+"</code>). Not needed when <a href="incorpAdductIso.html#incorpAdductIso">adduct annotations</a> are available.</td>
</tr>
</tbody>
</table>
<div id="parent-input" class="section level3" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Parent input</h3>
<p>The input parent structures for the <code>biotransformer</code> and <code>library</code> algorithms must be one the following:</p>
<ul>
<li>A suspect list (follows the same format as <a href="features.html#suspscr">suspect screening</a>)</li>
<li>A feature groups object with screening results (e.g. obtained with <code>screenSuspects</code>, see <a href="features.html#suspscr">suspect screening</a>)</li>
<li>A <code>compounds</code> object obtained with <a href="annotation.html#compounds">compound annotation</a></li>
</ul>
<p>In the former two cases the parent information is taken from the suspect list or from the hits in a suspect screening worklow, respectively. The last case is more suitable for when the parents are not completely known. In this case, the candidate structures from a <a href="annotation.html#compounds">compound annotation</a> are used as input to obtain TPs. Since <em>all</em> the candidates are used, it is highly recommend to filter the object in advance, for instance, with the <code>topMost</code> filter. For <code>library</code>, the parent input is optional: if no parents are specified then TP data for <em>all</em> parents in the database is used.</p>
<p>For the <code>logic</code> algorithm TPs are predicted directly for feature groups. Since this algorithm can only perform very basic validity checks, it is strongly recommended to first prioritize the feature group data.</p>
<p>Some typical examples:</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="genTPs.html#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predict environmental TPs with BioTransformer for all parents in a suspect list</span></span>
<span id="cb158-2"><a href="genTPs.html#cb158-2" aria-hidden="true" tabindex="-1"></a>TPsBT <span class="ot">&lt;-</span> <span class="fu">generateTPs</span>(<span class="st">&quot;biotransformer&quot;</span>, <span class="at">parents =</span> patRoonData<span class="sc">::</span>suspectsPos,</span>
<span id="cb158-3"><a href="genTPs.html#cb158-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&quot;env&quot;</span>)</span>
<span id="cb158-4"><a href="genTPs.html#cb158-4" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain all TPs from the default library</span></span>
<span id="cb158-5"><a href="genTPs.html#cb158-5" aria-hidden="true" tabindex="-1"></a>TPsLib <span class="ot">&lt;-</span> <span class="fu">generateTPs</span>(<span class="st">&quot;library&quot;</span>)</span>
<span id="cb158-6"><a href="genTPs.html#cb158-6" aria-hidden="true" tabindex="-1"></a><span class="co"># get TPs for the parents from a suspect screening</span></span>
<span id="cb158-7"><a href="genTPs.html#cb158-7" aria-hidden="true" tabindex="-1"></a>TPsLib <span class="ot">&lt;-</span> <span class="fu">generateTPs</span>(<span class="st">&quot;library&quot;</span>, <span class="at">parents =</span> fGroupsScr)</span>
<span id="cb158-8"><a href="genTPs.html#cb158-8" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate TPs for all feature groups</span></span>
<span id="cb158-9"><a href="genTPs.html#cb158-9" aria-hidden="true" tabindex="-1"></a>TPsLogic <span class="ot">&lt;-</span> <span class="fu">generateTPs</span>(<span class="st">&quot;logic&quot;</span>, fGroups, <span class="at">adduct =</span> <span class="st">&quot;[M+H]+&quot;</span>)</span></code></pre></div>
</div>
<div id="processing-data-1" class="section level3" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> Processing data</h3>
<p>Similar to other workflow data, several generic functions are available to inspect the data:</p>
<table>
<colgroup>
<col width="30%" />
<col width="7%" />
<col width="61%" />
</colgroup>
<thead>
<tr class="header">
<th>Generic</th>
<th>Classes</th>
<th>Remarks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>length()</code></td>
<td>All</td>
<td>Returns the total number of transformation products</td>
</tr>
<tr class="even">
<td><code>names()</code></td>
<td>All</td>
<td>Returns the names of the parents</td>
</tr>
<tr class="odd">
<td><code>parents()</code></td>
<td>All</td>
<td>Returns a table with information about the parents</td>
</tr>
<tr class="even">
<td><code>products()</code></td>
<td>All</td>
<td>Returns a <code>list</code> with for each parent a table with TPs</td>
</tr>
<tr class="odd">
<td><code>as.data.table()</code>, <code>as.data.frame</code></td>
<td>All</td>
<td>Convert all the object information into a <code>data.table</code>/<code>data.frame</code></td>
</tr>
<tr class="even">
<td><code>"[["</code> / <code>"$"</code> operators</td>
<td>All</td>
<td>Extract TP information for a specified parent</td>
</tr>
</tbody>
</table>
<p>Some examples:</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="genTPs.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># just show a few columns in this example, there are many more!</span></span>
<span id="cb159-2"><a href="genTPs.html#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="co"># note: the double dot syntax (..cols) is necessary since the data is stored as data.tables</span></span>
<span id="cb159-3"><a href="genTPs.html#cb159-3" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;name&quot;</span>, <span class="st">&quot;formula&quot;</span>, <span class="st">&quot;InChIKey&quot;</span>)</span>
<span id="cb159-4"><a href="genTPs.html#cb159-4" aria-hidden="true" tabindex="-1"></a><span class="fu">parents</span>(TPs)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, ..cols]</span></code></pre></div>
<pre><code>#&gt;                            name   formula                    InChIKey
#&gt; 1:               (-)-bisoprolol C18H31NO4 VHYCDWMUTMEGQY-KRWDZBQOSA-N
#&gt; 2:         (-)-Epigallocatechin  C15H14O7 XMOCLSLCDHWDHP-IUODEOHRSA-N
#&gt; 3: (-)-Epigallocatechin gallate C22H18O11 WMBWREPUVVBILR-WIYYLYMNSA-N
#&gt; 4:             (-)-ethosuximide  C7H11NO2 HAPOVYFOVVWLRS-SSDOTTSWSA-N
#&gt; 5:                 (-)-etodolac C17H21NO3 NNYBQONXHNTVIJ-QGZVFWFLSA-N</code></pre>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="genTPs.html#cb161-1" aria-hidden="true" tabindex="-1"></a>TPs[[<span class="st">&quot;DEET&quot;</span>]][, ..cols]</span></code></pre></div>
<pre><code>#&gt;                                                    name   formula                    InChIKey
#&gt; 1:         DEET-TP-N,N-diethyl-m-hydroxymethylbenzamide C12H17NO2 FRZJZRVZZNTMAW-UHFFFAOYSA-N
#&gt; 2: DEET-TP-N-Ethyl-N-(2-hydroxyethyl)-3-methylbenzamide C12H17NO2 KVTUZBGZTRABBQ-UHFFFAOYSA-N
#&gt; 3:                                 DEET-TP-acetaldehyde     C2H4O IKHGUXGNUITLKF-UHFFFAOYSA-N
#&gt; 4:                          DEET-TP-N-ethyl-m-toluamide  C10H13NO FPINATACRXASTP-UHFFFAOYSA-N</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="genTPs.html#cb163-1" aria-hidden="true" tabindex="-1"></a>TPs[[<span class="dv">2</span>]][, ..cols]</span></code></pre></div>
<pre><code>#&gt;                                                                    name   formula                    InChIKey
#&gt; 1: (-)-Epigallocatechin-TP-(-)-Epigallocatechin, 3p-hydroxy-glucuronide C21H22O13 CQDATFYRGVZXLF-ZVHNUXTDSA-N</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="genTPs.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.table</span>(TPs)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>#&gt;                          parent                               transformation                                                                                 name
#&gt; 1:               (-)-bisoprolol           O-deisopropylation / Human Phase I                                      (-)-bisoprolol-TP-(-)-bisoprolol, O-deisopropyl
#&gt; 2:         (-)-Epigallocatechin Aromatic-OH glucuronidation / Human Phase II                 (-)-Epigallocatechin-TP-(-)-Epigallocatechin, 3p-hydroxy-glucuronide
#&gt; 3: (-)-Epigallocatechin gallate Aromatic-OH glucuronidation / Human Phase II (-)-Epigallocatechin gallate-TP-(-)-Epigallocatechin gallate, 3p-hydroxy-glucuronide
#&gt; 4: (-)-Epigallocatechin gallate Aromatic-OH glucuronidation / Human Phase II (-)-Epigallocatechin gallate-TP-(-)-Epigallocatechin gallate, 4p-hydroxy-glucuronide
#&gt; 5:             (-)-ethosuximide      Aliphatic Hydroxylation / Human Phase I                 (-)-ethosuximide-TP-3-(1-Hydroxyethyl)-3-methylpyrrolidine-2,5-dione</code></pre>
<p>In addition, the following generic functions are available to modify or convert the object data:</p>
<table>
<colgroup>
<col width="18%" />
<col width="25%" />
<col width="55%" />
</colgroup>
<thead>
<tr class="header">
<th>Generic</th>
<th>Classes</th>
<th>Remarks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>"["</code> operator</td>
<td>All</td>
<td>Subset this object on given parents</td>
</tr>
<tr class="even">
<td><code>filter</code></td>
<td><code>transformationProductsBT</code></td>
<td>Filters this object</td>
</tr>
<tr class="odd">
<td><code>convertToSuspects</code></td>
<td>All</td>
<td>Generates a suspect list of all TPs (and optionally parents) that is suitable for <code>screenSuspects</code></td>
</tr>
<tr class="even">
<td><code>convertToMFDB</code></td>
<td><code>transformationProductsBT</code>, <code>transformationProductsLibrary</code></td>
<td>Generates a <a href="http://ipb-halle.github.io/MetFrag/">MetFrag</a> database for all TPs (and optionally parents)</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="genTPs.html#cb167-1" aria-hidden="true" tabindex="-1"></a>TPs2 <span class="ot">&lt;-</span> TPs[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>] <span class="co"># only keep results for first ten parents</span></span>
<span id="cb167-2"><a href="genTPs.html#cb167-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-3"><a href="genTPs.html#cb167-3" aria-hidden="true" tabindex="-1"></a><span class="co"># remove transformation products that are isomers to their parent or sibling TPs</span></span>
<span id="cb167-4"><a href="genTPs.html#cb167-4" aria-hidden="true" tabindex="-1"></a><span class="co"># may simplify data as these are often difficult to identify</span></span>
<span id="cb167-5"><a href="genTPs.html#cb167-5" aria-hidden="true" tabindex="-1"></a>TPsF <span class="ot">&lt;-</span> <span class="fu">filter</span>(TPs, <span class="at">removeParentIsomers =</span> <span class="cn">TRUE</span>, <span class="at">removeTPIsomers =</span> <span class="cn">TRUE</span>)</span>
<span id="cb167-6"><a href="genTPs.html#cb167-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-7"><a href="genTPs.html#cb167-7" aria-hidden="true" tabindex="-1"></a><span class="co"># remove duplicate transformation products from each parent</span></span>
<span id="cb167-8"><a href="genTPs.html#cb167-8" aria-hidden="true" tabindex="-1"></a><span class="co"># these can occur if different pathways yield the same TPs</span></span>
<span id="cb167-9"><a href="genTPs.html#cb167-9" aria-hidden="true" tabindex="-1"></a>TPsF <span class="ot">&lt;-</span> <span class="fu">filter</span>(TPs, <span class="at">removeDuplicates =</span> <span class="cn">TRUE</span>)</span>
<span id="cb167-10"><a href="genTPs.html#cb167-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-11"><a href="genTPs.html#cb167-11" aria-hidden="true" tabindex="-1"></a><span class="co"># only keep TPs that have a structural similarity to their parent of &gt;= 0.5</span></span>
<span id="cb167-12"><a href="genTPs.html#cb167-12" aria-hidden="true" tabindex="-1"></a>TPsF <span class="ot">&lt;-</span> <span class="fu">filter</span>(TPs, <span class="at">minSimilarity =</span> <span class="fl">0.5</span>)</span>
<span id="cb167-13"><a href="genTPs.html#cb167-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-14"><a href="genTPs.html#cb167-14" aria-hidden="true" tabindex="-1"></a><span class="co"># do a suspect screening for all TPs and their parents</span></span>
<span id="cb167-15"><a href="genTPs.html#cb167-15" aria-hidden="true" tabindex="-1"></a>suspects <span class="ot">&lt;-</span> <span class="fu">convertToSuspects</span>(TPs, <span class="at">includeParents =</span> <span class="cn">TRUE</span>)</span>
<span id="cb167-16"><a href="genTPs.html#cb167-16" aria-hidden="true" tabindex="-1"></a>fGroupsScr <span class="ot">&lt;-</span> <span class="fu">screenSuspects</span>(fGroups, suspects, <span class="at">onlyHits =</span> <span class="cn">TRUE</span>)</span>
<span id="cb167-17"><a href="genTPs.html#cb167-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-18"><a href="genTPs.html#cb167-18" aria-hidden="true" tabindex="-1"></a><span class="co"># use the TP data for a specialized MetFrag database</span></span>
<span id="cb167-19"><a href="genTPs.html#cb167-19" aria-hidden="true" tabindex="-1"></a><span class="fu">convertToMFDB</span>(TPs, <span class="st">&quot;TP-database.csv&quot;</span>, <span class="at">includeParents =</span> <span class="cn">FALSE</span>)</span>
<span id="cb167-20"><a href="genTPs.html#cb167-20" aria-hidden="true" tabindex="-1"></a>compoundsTPs <span class="ot">&lt;-</span> <span class="fu">generateCompounds</span>(fGroups, mslists, <span class="st">&quot;metfrag&quot;</span>, <span class="at">database =</span> <span class="st">&quot;csv&quot;</span>,</span>
<span id="cb167-21"><a href="genTPs.html#cb167-21" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">extraOpts =</span> <span class="fu">list</span>(<span class="at">LocalDatabasePath =</span> <span class="st">&quot;TP-database.csv&quot;</span>))</span></code></pre></div>
<p>The <code>convertToSuspects</code> function is always part of a workflow with <code>biotransformer</code> or <code>library</code> TPs. This is discussed further in the next section. The <code>convertToMFDB</code> function is especially handy with <code>biotransformer</code> workflows, as it allows generating a compound database for TPs that may not be available in other databases. This is further demonstrated in the <a href="TPsExamples.html#TPsEx1">first example</a>.</p>
</div>
<div id="TPsCustom" class="section level3" number="7.1.3">
<h3><span class="header-section-number">7.1.3</span> Custom libraries and transformations</h3>
<p>By default the <code>library</code> and <code>logic</code> algorithms use data that is installed with <code>patRoon</code> (based on <a href="https://doi.org/10.5281/zenodo.5644560">PubChem transformations</a> and <span class="citation">Schollee et al. (<a href="#ref-Scholle2015" role="doc-biblioref">2015</a>)</span>, respectively). However, it is also possible to use custom data.</p>
<p>To use a custom TP library a simple <code>data.frame</code> is needed with the names, SMILES and optionally <code>log P</code> values for the parents and TPs. The <code>log P</code> values are used for prediction of the retention time direction of a TP compared to its parent, as is discussed further in the next section. The following small library has two TPs for benzotriazole and one for DEET:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="genTPs.html#cb168-1" aria-hidden="true" tabindex="-1"></a>myTPLib <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">parent_name =</span> <span class="fu">c</span>(<span class="st">&quot;1H-Benzotriazole&quot;</span>, <span class="st">&quot;1H-Benzotriazole&quot;</span>, <span class="st">&quot;DEET&quot;</span>),</span>
<span id="cb168-2"><a href="genTPs.html#cb168-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">parent_SMILES =</span> <span class="fu">c</span>(<span class="st">&quot;C1=CC2=NNN=C2C=C1&quot;</span>, <span class="st">&quot;C1=CC2=NNN=C2C=C1&quot;</span>, <span class="st">&quot;CCN(CC)C(=O)C1=CC=CC(=C1)C&quot;</span>),</span>
<span id="cb168-3"><a href="genTPs.html#cb168-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">TP_name =</span> <span class="fu">c</span>(<span class="st">&quot;1-Methylbenzotriazole&quot;</span>, <span class="st">&quot;1-Hydroxybenzotriazole&quot;</span>, <span class="st">&quot;N-ethyl-m-toluamide&quot;</span>),</span>
<span id="cb168-4"><a href="genTPs.html#cb168-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">TP_SMILES =</span> <span class="fu">c</span>(<span class="st">&quot;CN1C2=CC=CC=C2N=N1&quot;</span>, <span class="st">&quot;C1=CC=C2C(=C1)N=NN2O&quot;</span>, <span class="st">&quot;CCNC(=O)C1=CC=CC(=C1)C&quot;</span>))</span>
<span id="cb168-5"><a href="genTPs.html#cb168-5" aria-hidden="true" tabindex="-1"></a>myTPLib</span></code></pre></div>
<pre><code>#&gt;        parent_name              parent_SMILES                TP_name              TP_SMILES
#&gt; 1 1H-Benzotriazole          C1=CC2=NNN=C2C=C1  1-Methylbenzotriazole     CN1C2=CC=CC=C2N=N1
#&gt; 2 1H-Benzotriazole          C1=CC2=NNN=C2C=C1 1-Hydroxybenzotriazole   C1=CC=C2C(=C1)N=NN2O
#&gt; 3             DEET CCN(CC)C(=O)C1=CC=CC(=C1)C    N-ethyl-m-toluamide CCNC(=O)C1=CC=CC(=C1)C</code></pre>
<p>To use this library, simply pass it to the <code>TPLibrary</code> argument:</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="genTPs.html#cb170-1" aria-hidden="true" tabindex="-1"></a>TPs <span class="ot">&lt;-</span> <span class="fu">generateTPs</span>(<span class="st">&quot;library&quot;</span>, <span class="at">TPLibrary =</span> myTPLib)</span></code></pre></div>
<p>Similarly, for <code>logic</code> a table with custom transformation rules can be specified for TP calculations:</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="genTPs.html#cb171-1" aria-hidden="true" tabindex="-1"></a>myTrans <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">transformation =</span> <span class="fu">c</span>(<span class="st">&quot;hydroxylation&quot;</span>, <span class="st">&quot;demethylation&quot;</span>),</span>
<span id="cb171-2"><a href="genTPs.html#cb171-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">add =</span> <span class="fu">c</span>(<span class="st">&quot;O&quot;</span>, <span class="st">&quot;&quot;</span>),</span>
<span id="cb171-3"><a href="genTPs.html#cb171-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">sub =</span> <span class="fu">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;CH2&quot;</span>),</span>
<span id="cb171-4"><a href="genTPs.html#cb171-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">retDir =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb171-5"><a href="genTPs.html#cb171-5" aria-hidden="true" tabindex="-1"></a>myTrans</span></code></pre></div>
<pre><code>#&gt;   transformation add sub retDir
#&gt; 1  hydroxylation   O         -1
#&gt; 2  demethylation     CH2     -1</code></pre>
<p>The <code>add</code> and <code>sub</code> columns are used to denote the elements that are added or subtracted by the reaction. These are used to calculate mass differences between parents and TPs. The <code>retDir</code> column is used to indicate the retention time direction of the parent compared to the TP: <code>-1</code> (elutes before parent), <code>1</code> (elutes after parent) or <code>0</code> (similar or unknown). The next section describes how this data can be used to filter TPs. The custom rules can be used by passing them to the <code>transformations</code> argument:</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="genTPs.html#cb173-1" aria-hidden="true" tabindex="-1"></a>TPs <span class="ot">&lt;-</span> <span class="fu">generateTPs</span>(<span class="st">&quot;logic&quot;</span>, fGroups, <span class="at">adduct =</span> <span class="st">&quot;[M+H]+&quot;</span>, <span class="at">transformations =</span> myTrans)</span></code></pre></div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Scholle2015" class="csl-entry">
Schollee, Jennifer E., Emma L. Schymanski, Sven E. Avak, Martin Loos, and Juliane Hollender. 2015. <span>“Prioritizing Unknown Transformation Products from Biologically-Treated Wastewater Using High-Resolution Mass Spectrometry, Multivariate Statistics, and Metabolic Logic.”</span> <em>Analytical Chemistry</em> 87 (24): 12121–29. <a href="https://doi.org/10.1021/acs.analchem.5b02905">https://doi.org/10.1021/acs.analchem.5b02905</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="TPs.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="linking-parent-and-transformation-product-features.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": false
}
});
});
</script>

</body>

</html>
