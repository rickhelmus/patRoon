<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Filtering of grouped features — feature-filtering • patRoon</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Filtering of grouped features — feature-filtering" />
<meta property="og:description" content="Basic rule based filtering of feature groups." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">patRoon</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Reference
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../reference/index.html">Online</a>
    </li>
    <li>
      <a href="../reference/patRoon.pdf">PDF</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorial
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/tutorial.html">Online HTML page</a>
    </li>
    <li>
      <a href="../articles/tutorial.pdf">PDF</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Handbook
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../handbook_bd/index.html">Book format</a>
    </li>
    <li>
      <a href="../articles/handbook.html">Single page</a>
    </li>
    <li>
      <a href="../handbook_bd/handbook.pdf">PDF</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/rickhelmus/patRoon">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Filtering of grouped features</h1>
    <small class="dont-index">Source: <a href='https://github.com/rickhelmus/patRoon/blob/master/R/feature_groups-filter.R'><code>R/feature_groups-filter.R</code></a></small>
    <div class="hidden name"><code>feature-filtering.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Basic rule based filtering of feature groups.</p>
    </div>

    <pre class="usage"><span class='co'># S4 method for featureGroups</span>
<span class='fu'><a href='generics.html'>filter</a></span>(
  <span class='no'>obj</span>,
  <span class='kw'>absMinIntensity</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>relMinIntensity</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>preAbsMinIntensity</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>preRelMinIntensity</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>absMinAnalyses</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>relMinAnalyses</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>absMinReplicates</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>relMinReplicates</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>absMinFeatures</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>relMinFeatures</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>absMinReplicateAbundance</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>relMinReplicateAbundance</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>maxReplicateIntRSD</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>blankThreshold</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>retentionRange</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>mzRange</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>mzDefectRange</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>chromWidthRange</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>rGroups</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>removeBlanks</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>negate</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)

<span class='co'># S4 method for featureGroups</span>
<span class='fu'>replicateGroupSubtract</span>(<span class='no'>fGroups</span>, <span class='no'>rGroups</span>, <span class='kw'>threshold</span> <span class='kw'>=</span> <span class='fl'>0</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>absMinIntensity, relMinIntensity</th>
      <td><p>Minimum absolute/relative intensity
for features to be kept. The relative intensity is determined from the
feature with highest intensity (of all features from all groups).
Set to <samp>0</samp> or <code>NULL</code>
to skip this step.</p></td>
    </tr>
    <tr>
      <th>preAbsMinIntensity, preRelMinIntensity</th>
      <td><p>As
<code>absMinIntensity</code>/<code>relMinIntensity</code>, but applied <em>before</em>
any other filters. This is typically used to speed-up subsequent filter
steps. However, care must be taken that a sufficiently low value is choosen
that is not expected to affect subsequent filtering steps. See below why
this may be important.</p></td>
    </tr>
    <tr>
      <th>absMinAnalyses, relMinAnalyses</th>
      <td><p>Feature groups are only kept when they
contain data for at least this (absolute or relative) amount of analyses.
Set to <code>NULL</code> to ignore.</p></td>
    </tr>
    <tr>
      <th>absMinReplicates, relMinReplicates</th>
      <td><p>Feature groups are only kept when
they contain data for at least this (absolute or relative) amount of
replicates. Set to <code>NULL</code> to ignore.</p></td>
    </tr>
    <tr>
      <th>absMinFeatures, relMinFeatures</th>
      <td><p>Analyses are only kept when they contain
at least this (absolute or relative) amount of features. Set to <code>NULL</code>
to ignore.</p></td>
    </tr>
    <tr>
      <th>absMinReplicateAbundance, relMinReplicateAbundance</th>
      <td><p>Minimum
absolute/relative abundance that a grouped feature should be present within
a replicate group. If this mimimum is not met all features within the
replicate group are removed. Set to <code>NULL</code> to skip this step.</p></td>
    </tr>
    <tr>
      <th>maxReplicateIntRSD</th>
      <td><p>Maximum relative standard deviation (RSD) of
intensity values for features within a replicate group. If the RSD is above
this value all features within the replicate group are removed. Set to
<code>NULL</code> to ignore.</p></td>
    </tr>
    <tr>
      <th>blankThreshold</th>
      <td><p>Feature groups that are also present in blank analyses
(see <a href='analysis-information.html'>analysis info</a>) are filtered out unless
their relative intensity is above this threshold. For instance, a value of
<samp>5</samp> means that only features with an intensity five times higher than
that of the blank are kept. The relative intensity values between blanks
and non-blanks are determined from the mean of all non-zero blank
intensities. Set to <code>NULL</code> to skip this step.</p></td>
    </tr>
    <tr>
      <th>retentionRange, mzRange, mzDefectRange, chromWidthRange</th>
      <td><p>Range of
retention time (in seconds), <em>m/z</em>, mass defect (defined as the
decimal part of <em>m/z</em> values) or chromatographic peak width (in
seconds), respectively. Features outside this range will be removed. Should
be a numeric vector with length of two containing the min/max values. The
maximum can be <code>Inf</code> to specify no maximum range. Set to <code>NULL</code>
to skip this step.</p></td>
    </tr>
    <tr>
      <th>rGroups</th>
      <td><p>A character vector of replicate groups that should be kept
(<code>filter</code>) or subtracted from (<code>replicateGroupSubtract</code>).</p></td>
    </tr>
    <tr>
      <th>removeBlanks</th>
      <td><p>Set to <code>TRUE</code> to remove all analyses that belong to
replicate groups that are specified as a blank in the
<a href='analysis-information.html'>analysis-information</a>. This is useful to simplify the analyses in the
specified <code><a href='featureGroups-class.html'>featureGroups</a></code> object after blank subtraction. When
both <code>blankThreshold</code> and this argument are set, blank subtraction is
performed prior to removing any analyses.</p></td>
    </tr>
    <tr>
      <th>negate</th>
      <td><p>If set to <code>TRUE</code> then filtering operations are performed
in opposite manner.</p></td>
    </tr>
    <tr>
      <th>fGroups, obj</th>
      <td><p><code><a href='featureGroups-class.html'>featureGroups</a></code> object to which the filter is
applied.</p></td>
    </tr>
    <tr>
      <th>threshold</th>
      <td><p>Minimum relative threshold (compared to mean intensity of
replicate group being subtracted) for a feature group to be <em>not</em>
removed. When <samp>0</samp> a feature group is always removed when present in
the given replicate groups.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A filtered <code><a href='featureGroups-class.html'>featureGroups</a></code> object. Feature groups that
  are filtered away have their intensity set to zero. In case a feature group
  is not present in any of the analyses anymore it will be removed
  completely.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>filter</code> performs common rule based filtering of feature groups
  such as blank subtraction, minimum intensity and minimum replicate
  abundance. Removing of features occurs by zeroing their intensity values.
  Furthermore, feature groups that are left completely empty (<em>i.e.</em> all
  intensities are zero) will be automatically removed.</p>
<p><code>replicateGroupSubtract</code> removes feature groups present in a
  given set of replicate groups (unless intensities are above a given
  threshold). The replicate groups that are subtracted will be removed.</p>
    <h2 class="hasAnchor" id="filter-order"><a class="anchor" href="#filter-order"></a>Filter order</h2>

    <p>When multiple arguments are specified to
  <code>filter</code>, multiple filters are applied in sequence. Since some of
  these filters may affect each other, choosing their order correctly may be
  important for effective data filtering. For instance, when an intensity
  filter removes features from blank analyses, a subsequent blank filter may
  not adequately perform blank subtraction. Similarly, when intensity and
  blank filters are executed after the replicate abundance filter it may be
  necessary to ensure minimum replicate abundance again as the intensity and
  blank filters may have removed some features within a replicate group.</p>
<p>With this in mind, filters (if specified) occur in the following order:</p>
<p></p><ol>
<li><p>Pre-Intensity filters (<em>i.e.</em> <code>preAbsMinIntensity</code> and
  <code>preRelMinIntensity</code>).</p></li>
<li><p>Chromatography and mass filters (<em>i.e</em> <code>retentionRange</code>,
  <code>mzRange</code>, <code>mzDefectRange</code> and <code>chromWidthRange</code>).</p></li>
<li><p>Replicate abundance filters (<em>i.e.</em>
  <code>absMinReplicateAbundance</code>, <code>relMinReplicateAbundance</code> and
  <code>maxReplicateIntRSD</code>).</p></li>
<li><p>Blank filter (<em>i.e.</em> blankThreshold).</p></li>
<li><p>Intensity filters (<em>i.e.</em> <code>absMinIntensity</code> and
  <code>relMinIntensity</code>).</p></li>
<li><p>Replicate abundance filters (2nd time, only if previous filters
  affected results).</p></li>
<li><p>General abundance filters (<em>i.e.</em> <code>absMinAnalyses</code>,
  <code>relMinAnalyses</code>, <code>absMinReplicates</code>, <code>relMinReplicates</code>,
  <code>absMinFeatures</code> and <code>relMinFeatures</code>).</p></li>
<li><p>Replicate group filter (<em>i.e.</em> <code>rGroups</code>) and blank
  analyses removal (<em>i.e.</em> if <code>removeBlanks=TRUE</code>).</p></li>
</ol>

<p>If another filtering order is desired then <code>filter</code> should be called
  multiple times with only one filter argument at a time.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='featureGroups-class.html'>featureGroups-class</a></code></p>
<p><code><a href='feature-grouping.html'>feature-grouping</a></code></p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Rick Helmus.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


