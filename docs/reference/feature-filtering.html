<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Filtering of grouped features — feature-filtering • patRoon</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Filtering of grouped features — feature-filtering"><meta property="og:description" content="Basic rule based filtering of feature groups."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">patRoon</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Reference
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../reference/index.html">Online</a>
    </li>
    <li>
      <a href="../reference/patRoon.pdf">PDF</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorial
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/tutorial.html">Online HTML page</a>
    </li>
    <li>
      <a href="../articles/tutorial.pdf">PDF</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Handbook
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../handbook_bd/index.html">Book format</a>
    </li>
    <li>
      <a href="../handbook_bd/handbook.pdf">PDF</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/rickhelmus/patRoon" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Filtering of grouped features</h1>
    <small class="dont-index">Source: <a href="https://github.com/rickhelmus/patRoon/blob/HEAD/R/feature_groups-filter.R" class="external-link"><code>R/feature_groups-filter.R</code></a></small>
    <div class="hidden name"><code>feature-filtering.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Basic rule based filtering of feature groups.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="co"># S4 method for featureGroups</span>
<span class="fu"><a href="generics.html">filter</a></span><span class="op">(</span>
  <span class="va">obj</span>,
  absMinIntensity <span class="op">=</span> <span class="cn">NULL</span>,
  relMinIntensity <span class="op">=</span> <span class="cn">NULL</span>,
  preAbsMinIntensity <span class="op">=</span> <span class="cn">NULL</span>,
  preRelMinIntensity <span class="op">=</span> <span class="cn">NULL</span>,
  absMinAnalyses <span class="op">=</span> <span class="cn">NULL</span>,
  relMinAnalyses <span class="op">=</span> <span class="cn">NULL</span>,
  absMinReplicates <span class="op">=</span> <span class="cn">NULL</span>,
  relMinReplicates <span class="op">=</span> <span class="cn">NULL</span>,
  absMinFeatures <span class="op">=</span> <span class="cn">NULL</span>,
  relMinFeatures <span class="op">=</span> <span class="cn">NULL</span>,
  absMinReplicateAbundance <span class="op">=</span> <span class="cn">NULL</span>,
  relMinReplicateAbundance <span class="op">=</span> <span class="cn">NULL</span>,
  maxReplicateIntRSD <span class="op">=</span> <span class="cn">NULL</span>,
  blankThreshold <span class="op">=</span> <span class="cn">NULL</span>,
  retentionRange <span class="op">=</span> <span class="cn">NULL</span>,
  mzRange <span class="op">=</span> <span class="cn">NULL</span>,
  mzDefectRange <span class="op">=</span> <span class="cn">NULL</span>,
  chromWidthRange <span class="op">=</span> <span class="cn">NULL</span>,
  featQualityRange <span class="op">=</span> <span class="cn">NULL</span>,
  groupQualityRange <span class="op">=</span> <span class="cn">NULL</span>,
  rGroups <span class="op">=</span> <span class="cn">NULL</span>,
  results <span class="op">=</span> <span class="cn">NULL</span>,
  removeBlanks <span class="op">=</span> <span class="cn">FALSE</span>,
  checkFeaturesSession <span class="op">=</span> <span class="cn">NULL</span>,
  negate <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>

<span class="co"># S4 method for featureGroupsSet</span>
<span class="fu"><a href="generics.html">filter</a></span><span class="op">(</span>
  <span class="va">obj</span>,
  <span class="va">...</span>,
  negate <span class="op">=</span> <span class="cn">FALSE</span>,
  sets <span class="op">=</span> <span class="cn">NULL</span>,
  absMinSets <span class="op">=</span> <span class="cn">NULL</span>,
  relMinSets <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span>

<span class="co"># S4 method for featureGroups</span>
<span class="fu">replicateGroupSubtract</span><span class="op">(</span><span class="va">fGroups</span>, <span class="va">rGroups</span>, threshold <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>absMinIntensity, relMinIntensity</dt>
<dd><p>Minimum absolute/relative intensity for features to be kept. The relative
intensity is determined from the feature with highest intensity (of
all features from all groups). Set to <samp>0</samp> or <code>NULL</code> to skip this step.</p></dd>
<dt>preAbsMinIntensity, preRelMinIntensity</dt>
<dd><p>As <code>absMinIntensity</code>/<code>relMinIntensity</code>, but applied
<em>before</em> any other filters. This is typically used to speed-up subsequent filter steps. However, care must be
taken that a sufficiently low value is chosen that is not expected to affect subsequent filtering steps. See below
why this may be important.</p></dd>
<dt>absMinAnalyses, relMinAnalyses</dt>
<dd><p>Feature groups are only kept when they contain data for at least this (absolute
or relative) amount of analyses. Set to <code>NULL</code> to ignore.</p></dd>
<dt>absMinReplicates, relMinReplicates</dt>
<dd><p>Feature groups are only kept when they contain data for at least this
(absolute or relative) amount of replicates. Set to <code>NULL</code> to ignore.</p></dd>
<dt>absMinFeatures, relMinFeatures</dt>
<dd><p>Analyses are only kept when they contain at least this (absolute or relative)
amount of features. Set to <code>NULL</code> to ignore.</p></dd>
<dt>absMinReplicateAbundance, relMinReplicateAbundance</dt>
<dd><p>Minimum absolute/relative abundance that a grouped feature
should be present within a replicate group. If this minimum is not met all features within the replicate group are
removed. Set to <code>NULL</code> to skip this step.</p></dd>
<dt>maxReplicateIntRSD</dt>
<dd><p>Maximum relative standard deviation (RSD) of intensity values for features within a
replicate group. If the RSD is above this value all features within the replicate group are removed. Set to
<code>NULL</code> to ignore.</p></dd>
<dt>blankThreshold</dt>
<dd><p>Feature groups that are also present in blank analyses (see
<a href="analysis-information.html">analysis info</a>) are filtered out unless their relative intensity is above this
threshold. For instance, a value of <samp>5</samp> means that only features with an intensity five times higher than that
of the blank are kept. The relative intensity values between blanks and non-blanks are determined from the mean of
all non-zero blank intensities. Set to <code>NULL</code> to skip this step.</p></dd>
<dt>retentionRange, mzRange, mzDefectRange, chromWidthRange</dt>
<dd><p>Range of retention time (in seconds), <em>m/z</em>, mass
defect (defined as the decimal part of <em>m/z</em> values) or chromatographic peak width (in seconds), respectively.
Features outside this range will be removed. Should be a numeric vector with length of two containing the min/max
values. The maximum can be <code>Inf</code> to specify no maximum range. Set to <code>NULL</code> to skip this step.</p></dd>
<dt>featQualityRange</dt>
<dd><p>Used to filter features by their peak qualities/scores
(see <code><a href="generics.html">calculatePeakQualities</a></code>). Should be a named <code>list</code> with min/max ranges for each
quality/score to be filtered (the <code><a href="featureQualityNames.html">featureQualityNames</a></code> function can be used to obtain valid names).
Example: <code>featQualityRange=list(ModalityScore=c(0.3, Inf),
SymmetryScore=c(0.5, Inf))</code>. Set to <code>NULL</code> to ignore.</p></dd>
<dt>groupQualityRange</dt>
<dd><p>Like <code>featQualityRange</code>, but filters on group specific or averaged qualities/scores.</p></dd>
<dt>rGroups</dt>
<dd><p>A character vector of replicate groups that should be kept (<code>filter</code>) or subtracted from
(<code>replicateGroupSubtract</code>).</p></dd>
<dt>results</dt>
<dd><p>Only keep feature groups that have results in the object specified by <code>results</code>. Valid classes
are <code><a href="featureAnnotations-class.html">featureAnnotations</a></code> (<em>e.g.</em> formula/compound annotations) and <code><a href="components-class.html">components</a></code>. Can
also be a <code>list</code> with multiple objects: in this case a feature group is kept if it has a result in <em>any</em>
of the objects. Set to <code>NULL</code> to ignore.</p></dd>
<dt>removeBlanks</dt>
<dd><p>Set to <code>TRUE</code> to remove all analyses that belong to replicate groups that are specified as a
blank in the <a href="analysis-information.html">analysis-information</a>. This is useful to simplify the analyses in the specified
<code><a href="featureGroups-class.html">featureGroups</a></code> object after blank subtraction. When both <code>blankThreshold</code> and this argument are
set, blank subtraction is performed prior to removing any analyses.</p></dd>
<dt>checkFeaturesSession</dt>
<dd><p>If set then features and/or feature groups are removed that were selected for removal
(see <a href="check-GUI.html">check-GUI</a>). The session files are typically generated with the <code><a href="check-GUI.html">checkFeatures</a></code> and
<code><a href="check-GUI.html">predictCheckFeaturesSession</a></code> functions. The value of <code>checkFeaturesSession</code> should either by a
path to the session file or <code>TRUE</code>, in which case the default session file name is used. If <code>negate=TRUE</code>
then all non-selected features/feature groups are removed instead.</p></dd>
<dt>negate</dt>
<dd><p>If set to <code>TRUE</code> then filtering operations are performed in opposite manner.</p></dd>
<dt>...</dt>
<dd><p>For <a href="sets-workflow.html">sets workflow</a> methods: further arguments passed to the base <code><a href="featureGroups-class.html">featureGroups</a></code> method.</p></dd>
<dt>sets</dt>
<dd><p>(<strong>sets workflow</strong>) A <code>character</code> with name(s) of the sets to keep (or remove if <code>negate=TRUE</code>).</p></dd>
<dt>absMinSets, relMinSets</dt>
<dd><p>(<strong>sets workflow</strong>) Feature groups are only kept when they contain data for at least this (absolute
or relative) amount of sets. Set to <code>NULL</code> to ignore.</p></dd>
<dt>fGroups, obj</dt>
<dd><p><code><a href="featureGroups-class.html">featureGroups</a></code> object to which the filter is applied.</p></dd>
<dt>threshold</dt>
<dd><p>Minimum relative threshold (compared to mean intensity of
replicate group being subtracted) for a feature group to be <em>not</em>
removed. When <samp>0</samp> a feature group is always removed when present in
the given replicate groups.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A filtered <code><a href="featureGroups-class.html">featureGroups</a></code> object. Feature groups that are filtered away have their intensity set
  to zero. In case a feature group is not present in any of the analyses anymore it will be removed completely.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><code>filter</code> performs common rule based filtering of feature groups such as blank subtraction, minimum
  intensity and minimum replicate abundance. Removing of features occurs by zeroing their intensity values.
  Furthermore, feature groups that are left completely empty (<em>i.e.</em> all intensities are zero) will be
  automatically removed.</p>
<p><code>replicateGroupSubtract</code> removes feature groups present in a
  given set of replicate groups (unless intensities are above a given
  threshold). The replicate groups that are subtracted will be removed.</p>
    </div>
    <div id="sets-workflows">
    <h2>Sets workflows</h2>
    <p>The following methods are changed or with new functionality:</p><ul><li><p><code>filter</code> has specific arguments to filter by (feature presence in) sets. See the argument descriptions.</p></li>
</ul></div>
    <div id="filter-order">
    <h2>Filter order</h2>
    <p>When multiple arguments are specified to <code>filter</code>, multiple filters are applied in
  sequence. Since some of these filters may affect each other, choosing their order correctly may be important for
  effective data filtering. For instance, when an intensity filter removes features from blank analyses, a subsequent
  blank filter may not adequately perform blank subtraction. Similarly, when intensity and blank filters are executed
  after the replicate abundance filter it may be necessary to ensure minimum replicate abundance again as the
  intensity and blank filters may have removed some features within a replicate group.</p>
<p>With this in mind, filters (if specified) occur in the following order:</p>
<p></p><ol><li><p>Features/feature groups selected for removal by the session specified by <code>checkFeaturesSession</code>.</p></li>
<li><p>Pre-Intensity filters (<em>i.e.</em> <code>preAbsMinIntensity</code> and <code>preRelMinIntensity</code>).</p></li>
<li><p>Chromatography and mass filters (<em>i.e</em> <code>retentionRange</code>, <code>mzRange</code>, <code>mzDefectRange</code>,
  <code>chromWidthRange</code>, <code>featQualityRange</code> and <code>groupQualityRange</code>).</p></li>
<li><p>Replicate abundance filters (<em>i.e.</em> <code>absMinReplicateAbundance</code>, <code>relMinReplicateAbundance</code> and
  <code>maxReplicateIntRSD</code>).</p></li>
<li><p>Blank filter (<em>i.e.</em> blankThreshold).</p></li>
<li><p>Intensity filters (<em>i.e.</em> <code>absMinIntensity</code> and <code>relMinIntensity</code>).</p></li>
<li><p>Replicate abundance filters (2nd time, only if previous filters affected results).</p></li>
<li><p>General abundance filters (<em>i.e.</em> <code>absMinAnalyses</code>, <code>relMinAnalyses</code>, <code>absMinReplicates</code>,
  <code>relMinReplicates</code>, <code>absMinFeatures</code> and <code>relMinFeatures</code>).</p></li>
<li><p>Replicate group filter (<em>i.e.</em> <code>rGroups</code>), results filter (<em>i.e.</em> <code>results</code>) and blank
  analyses removal (<em>i.e.</em> if <code>removeBlanks=TRUE</code>).</p></li>
</ol><p>If another filtering order is desired then <code>filter</code> should be called multiple times with only one filter
  argument at a time.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="featureGroups-class.html">featureGroups-class</a></code> and <code><a href="groupFeatures.html">groupFeatures</a></code></p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Rick Helmus.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

