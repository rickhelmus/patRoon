<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Base class for grouped features. — featureGroups-class • patRoon</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Base class for grouped features. — featureGroups-class"><meta property="og:description" content="This class holds all the information for grouped features."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">patRoon</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Reference
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../reference/index.html">Online</a>
    </li>
    <li>
      <a href="../reference/patRoon.pdf">PDF</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorial
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/tutorial.html">Online HTML page</a>
    </li>
    <li>
      <a href="../articles/tutorial.pdf">PDF</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Handbook
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../handbook_bd/index.html">Book format</a>
    </li>
    <li>
      <a href="../handbook_bd/handbook.pdf">PDF</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/rickhelmus/patRoon" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Base class for grouped features.</h1>
    <small class="dont-index">Source: <a href="https://github.com/rickhelmus/patRoon/blob/HEAD/R/feature_groups.R" class="external-link"><code>R/feature_groups.R</code></a>, <a href="https://github.com/rickhelmus/patRoon/blob/HEAD/R/feature_groups-set.R" class="external-link"><code>R/feature_groups-set.R</code></a>, <a href="https://github.com/rickhelmus/patRoon/blob/HEAD/R/feature_groups-bruker.R" class="external-link"><code>R/feature_groups-bruker.R</code></a>, and 6 more</small>
    <div class="hidden name"><code>featureGroups-class.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This class holds all the information for grouped features.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre><code># S4 method for featureGroups
names(x)

# S4 method for featureGroups
analyses(obj)

# S4 method for featureGroups
replicateGroups(obj)

# S4 method for featureGroups
groupNames(obj)

# S4 method for featureGroups
length(x)

# S4 method for featureGroups
show(object)

# S4 method for featureGroups
groupTable(object, areas = FALSE)

# S4 method for featureGroups
analysisInfo(obj)

# S4 method for featureGroups
groupInfo(fGroups)

# S4 method for featureGroups
featureTable(obj)

# S4 method for featureGroups
getFeatures(obj)

# S4 method for featureGroups
groupFeatIndex(fGroups)

# S4 method for featureGroups
groupQualities(fGroups)

# S4 method for featureGroups
groupScores(fGroups)

# S4 method for featureGroups
annotations(obj)

# S4 method for featureGroups
adducts(obj)

# S4 method for featureGroups
adducts(obj) &lt;- value

# S4 method for featureGroups,ANY,ANY,missing
[(x, i, j, ..., rGroups, results, drop = TRUE)

# S4 method for featureGroups,ANY,ANY
[[(x, i, j)

# S4 method for featureGroups
$(x, name)

# S4 method for featureGroups
delete(obj, i = NULL, j = NULL, ...)

# S4 method for featureGroups
export(obj, type, out)

# S4 method for featureGroups
as.data.table(
  x,
  average = FALSE,
  areas = FALSE,
  features = FALSE,
  qualities = FALSE,
  regression = FALSE,
  averageFunc = mean,
  normFunc = NULL,
  FCParams = NULL
)

# S4 method for featureGroups
unique(x, which, relativeTo = NULL, outer = FALSE)

# S4 method for featureGroups
overlap(fGroups, which, exclusive)

# S4 method for featureGroups
calculatePeakQualities(
  obj,
  weights,
  flatnessFactor,
  avgFunc = mean,
  parallel = TRUE
)

# S4 method for featureGroups
selectIons(
  fGroups,
  components,
  prefAdduct,
  onlyMonoIso = TRUE,
  chargeMismatch = "adduct"
)

# S4 method for featureGroupsSet
sets(obj)

# S4 method for featureGroupsSet
adducts(obj, set, ...)

# S4 method for featureGroupsSet
adducts(obj, set, reGroup = TRUE) &lt;- value

# S4 method for featureGroupsSet
delete(obj, i = NULL, j = NULL, ...)

# S4 method for featureGroupsSet
show(object)

# S4 method for featureGroupsSet
featureTable(obj)

# S4 method for featureGroupsSet,ANY,ANY,missing
[(x, i, j, ..., rGroups, sets = NULL, drop = TRUE)

# S4 method for featureGroupsSet
export(obj, type, out, set)

# S4 method for featureGroupsSet
as.data.table(
  x,
  average = FALSE,
  areas = FALSE,
  features = FALSE,
  qualities = FALSE,
  regression = FALSE,
  averageFunc = mean,
  normFunc = NULL,
  FCParams = NULL
)

# S4 method for featureGroupsSet
unique(x, which, ..., sets = FALSE)

# S4 method for featureGroupsSet
overlap(fGroups, which, exclusive, sets = FALSE)

# S4 method for featureGroupsSet
selectIons(fGroups, components, prefAdduct, ...)

# S4 method for featureGroupsSet
unset(obj, set)

# S4 method for featureGroupsKPIC2
delete(obj, ...)

# S4 method for featureGroupsXCMS
delete(obj, ...)

# S4 method for featureGroupsXCMS3
delete(obj, ...)</code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>areas</dt>
<dd><p>If set to <code>TRUE</code> then areas are considered instead of peak intensities.</p>
<p>For <code>as.data.table</code>: ignored if <code>features=TRUE</code>, as areas of features are always reported.</p></dd>
<dt>fGroups, obj, x, object</dt>
<dd><p><code>featureGroups</code> object to be accessed.</p></dd>
<dt>value</dt>
<dd><p>For <code>adducts&lt;-</code>: A <code>character</code> with adduct annotations assigned to each feature group. The
length should equal the number of feature groups. Can be named with feature group names to customize the assignment
order.</p></dd>
<dt>i, j</dt>
<dd><p>For <code>[</code>/<code>[[</code>: A numeric or character value which is used to select analyses/feature groups by
their index or name, respectively (for the order/names see <code>analyses()/names()</code>).<br><br> For <code>[</code>: Can also be logical to perform logical selection
(similar to regular vectors). If missing all analyses/feature groups are selected.<br><br> For <code>[[</code>: should be a scalar value. If <code>j</code> is not specified, <code>i</code> selects by feature groups instead.<br><br> For <code>delete</code>: The data to remove from. <code>i</code> are the
analyses as numeric index, logical or character, <code>j</code> the feature groups as numeric index, logical or character. If either is
<code>NULL</code> then data for all is removed. <code>j</code> may also be a function: it will be called for each 
feature group, with a vector of the group intensities as first argument, the group name as second argument, and any other arguments passed as
<code>...</code> to <code>delete</code>. The return value of this function specifies the analyses of the features in the group to be removed (same format as <code>i</code>).</p></dd>
<dt>...</dt>
<dd><p>For the <code>"["</code> operator: ignored.</p>
<p>For <code>delete</code>: passed to the function specified as <code>j</code>.</p>
<p>For <a href="sets-workflow.html">sets workflow</a> methods: further arguments passed to the base <code>featureGroups</code> method.</p></dd>
<dt>rGroups</dt>
<dd><p>For <code>[</code>: An optional <code>character</code> vector: if specified only keep results for the given
replicate groups (equivalent to the <code>rGroups</code> argument to <code><a href="feature-filtering.html">filter</a></code>).</p></dd>
<dt>results</dt>
<dd><p>Optional argument. If specified only feature groups with results in the specified object are kept. The
class of <code>results</code> should be <code><a href="featureAnnotations-class.html">featureAnnotations</a></code> or <code><a href="components-class.html">components</a></code>. Multiple objects
can be specified in a <code>list</code>: in this case a feature group is kept if it has a result in <em>any</em> of the
objects (equivalent to the <code>results</code> argument to <code><a href="feature-filtering.html">filter</a></code>).</p></dd>
<dt>drop</dt>
<dd><p>ignored.</p></dd>
<dt>name</dt>
<dd><p>The feature group name (partially matched).</p></dd>
<dt>type</dt>
<dd><p>The export type: <code>"brukerpa"</code> (Bruker ProfileAnalysis), <code>"brukertasq"</code> (Bruker TASQ) or
<code>"mzmine"</code> (MZmine).</p></dd>
<dt>out</dt>
<dd><p>The destination file for the exported data.</p></dd>
<dt>average</dt>
<dd><p>If <code>TRUE</code> then data within replicate groups are averaged.</p>
<p>For <code>as.data.table</code>: if <code>features=TRUE</code> other feature properties are also averaged.</p></dd>
<dt>features</dt>
<dd><p>If <code>TRUE</code> then feature specific data will be added. If <code>average=TRUE</code> this data will be
averaged for each feature group.</p></dd>
<dt>qualities</dt>
<dd><p>Adds feature (group) qualities (<code>qualities="quality"</code>), scores (<code>qualities="score"</code>) or
both (<code>qualities="both"</code>), if this data is available (<em>i.e.</em> from <code>calculatePeakQualities</code>). If
<code>qualities=FALSE</code> then nothing is reported.</p></dd>
<dt>regression</dt>
<dd><p>Set to <code>TRUE</code> to add regression data for each feature group. For this a linear model is
created (intensity/area [depending on <code>areas</code> argument] <em>vs</em> concentration). The model concentrations
(e.g. of a set of standards) is derived from the <code>conc</code> column of the <a href="analysis-information.html">analysis
information</a>. From this model the intercept, slope and R2 is added to the output. In addition, when
<code>features=TRUE</code>, concentrations for each feature are added. Note that no regression information is added when
no <code>conc</code> column is present in the analysis information or when less than two concentrations are specified
(<em>i.e.</em> the minimum amount).</p></dd>
<dt>averageFunc</dt>
<dd><p>Function used for averaging. Only used when <code>average=TRUE</code> or <code>FCParams != NULL</code>.</p></dd>
<dt>normFunc</dt>
<dd><p>Function that should be used for normalization of data. The function is called for all
intensities/areas of a feature group and these quantities are divided by the result of the function call. For
example, when <code><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></code> is used normalized intensities will be between zero and one. If all quantities are
zero then the function will not be called. Set to <code>NULL</code> to perform no normalization.</p></dd>
<dt>FCParams</dt>
<dd><p>A parameter list to calculate Fold change data. See <code>getFCParams</code> for more details. Set to
<code>NULL</code> to not perform FC calculations.</p></dd>
<dt>which</dt>
<dd><p>A character vector with replicate groups used for comparison.</p></dd>
<dt>relativeTo</dt>
<dd><p>A character vector with replicate groups that should be
used for unique comparison. If <code>NULL</code> then all replicate groups are
used for comparison. Replicate groups specified in <code>which</code> are
ignored.</p></dd>
<dt>outer</dt>
<dd><p>If <code>TRUE</code> then only feature groups are kept which do not
overlap between the specified replicate groups for the <code>which</code>
parameter.</p></dd>
<dt>exclusive</dt>
<dd><p>If <code>TRUE</code> then all feature groups are removed that are
not unique to the given replicate groups.</p></dd>
<dt>weights</dt>
<dd><p>A named <code>numeric</code> vector that defines the weight for each score to calculate the
<code>totalScore</code>. The names of the vector follow the score names. Unspecified weights are defaulted to <samp>1</samp>.
Example: <code>weights=c(ApexBoundaryRatioScore=0.5, GaussianSimilarityScore=2)</code>.</p></dd>
<dt>flatnessFactor</dt>
<dd><p>Passed to <span class="pkg">MetaClean</span> as the <code>flatness.factor</code> argument to
<code><a href="https://rdrr.io/pkg/MetaClean/man/calculateJaggedness.html" class="external-link">calculateJaggedness</a></code> and <code><a href="https://rdrr.io/pkg/MetaClean/man/calculateModality.html" class="external-link">calculateModality</a></code>.</p></dd>
<dt>avgFunc</dt>
<dd><p>The function used to average the peak qualities and scores for each feature group.</p></dd>
<dt>parallel</dt>
<dd><p>If set to <code>TRUE</code> then code is executed in parallel through the <a href="https://CRAN.R-project.org/package=futures" class="external-link"><span class="pkg">futures</span></a> package. Please
see the parallelization section in the handbook for more details.</p></dd>
<dt>components</dt>
<dd><p>The <code>components</code> object that was generated for the given <code>featureGroups</code> object.
Obviously, the components must be created with algorithms that support adduct/isotope annotations, such as those
from <span class="pkg">RAMClustR</span> and <span class="pkg">cliqueMS</span>.</p></dd>
<dt>prefAdduct</dt>
<dd><p>The 'preferred adduct' (see method description). This is often <code>"[M+H]+"</code> or <code>"[M-H]-"</code>.</p></dd>
<dt>onlyMonoIso</dt>
<dd><p>Set to <code>TRUE</code> to only keep feature groups that were annotated as monoisotopic. Feature groups
are never removed by this setting if no isotope annotations are available.</p></dd>
<dt>chargeMismatch</dt>
<dd><p>Specifies how to deal with a mismatch in charge between adduct and isotope annotations. Valid
values are: <code>"adduct"</code> (ignore isotope annotation), <code>"isotope"</code> (ignore adduct annotation), <code>"none"</code>
(ignore both annotations) and <code>"ignore"</code> (don't check for charge mismatches). <em>Important</em>: when
<code class="command">OpenMS</code> is used to find features, it already removes any detected non-monoisotopic features by default.
Hence, in such case setting <code>chargeMismatch="adduct"</code> is more appropriate.</p></dd>
<dt>set</dt>
<dd><p>(<strong>sets workflow</strong>) The name of the set.</p></dd>
<dt>reGroup</dt>
<dd><p>(<strong>sets workflow</strong>) Set to <code>TRUE</code> to re-group the features after the adduct annotations are changed. See the
<code>Sets workflow</code> section for more details.</p></dd>
<dt>sets</dt>
<dd><p>(<strong>sets workflow</strong>) For <code>[</code>: a <code>character</code> with name(s) of the sets to keep.</p>
<p>For <code>overlap</code> and <code>unique</code>: If <code>TRUE</code> then the <code>which</code> argument changes its meaning and is used
  to specify the names of the sets to be compared.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code>delete</code> returns the object for which the specified data was removed.
<code>calculatePeakQualities</code> returns a modified object amended with peak qualities and scores.
<code>selectIons</code> returns a <code>featureGroups</code> object with only the selected feature groups and amended
  with adduct annotations.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The <code>featureGroup</code> class is the workhorse of <span class="pkg">patRoon</span>: almost all functionality operate on its instantiated
objects. The class holds all information from grouped features (obtained from <code><a href="features-class.html">features</a></code>). This class
itself is <code>virtual</code>, hence, objects are not created directly from it. Instead, 'feature groupers' such as
<code><a href="groupFeaturesXCMS.html">groupFeaturesXCMS</a></code> return a <code>featureGroups</code> derived object after performing the actual grouping of
features across analyses.</p>
    </div>
    <div id="methods-by-generic-">
    <h2>Methods (by generic)</h2>
    
<ul><li><p><code>names</code>: Obtain feature group names.</p></li>
<li><p><code>analyses</code>: returns a <code>character</code> vector with the names of the
analyses for which data is present in this object.</p></li>
<li><p><code>replicateGroups</code>: returns a <code>character</code> vector with the names of the
replicate groups for which data is present in this object.</p></li>
<li><p><code>groupNames</code>: Same as <code>names</code>. Provided for consistency to other classes.</p></li>
<li><p><code>length</code>: Obtain number of feature groups.</p></li>
<li><p><code>show</code>: Shows summary information for this object.</p></li>
<li><p><code>groupTable</code>: Accessor for <code>groups</code> slot.</p></li>
<li><p><code>analysisInfo</code>: Obtain analysisInfo (see analysisInfo slot in <code><a href="features-class.html">features</a></code>).</p></li>
<li><p><code>groupInfo</code>: Accessor for <code>groupInfo</code> slot.</p></li>
<li><p><code>featureTable</code>: Obtain feature information (see <code><a href="features-class.html">features</a></code>).</p></li>
<li><p><code>getFeatures</code>: Accessor for <code>features</code> slot.</p></li>
<li><p><code>groupFeatIndex</code>: Accessor for <code>ftindex</code> slot.</p></li>
<li><p><code>groupQualities</code>: Accessor for <code>groupQualities</code> slot.</p></li>
<li><p><code>groupScores</code>: Accessor for <code>groupScores</code> slot.</p></li>
<li><p><code>annotations</code>: Accessor for <code>annotations</code> slot.</p></li>
<li><p><code>adducts</code>: Returns a named <code>character</code> with adduct annotations assigned to each feature group (if
available).</p></li>
<li><p><code>adducts&lt;-</code>: Sets adduct annotations for feature groups.</p></li>
<li><p><code>[</code>: Subset on analyses/feature groups.</p></li>
<li><p><code>[[</code>: Extract intensity values.</p></li>
<li><p><code>$</code>: Extract intensity values for a feature group.</p></li>
<li><p><code>delete</code>: Completely deletes specified feature groups.</p></li>
<li><p><code>export</code>: Exports feature groups to a <code class="file">.csv</code> file that is readable to Bruker ProfileAnalysis (a
'bucket table'), Bruker TASQ (an analyte database) or that is suitable as input for the <code>Targeted peak
detection</code> functionality of <a href="http://mzmine.github.io/" class="external-link">MZmine</a>.</p></li>
<li><p><code>as.data.table</code>: Obtain a summary table (a <code>data.table</code>) with retention, <em>m/z</em>, intensity
and optionally other feature data.</p></li>
<li><p><code>unique</code>: Obtain a subset with unique feature groups
present in one or more specified replicate group(s).</p></li>
<li><p><code>overlap</code>: Obtain a subset with feature groups that overlap
between a set of specified replicate group(s).</p></li>
<li><p><code>calculatePeakQualities</code>: Calculates peak and group qualities for all features and feature groups. The peak qualities
(and scores) are calculated with the <a href="features-class.html">features method of this
function</a>, and subsequently averaged per feature group. Then, <span class="pkg">MetaClean</span> is used to calculate the
<code>Elution Shift</code> and <code>Retention Time Consistency</code> group quality metrics (see the <span class="pkg">MetaClean</span>
publication cited below for more details). Similarly to the <code><a href="features-class.html">features</a></code> method, these metrics are scored
by normalizing qualities among all groups and scaling them from <samp>0</samp> (worst) to <samp>1</samp> (best). The
<code>totalScore</code> for each group is then calculated as the weighted sum from all feature (group) scores. The
<code><a href="check-GUI.html">getMCTrainData</a></code> and <code><a href="check-GUI.html">predictCheckFeaturesSession</a></code> functions can be used to train and apply
Pass/Fail ML models from <span class="pkg">MetaClean</span>.</p></li>
<li><p><code>selectIons</code>: uses <a href="generateComponents.html">componentization</a> results to select feature groups with
preferred adduct ion and/or isotope annotation. Typically, this means that only feature groups are kept if they are
(de-)protonated adducts and are monoisotopic. The adduct annotation assignments for the selected feature groups are
copied from the components to the <code>annotations</code> slot. If the adduct for a feature group is unknown, its
annotation is defaulted to the 'preferred' adduct, and hence, the feature group will never be removed. Furthermore,
if a component does not contain an annotation with the preferred adduct, the most intense feature group is selected
instead. Similarly, if no isotope annotation is available, the feature group is assumed to be monoisotopic and thus
not removed. An important advantage of <code>selectIons</code> is that it may considerably simplify your dataset.
Furthermore, the adduct assignments allow formula/compound annotation steps later in the workflow to improve their
annotation accuracy. On the other hand, it is important the componentization results are reliable. Hence, it is
highly recommended that, prior to calling <code>selectIons</code>, the settings to <code><a href="generateComponents.html">generateComponents</a></code> are
optimized and its results are reviewed with <code><a href="check-GUI.html">checkComponents</a></code>. Finally, the <code>adducts&lt;-</code> method can
be used to manually correct adduct assignments afterwards if necessary.</p></li>
</ul></div>
    <div id="slots">
    <h2>Slots</h2>
    

<dl><dt><code>groups</code></dt>
<dd><p>Matrix (<code>data.table</code>) with intensities for each feature group (columns) per analysis (rows).
Access with <code>groups</code> method.</p></dd>


<dt><code>analysisInfo,features</code></dt>
<dd><p><a href="analysis-information.html">Analysis info</a> and <code><a href="features-class.html">features</a></code> class associated
with this object. Access with <code>analysisInfo</code> and <code>featureTable</code> methods, respectively.</p></dd>


<dt><code>groupInfo</code></dt>
<dd><p><code>data.frame</code> with retention time (<code>rts</code> column, in seconds) and <em>m/z</em> (<code>mzs</code>
column) for each feature group. Access with <code>groupInfo</code> method.</p></dd>


<dt><code>ftindex</code></dt>
<dd><p>Matrix (<code>data.table</code>) with feature indices for each feature group (columns) per analysis
(rows). Each index corresponds to the row within the feature table of the analysis (see
<code><a href="generics.html">featureTable</a></code>).</p></dd>


<dt><code>groupQualities,groupScores</code></dt>
<dd><p>A <code>data.table</code> with qualities/scores for each feature group (see the
<code>calculatePeakQualities</code> method).</p></dd>


<dt><code>annotations</code></dt>
<dd><p>A <code>data.table</code> with adduct annotations for each group (see the <code>selectIons</code>
method).</p></dd>


<dt><code>groupAlgo,groupArgs,groupVerbose</code></dt>
<dd><p>(<strong>sets workflow</strong>) Grouping parameters that were used when this object was created. Used
by <code>adducts&lt;-</code> and <code>selectIons</code> when these methods perform a re-grouping of features.</p></dd>


<dt><code>annotations</code></dt>
<dd><p>(<strong>sets workflow</strong>) As the <code>featureGroups</code> slot, but contains the annotation data per set.</p></dd>


</dl></div>
    <div id="s-class-hierarchy">
    <h2>S4 class hierarchy</h2>
    <p></p><ul><li><p><code><a href="workflowStep-class.html">workflowStep</a></code></p><ul><li><p><strong><code>featureGroups</code></strong></p><ul><li><p><code>featureGroupsSet</code></p><ul><li><p><code><a href="featureGroupsScreening-class.html">featureGroupsScreeningSet</a></code></p></li>
</ul></li>
<li><p><code>featureGroupsUnset</code></p></li>
<li><p><code><a href="featureGroupsScreening-class.html">featureGroupsScreening</a></code></p><ul><li><p><code><a href="featureGroupsScreening-class.html">featureGroupsSetScreeningUnset</a></code></p></li>
</ul></li>
<li><p><code>featureGroupsBruker</code></p></li>
<li><p><code><a href="featureGroups-compare.html">featureGroupsConsensus</a></code></p></li>
<li><p><code>featureGroupsEnviMass</code></p></li>
<li><p><code>featureGroupsKPIC2</code></p></li>
<li><p><code>featureGroupsOpenMS</code></p></li>
<li><p><code>featureGroupsSIRIUS</code></p></li>
<li><p><code><a href="suspect-screening.html">featureGroupsBrukerTASQ</a></code></p></li>
<li><p><code>featureGroupsXCMS</code></p></li>
<li><p><code>featureGroupsXCMS3</code></p></li>
</ul></li>
</ul></li>
</ul></div>
    <div id="sets-workflows">
    <h2>Sets workflows</h2>
    <p>The <code>featureGroupsSet</code> class is applicable for <a href="sets-workflow.html">sets workflows</a>. This class is derived from <code>featureGroups</code> and therefore largely follows the same user interface.</p>
<p>The following methods are specifically defined for sets workflows:</p><ul><li><p><code>sets</code> Returns the set names for this object.</p></li>
<li><p><code>unset</code> Converts the object data for a specified set into a 'non-set' object (<code>featureGroupsUnset</code>), which allows it to be used in 'regular' workflows. The adduct annotations for the selected set are used to convert all
  feature (group) masses to ionic <em>m/z</em> values. The annotations persist in the converted object.</p></li>
</ul><p>The following methods are changed or with new functionality:</p><ul><li><p><code>adducts</code>, <code>adducts&lt;-</code> require the <code>set</code> argument. The order of the data that is
  returned/changed follows that of the <code>annotations</code> slot. Furthermore, <code>adducts&lt;-</code> will perform a
  re-grouping of features when its <code>reGroup</code> parameter is set to <code>TRUE</code>. The implications for this are
  discussed below.</p></li>
<li><p>the subset operator (<code>[</code>) has specific arguments to choose (feature presence in) sets. See the argument
  descriptions.</p></li>
<li><p><code>as.data.table</code>: normalization of intensities is performed per set.</p></li>
<li><p><code>export</code> Only allows to export data from one set. The <code>unset</code> method is used prior to exporting the
  data.</p></li>
<li><p><code>overlap</code> and <code>unique</code> allow to handle data per set. See the <code>sets</code> argument description.</p></li>
<li><p><code>selectIons</code> Will perform a re-grouping of features. The implications of this are discussed below.</p></li>
</ul><p>A re-grouping of features occurs if <code>selectIons</code> is called or <code>adducts&lt;-</code> is used with
  <code>reGroup=TRUE</code>. Afterwards, it is very likely that feature group names are changed. Since data generated later
  in the workflow (<em>e.g.</em> annotation steps) rely on feature group names, these objects are <strong>not valid</strong>
  anymore, and <strong>must</strong> be re-generated.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Chetnik K, Petrick L, Pandey G (2020).
“MetaClean: a machine learning-based classifier for reduced false positive peak detection in untargeted LC-MS metabolomics data.”
<em>Metabolomics</em>, <b>16</b>(11).
<a href="https://doi.org/10.1007/s11306-020-01738-3" class="external-link">doi:10.1007/s11306-020-01738-3</a>
.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="groupFeatures.html">groupFeatures</a></code> for generating feature groups, <a href="feature-filtering.html">feature-filtering</a> and
  <a href="feature-plotting.html">feature-plotting</a> for more advanced <code>featureGroups</code> methods.</p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Rick Helmus.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

