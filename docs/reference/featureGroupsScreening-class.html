<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Class for suspect screened feature groups. — featureGroupsScreening-class • patRoon</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Class for suspect screened feature groups. — featureGroupsScreening-class"><meta property="og:description" content="This class derives from featureGroups and adds suspect screening information."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">patRoon</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Reference
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../reference/index.html">Online</a>
    </li>
    <li>
      <a href="../reference/patRoon.pdf">PDF</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorial
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/tutorial.html">Online HTML page</a>
    </li>
    <li>
      <a href="../articles/tutorial.pdf">PDF</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Handbook
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../handbook_bd/index.html">Book format</a>
    </li>
    <li>
      <a href="../handbook_bd/handbook.pdf">PDF</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/rickhelmus/patRoon" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Class for suspect screened feature groups.</h1>
    <small class="dont-index">Source: <a href="https://github.com/rickhelmus/patRoon/blob/HEAD/R/feature_groups-screening.R" class="external-link"><code>R/feature_groups-screening.R</code></a>, <a href="https://github.com/rickhelmus/patRoon/blob/HEAD/R/feature_groups-screening-set.R" class="external-link"><code>R/feature_groups-screening-set.R</code></a></small>
    <div class="hidden name"><code>featureGroupsScreening-class.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This class derives from <code><a href="featureGroups-class.html">featureGroups</a></code> and adds suspect screening information.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre><code># S4 method for featureGroupsScreening
screenInfo(obj)

# S4 method for featureGroupsScreening
show(object)

# S4 method for featureGroupsScreening,ANY,ANY,missing
[(x, i, j, ..., rGroups, suspects = NULL, drop = TRUE)

# S4 method for featureGroupsScreening
delete(obj, i = NULL, j = NULL, ...)

# S4 method for featureGroupsScreening
as.data.table(x, ..., collapseSuspects = ",", onlyHits = FALSE)

# S4 method for featureGroupsScreening
annotateSuspects(
  fGroups,
  MSPeakLists,
  formulas,
  compounds,
  absMzDev = 0.005,
  relMinMSMSIntensity = 0.05,
  simMSMSMethod = "cosine",
  checkFragments = c("mz", "formula", "compound"),
  formulasNormalizeScores = "max",
  compoundsNormalizeScores = "max",
  IDFile = system.file("misc", "IDLevelRules.yml", package = "patRoon"),
  logPath = file.path("log", "ident")
)

# S4 method for featureGroupsScreening
filter(
  obj,
  ...,
  onlyHits = NULL,
  selectHitsBy = NULL,
  selectBestFGroups = FALSE,
  maxLevel = NULL,
  maxFormRank = NULL,
  maxCompRank = NULL,
  minAnnSimForm = NULL,
  minAnnSimComp = NULL,
  minAnnSimBoth = NULL,
  absMinFragMatches = NULL,
  relMinFragMatches = NULL,
  negate = FALSE
)

# S4 method for featureGroupsScreeningSet
screenInfo(obj)

# S4 method for featureGroupsScreeningSet
show(object)

# S4 method for featureGroupsScreeningSet,ANY,ANY,missing
[(x, i, j, ..., rGroups, suspects = NULL, sets = NULL, drop = TRUE)

# S4 method for featureGroupsScreeningSet
delete(obj, i = NULL, j = NULL, ...)

# S4 method for featureGroupsScreeningSet
as.data.table(x, ..., collapseSuspects = ",", onlyHits = FALSE)

# S4 method for featureGroupsScreeningSet
annotateSuspects(
  fGroups,
  MSPeakLists = NULL,
  formulas = NULL,
  compounds = NULL,
  ...
)

# S4 method for featureGroupsScreeningSet
filter(
  obj,
  ...,
  onlyHits = NULL,
  selectHitsBy = NULL,
  selectBestFGroups = FALSE,
  maxLevel = NULL,
  maxFormRank = NULL,
  maxCompRank = NULL,
  minAnnSimForm = NULL,
  minAnnSimComp = NULL,
  minAnnSimBoth = NULL,
  absMinFragMatches = NULL,
  relMinFragMatches = NULL,
  negate = FALSE
)

# S4 method for featureGroupsScreeningSet
unset(obj, set)</code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>obj, object, x, fGroups</dt>
<dd><p>The <code>featureGroupsScreening</code> object.</p></dd>


<dt>i, j, rGroups</dt>
<dd><p>Used for subsetting data analyses, feature groups and
replicate groups, see <code><a href="featureGroups-class.html">featureGroups</a></code>.</p></dd>


<dt>...</dt>
<dd><p>Further arguments passed to the base method.</p></dd>


<dt>suspects</dt>
<dd><p>An optional <code>character</code> vector with suspect names. If
specified, only <code>featureGroups</code> will be kept that are assigned to
these suspects.</p></dd>


<dt>drop</dt>
<dd><p>Ignored.</p></dd>


<dt>collapseSuspects</dt>
<dd><p>If a <code>character</code> then any suspects that were
matched to the same feature group are collapsed to a single row and suspect
names are separated by the value of <code>collapseSuspects</code>. If <code>NULL</code>
then no collapsing occurs, and each suspect match is reported on a single
row. Note that some columns will not be reported when collapsing is
enabled.</p></dd>


<dt>onlyHits</dt>
<dd><p>For <code>as.data.table</code>: if <code>TRUE</code> then only feature groups with suspect hits are reported.</p>
<p>For <code>filter</code></p><ul><li><p>if <code>negate=FALSE</code> and <code>onlyHits=TRUE</code> then all feature groups without suspect hits will be removed.
  Otherwise nothing will be done.</p></li>
<li><p>if <code>negate=TRUE</code> then <code>onlyHits=TRUE</code> will select feature groups without suspect hits,
  <code>onlyHits=FALSE</code> will only retain feature groups with suspect matches and this filter is ignored if
  <code>onlyHits=NULL</code>.</p></li>
</ul></dd>


<dt>MSPeakLists, formulas, compounds</dt>
<dd><p>Annotation data (<code><a href="MSPeakLists-class.html">MSPeakLists</a></code>, <code><a href="formulas-class.html">formulas</a></code> and
<code><a href="compounds-class.html">compounds</a></code>) obtained for this <code>featureGroupsScreening</code> object. All arguments can be <code>NULL</code>
to exclude it from the annotation.</p></dd>


<dt>absMzDev</dt>
<dd><p>Maximum absolute <em>m/z</em> deviation.</p></dd>


<dt>relMinMSMSIntensity</dt>
<dd><p>Minimum relative intensity (<samp>0-1</samp>) threshold applied when calculating annotation
similarities.</p></dd>


<dt>simMSMSMethod</dt>
<dd><p>Either <code>"cosine"</code> or <code>"jaccard"</code>: used to compare MS/MS peak lists for annotation
similarity calculation.</p></dd>


<dt>checkFragments</dt>
<dd><p>Which type(s) of MS/MS fragments from workflow data should be checked to evaluate the number of
suspect fragment matches (<em>i.e.</em> from the <code>fragments_mz</code>/<code>fragments_formula</code> columns in the suspect
list). Valid values are: <code>"mz"</code>, <code>"formula"</code>, <code>"compounds"</code>. The former uses <em>m/z</em> values in
the specified <code>MSPeakLists</code> object, whereas the others use the formulae that were annotated to MS/MS peaks in
the given <code>formulas</code> or <code>compounds</code> objects. Multiple values are possible: in this case the maximum
number of fragment matches will be reported.</p></dd>


<dt>compoundsNormalizeScores, formulasNormalizeScores</dt>
<dd><p>A <code>character</code> that specifies how normalization of
annotation scorings occurs. Either</p>
<p><code>"max"</code> (normalize to max value) or <code>"minmax"</code> (perform min-max
normalization). Note that normalization of negative scores (e.g. output by
<code class="command">SIRIUS</code>) is always performed as min-max. Furthermore, currently
normalization for <code>compounds</code> takes the original min/max scoring
values into account when candidates were generated. Thus, for
<code>compounds</code> scoring, normalization is not affected when candidate
results were removed after they were generated (<em>e.g.</em> by use of
<code>filter</code>).</p></dd>


<dt>IDFile</dt>
<dd><p>A file path to a YAML file with rules used for estimation of identification levels. See the
<code>Suspect annotation</code> section for more details. If not specified then a default rules file will be used.</p></dd>


<dt>logPath</dt>
<dd><p>A directory path to store logging information. If <code>NULL</code> then logging is disabled.</p></dd>


<dt>selectHitsBy</dt>
<dd><p>Should be <code>"intensity"</code> or <code>"level"</code>. For cases
where the same suspect is matched to multiple feature groups, only the
suspect to the feature group with highest mean intensity
(<code>selectHitsBy="intensity"</code>) or best identification level
(<code>selectHitsBy="level"</code>) is kept. In case of ties only the first hit
is kept. Set to <code>NULL</code> to ignore this filter. If <code>negate=TRUE</code>
then only those hits with lowest mean intensity/poorest identification
level are kept.</p></dd>


<dt>selectBestFGroups</dt>
<dd><p>If <code>TRUE</code> then for any cases where a single
feature group is matched to several suspects only the suspect assigned to
the feature group with best identification score is kept. In case of ties
only the first is kept.</p></dd>


<dt>maxLevel, maxFormRank, maxCompRank, minAnnSimForm, minAnnSimComp, minAnnSimBoth</dt>
<dd><p>Filter suspects by maximum identification level (<em>e.g.</em> <code>"3a"</code>),
formula/compound rank or with minimum formula/compound/combined annotation
similarity. Set to <code>NULL</code> to ignore.</p></dd>


<dt>absMinFragMatches, relMinFragMatches</dt>
<dd><p>Only retain suspects with this
minimum number MS/MS matches with the fragments specified in the suspect
list (<em>i.e.</em> <code>fragments_mz</code>/<code>fragments_formula</code>).
<code>relMinFragMatches</code> sets the minimum that is relative (<samp>0-1</samp>) to
the maximum number of MS/MS fragments specified in the <code>fragments_*</code>
columns of the suspect list. Set to <code>NULL</code> to ignore.</p></dd>


<dt>negate</dt>
<dd><p>If set to <code>TRUE</code> then filtering operations are performed
in opposite manner.</p></dd>


<dt>sets</dt>
<dd><p>(<strong>sets workflow</strong>) A <code>character</code> with name(s) of the sets to keep (or remove if <code>negate=TRUE</code>).</p></dd>


<dt>set</dt>
<dd><p>(<strong>sets workflow</strong>) The name of the set.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p><code>annotateSuspects</code> returns a <code>featureGroupsScreening</code> object, which is a</p>
<p></p>
<p><code><a href="featureGroups-class.html">featureGroups</a></code> object amended with annotation data.</p>


<p><code>filter</code> returns a filtered <code>featureGroupsScreening</code></p>


<p>object.</p>
    </div>
    <div id="methods-by-generic-">
    <h2>Methods (by generic)</h2>
    
<ul><li><p><code>screenInfo</code>: Returns a table with screening information
(see <code>screenInfo</code> slot).</p></li>
<li><p><code>show</code>: Shows summary information for this object.</p></li>
<li><p><code>[</code>: Subset on analyses, feature groups and/or
suspects.</p></li>
<li><p><code>as.data.table</code>: Obtain a summary table (a
<code>data.table</code>) with retention, <em>m/z</em>, intensity and
optionally other feature data. Furthermore, the output table will be merged
with information from <code>screenInfo</code>, such as suspect names and other
properties and annotation data.</p></li>
<li><p><code>annotateSuspects</code>: Incorporates annotation data obtained during the workflow to annotate suspects
with matched known MS/MS fragments, formula/candidate ranks and automatic estimation of identification levels. See
the <code>Suspect annotation</code> section for more details. The estimation of identification levels for each suspect is
logged in the <code>log/ident</code> directory.</p></li>
<li><p><code>filter</code>: Performs rule based filtering. This method
builds on the comprehensive filter functionality from the base
<code><a href="feature-filtering.html">filter,featureGroups-method</a></code>. It adds several filters to
select <em>e.g.</em> the best ranked suspects or those with a minimum
estimated identification level. <strong>NOTE</strong>: most filters <em>only</em>
affect suspect hits, not feature groups. Set <code>onlyHits=TRUE</code> to
subsequently remove any feature groups that lost any suspect matches due to
other filter steps.</p></li>
</ul></div>
    <div id="slots">
    <h2>Slots</h2>
    

<dl><dt><code>screenInfo</code></dt>
<dd><p>A (<code>data.table</code>) with results from suspect screening. This table will be amended with
annotation data when <code>annotateSuspects</code> is run.</p></dd>


</dl></div>
    <div id="note">
    <h2>Note</h2>
    <p>The <code>relMinMSMSIntensity</code> filter argument to <code>annotateSuspects</code> is applied <em>after</em> removing the
  precursor ion from the peak lists (if present). Thus, intensity scales may be different when this filter is applied
  when the most abundant peak resulted from the precursor ion.</p>
<p><code>filter</code> removes suspect hits with <code>NA</code> values when any of
  the filters related to minimum or maximum values are applied (unless
  <code>negate=TRUE</code>).</p>
    </div>
    <div id="suspect-annotation">
    <h2>Suspect annotation</h2>
    <p>The <code>annotateSuspects</code> method is used to annotate suspects after
  <code><a href="suspect-screening.html">screenSuspects</a></code> was used to collect suspect screening results and other workflow steps such as formula
  and compound annotation steps have been completed. The annotation results, which can be acquired with the
  <code>as.data.table</code> and <code>screenInfo</code> methods, amends the current screening data with the following columns:</p>
<p></p><ul><li><p><code>formRank</code>,<code>compRank</code> The rank of the suspect within the formula/compound annotation results.</p></li>
<li><p><code>annSimForm</code>,<code>annSimComp</code>,<code>annSimBoth</code> A similarity measure between measured and annotated
  MS/MS peaks from annotation of formulae, compounds or both. The similarity is calculated as the spectral similarity
  between a peaklist with (a) all MS/MS peaks and (b) only annotated peaks. Thus, a value of one means that all MS/MS
  peaks were annotated. If both formula and compound annotations are available then <code>annSimBoth</code> is calculated
  after combining all the annotated peaks, otherwise <code>annSimBoth</code> equals the available value for
  <code>annSimForm</code> or <code>annSimComp</code>. The similarity calculation can be configured with the
  <code>relMinMSMSIntensity</code> and <code>simMSMSMethod</code> arguments to <code>annotateSuspects</code>. Note for annotation with
  <code>generateCompoundsLibrary</code> results: the method and default parameters for <code>annSimComp</code> calculation
  slightly differs to those from the spectral similarity calculated with compound annotation (<code>libMatch</code> score),
  hence small differences in results are typically observed.</p></li>
<li><p><code>maxFrags</code> The maximum number of MS/MS fragments that can be matched for this suspect (based on the
  <code>fragments_*</code> columns from the suspect list).</p></li>
<li><p><code>maxFragMatches</code>,<code>maxFragMatchesRel</code> The absolute and relative amount of experimental MS/MS peaks
  that were matched from the fragments specified in the suspect list. The value for <code>maxFragMatchesRel</code> is
  relative to the value for <code>maxFrags</code>. The calculation of this column is influenced by the
  <code>checkFragments</code> argument to <code>annotateSuspects</code>.</p></li>
<li><p><code>estIDLevel</code> Provides an <em>estimation</em> of the identification level, roughly following that of
  (Schymanski et al. 2014)
. However, please note that this value is only an estimation, and manual
  interpretation is still necessary to assign final identification levels. The estimation is done through a set of
  rules, see the <code>Identification level rules</code> section below.</p></li>
</ul><p>Note that only columns are present is sufficient data is available for their calculation.</p>
    </div>
    <div id="identification-level-rules">
    <h2>Identification level rules</h2>
    <p>The estimation of identification levels is configured through a YAML file which
  specifies the rules for each level. The default file is shown below.</p>
<p></p><div class="sourceCode"><pre><code>1:
    suspectFragments: 3
    retention: 12
2a:
    or:
        - individualMoNAScore:
            min: 0.9
            higherThanNext: .inf
        - libMatch:
            min: 0.9
            higherThanNext: .inf
    rank:
        max: 1
        type: compound
3a:
    or:
        - individualMoNAScore: 0.4
        - libMatch: 0.4
3b:
    suspectFragments: 3
3c:
    annMSMSSim:
        type: compound
        min: 0.7
4a:
    annMSMSSim:
        type: formula
        min: 0.7
        higherThanNext: 0.2
    isoScore:
        min: 0.5
        higherThanNext: 0.2
    rank:
        max: 1
        type: formula
4b:
    isoScore:
        min: 0.9
        higherThanNext: 0.2
    rank:
        max: 1
        type: formula
5:
    all: yes
</code></pre></div>

<p>Most of the file should be self-explanatory. Some notes:</p>
<p></p><ul><li><p>Each rule is either a field of <code>suspectFragments</code> (minimum number of MS/MS fragments matched from
  suspect list), <code>retention</code> (maximum retention deviation from suspect list), <code>rank</code> (the maximum
  annotation rank from formula or compound annotations), <code>all</code> (this level is always matched) or any of the
  scorings available from the formula or compound annotations.</p></li>
<li><p>In case any of the rules could be applied to either formula or compound annotations, the annotation type must
  be specified with the <code>type</code> field (<code>formula</code> or <code>compound</code>).</p></li>
<li><p>Identification levels should start with a number and may optionally be followed by a alphabetic character.
  The lowest levels are checked first.</p></li>
<li><p>If <code>relative=yes</code> then the relative scoring will be used for testing.</p></li>
<li><p>For <code>suspectFragments</code>: if the number of fragments from the suspect list (<code>maxFrags</code> column) is
  less then the minimum rule value, the minimum is adjusted to the number of available fragments.</p></li>
</ul><p>A template rules file can be generated with the <code><a href="suspect-screening.html">genIDLevelRulesFile</a></code> function, and this file can
  subsequently passed to <code>annotateSuspects</code>. The file format is highly flexible and (sub)levels can be added or
  removed if desired. Note that the default file is currently only suitable when annotation is performed with GenForm
  and MetFrag, for other algorithms it is crucial to modify the rules.</p>
    </div>
    <div id="s-class-hierarchy">
    <h2>S4 class hierarchy</h2>
    <p></p><ul><li><p><code><a href="featureGroups-class.html">featureGroups</a></code></p><ul><li><p><strong><code>featureGroupsScreening</code></strong></p><ul><li><p><code>featureGroupsSetScreeningUnset</code></p></li>
</ul></li>
</ul></li>
</ul></div>
    <div id="source">
    <h2>Source</h2>
    <p>Cosine spectral similarity calculation was based on the code from <code>SpectrumSimilarity()</code>
  function of <span class="pkg">OrgMassSpecR</span>.</p>
    </div>
    <div id="sets-workflows">
    <h2>Sets workflows</h2>
    <p>The <code>featureGroupsScreeningSet</code> class is applicable for <a href="sets-workflow.html">sets workflows</a>. This class is derived from <code>featureGroupsScreening</code> and therefore largely follows the same user interface.</p>
<p>The following methods are specifically defined for sets workflows:</p><ul><li><p><code>unset</code> Converts the object data for a specified set into a 'non-set' object (<code>featureGroupsScreeningUnset</code>), which allows it to be used in 'regular' workflows. Only the screening results present in the specified set are kept.</p></li>
</ul><p>The following methods are changed or with new functionality:</p><ul><li><p><code>annotateSuspects</code> Suspect annotation is performed per set. Thus, formula/compound ranks, estimated
  identification levels etc are calculated for each set. Subsequently, these results are merged in the final
  <code>screenInfo</code>. In addition, an overall <code>formRank</code> and <code>compRank</code> column is created based on the
  rankings of the suspect candidate in the set consensus data. Furthermore, an overall <code>estIDLevel</code> is generated
  that is based on the 'best' estimated identification level among the sets data (<em>i.e.</em> the lowest). In case
  there is a tie between sub-levels (<em>e.g.</em> <samp>3a</samp> and <samp>3b</samp>), then the sub-level is stripped
  (<em>e.g.</em> <samp>3</samp>).</p></li>
<li><p><code>filter</code> All filters releated to estimated identification levels and formula/compound rankings  are
  applied to the overall set data (see above). All others are applied to set specific data: in this case candidates
  are only removed if none of the set data confirms to the filter.</p></li>
</ul><p>This class derives also from <code><a href="featureGroups-class.html">featureGroupsSet</a></code>. Please see its documentation for more relevant details
  with sets workflows.</p>
<p>Note that the <code>formRank</code> and <code>compRank</code> columns are <em>not</em> updated when the data is subset.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Schymanski EL, Jeon J, Gulde R, Fenner K, Ruff M, Singer HP, Hollender J (2014).
“Identifying Small Molecules via High Resolution Mass Spectrometry: Communicating Confidence.”
<em>Environmental Science and Technology</em>, <b>48</b>(4), 2097--2098.
<a href="https://doi.org/10.1021/es5002105" class="external-link">doi:10.1021/es5002105</a>
.
 <br><br> Stein SE, Scott DR (1994).
“Optimization and testing of mass spectral library search algorithms for compound identification.”
<em>Journal of the American Society for Mass Spectrometry</em>, <b>5</b>(9), 859--866.
<a href="https://doi.org/10.1016/1044-0305%2894%2987009-8" class="external-link">doi:10.1016/1044-0305(94)87009-8</a>
.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="featureGroups-class.html">featureGroups</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Rick Helmus &lt;<a href="mailto:r.helmus@uva.nl">r.helmus@uva.nl</a>&gt;, Emma Schymanski &lt;<a href="mailto:emma.schymanski@uni.lu">emma.schymanski@uni.lu</a>&gt; (contributions to
  identification level rules), Bas van de Velde (contributions to spectral similarity calculation).</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Rick Helmus.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

      </footer></div>

  


  

  </body></html>

