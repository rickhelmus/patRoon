<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Find features using OpenMS — findFeaturesOpenMS • patRoon</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Find features using OpenMS — findFeaturesOpenMS"><meta property="og:description" content="uses the
FeatureFinderMetabo
TOPP tool (see http://www.openms.de) to find features."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">patRoon</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>

  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Reference

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../reference/index.html">Online</a>
    </li>
    <li>
      <a href="../reference/patRoon.pdf">PDF</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorial

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/tutorial.html">Online HTML page</a>
    </li>
    <li>
      <a href="../articles/tutorial.pdf">PDF</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Handbook

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../handbook_bd/index.html">Book format</a>
    </li>
    <li>
      <a href="../handbook_bd/handbook.pdf">PDF</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/rickhelmus/patRoon" class="external-link">
    <span class="fa fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Find features using OpenMS</h1>
    <small class="dont-index">Source: <a href="https://github.com/rickhelmus/patRoon/blob/HEAD/R/features-openms.R" class="external-link"><code>R/features-openms.R</code></a></small>
    <div class="hidden name"><code>findFeaturesOpenMS.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>uses the
<a href="https://abibuilder.cs.uni-tuebingen.de/archive/openms/Documentation/nightly/html/TOPP_FeatureFinderMetabo.html" class="external-link">FeatureFinderMetabo</a>
TOPP tool (see <a href="http://www.openms.de" class="external-link">http://www.openms.de</a>) to find features.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">findFeaturesOpenMS</span><span class="op">(</span></span>
<span>  <span class="va">analysisInfo</span>,</span>
<span>  noiseThrInt <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  chromSNR <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  chromFWHM <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  mzPPM <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  reEstimateMTSD <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  traceTermCriterion <span class="op">=</span> <span class="st">"sample_rate"</span>,</span>
<span>  traceTermOutliers <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  minSampleRate <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  minTraceLength <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  maxTraceLength <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>  widthFiltering <span class="op">=</span> <span class="st">"fixed"</span>,</span>
<span>  minFWHM <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  maxFWHM <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  traceSNRFiltering <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  localRTRange <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  localMZRange <span class="op">=</span> <span class="fl">6.5</span>,</span>
<span>  isotopeFilteringModel <span class="op">=</span> <span class="st">"metabolites (5% RMS)"</span>,</span>
<span>  MZScoring13C <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  useSmoothedInts <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  extraOpts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  intSearchRTWindow <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  useFFMIntensities <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-analysisinfo">analysisInfo<a class="anchor" aria-label="anchor" href="#arg-analysisinfo"></a></dt>
<dd><p>A <code>data.frame</code> with <a href="analysis-information.html">Analysis information</a>.</p></dd>


<dt id="arg-noisethrint">noiseThrInt<a class="anchor" aria-label="anchor" href="#arg-noisethrint"></a></dt>
<dd><p>Noise intensity threshold. Sets <code>algorithm:common:noise_threshold_int</code> option.</p></dd>


<dt id="arg-chromsnr">chromSNR<a class="anchor" aria-label="anchor" href="#arg-chromsnr"></a></dt>
<dd><p>Minimum S/N of a mass trace. Sets <code>algorithm:common:chrom_peak_snr</code> option.</p></dd>


<dt id="arg-chromfwhm">chromFWHM<a class="anchor" aria-label="anchor" href="#arg-chromfwhm"></a></dt>
<dd><p>Expected chromatographic peak width (in seconds). Sets <code>algorithm:common:chrom_fwhm</code> option.</p></dd>


<dt id="arg-mzppm">mzPPM<a class="anchor" aria-label="anchor" href="#arg-mzppm"></a></dt>
<dd><p>Allowed mass deviation (ppm) for trace detection. Sets <code>algorithm:mtd:mass_error_ppm</code>.</p></dd>


<dt id="arg-reestimatemtsd">reEstimateMTSD<a class="anchor" aria-label="anchor" href="#arg-reestimatemtsd"></a></dt>
<dd><p>If <code>TRUE</code> then enables dynamic re-estimation of m/z variance during mass trace collection
stage. Sets <code>algorithm:mtd:reestimate_mt_sd</code>.</p></dd>


<dt id="arg-tracetermcriterion-tracetermoutliers-minsamplerate">traceTermCriterion, traceTermOutliers, minSampleRate<a class="anchor" aria-label="anchor" href="#arg-tracetermcriterion-tracetermoutliers-minsamplerate"></a></dt>
<dd><p>Termination criterion for the extension of mass traces. See
<a href="https://abibuilder.cs.uni-tuebingen.de/archive/openms/Documentation/nightly/html/TOPP_FeatureFinderMetabo.html" class="external-link">FeatureFinderMetabo</a>.
 Sets the <code>algorithm:mtd:trace_termination_criterion</code>, <code>algorithm:mtd:trace_termination_outliers</code> and
<code>algorithm:mtd:min_sample_rate</code> options, respectively.</p></dd>


<dt id="arg-mintracelength-maxtracelength">minTraceLength, maxTraceLength<a class="anchor" aria-label="anchor" href="#arg-mintracelength-maxtracelength"></a></dt>
<dd><p>Minimum/Maximum length of mass trace (seconds). Set negative value for maxlength
to disable maximum. Sets <code>algorithm:mtd:min_trace_length</code> and <code>algorithm:mtd:min_trace_length</code>,
respectively.</p></dd>


<dt id="arg-widthfiltering-minfwhm-maxfwhm">widthFiltering, minFWHM, maxFWHM<a class="anchor" aria-label="anchor" href="#arg-widthfiltering-minfwhm-maxfwhm"></a></dt>
<dd><p>Enable filtering of unlikely peak widths. See
<a href="https://abibuilder.cs.uni-tuebingen.de/archive/openms/Documentation/nightly/html/TOPP_FeatureFinderMetabo.html" class="external-link">FeatureFinderMetabo</a>.
 Sets <code>algorithm:epd:width_filtering</code>, <code>algorithm:epd:min_fwhm</code> and <code>algorithm:epd:max_fwhm</code>,
respectively.</p></dd>


<dt id="arg-tracesnrfiltering">traceSNRFiltering<a class="anchor" aria-label="anchor" href="#arg-tracesnrfiltering"></a></dt>
<dd><p>If <code>TRUE</code> then apply post-filtering by signal-to-noise ratio after smoothing. Sets the
<code>algorithm:epd:masstrace_snr_filtering</code> option.</p></dd>


<dt id="arg-localrtrange-localmzrange">localRTRange, localMZRange<a class="anchor" aria-label="anchor" href="#arg-localrtrange-localmzrange"></a></dt>
<dd><p>Retention/MZ range where to look for coeluting/isotopic mass traces. Sets the
<code>algorithm:ffm:local_rt_range</code> and <code>algorithm:ffm:local_mz_range</code> options, respectively.</p></dd>


<dt id="arg-isotopefilteringmodel">isotopeFilteringModel<a class="anchor" aria-label="anchor" href="#arg-isotopefilteringmodel"></a></dt>
<dd><p>Remove/score candidate assemblies based on isotope intensities. See
<a href="https://abibuilder.cs.uni-tuebingen.de/archive/openms/Documentation/nightly/html/TOPP_FeatureFinderMetabo.html" class="external-link">FeatureFinderMetabo</a>.
 Sets the <code>algorithm:ffm:isotope_filtering_model</code> option.</p></dd>


<dt id="arg-mzscoring-c">MZScoring13C<a class="anchor" aria-label="anchor" href="#arg-mzscoring-c"></a></dt>
<dd><p>Use the 13C isotope as the expected shift for isotope mass traces. See
<a href="https://abibuilder.cs.uni-tuebingen.de/archive/openms/Documentation/nightly/html/TOPP_FeatureFinderMetabo.html" class="external-link">FeatureFinderMetabo</a>.
 Sets <code>algorithm:ffm:mz_scoring_13C</code>.</p></dd>


<dt id="arg-usesmoothedints">useSmoothedInts<a class="anchor" aria-label="anchor" href="#arg-usesmoothedints"></a></dt>
<dd><p>If <code>TRUE</code> then use LOWESS intensities instead of raw intensities. Sets the
<code>algorithm:ffm:use_smoothed_intensities</code> option.</p></dd>


<dt id="arg-extraopts">extraOpts<a class="anchor" aria-label="anchor" href="#arg-extraopts"></a></dt>
<dd><p>Named <code>list</code> containing extra options that will be passed to <code class="command">FeatureFinderMetabo</code>. Any
options specified here will override any of the above. Example:
<code>extraOpts=list("-algorithm:common:noise_threshold_int"=1000)</code> (corresponds to setting
<code>noiseThrInt=1000</code>). Set to <code>NULL</code> to ignore.</p></dd>


<dt id="arg-intsearchrtwindow">intSearchRTWindow<a class="anchor" aria-label="anchor" href="#arg-intsearchrtwindow"></a></dt>
<dd><p>Retention time window (in seconds, +/- feature retention time) that is used to find the
closest data point to the retention time to obtain the intensity of a feature (this is needed since OpenMS does not
provide this data).</p></dd>


<dt id="arg-useffmintensities">useFFMIntensities<a class="anchor" aria-label="anchor" href="#arg-useffmintensities"></a></dt>
<dd><p>If <code>TRUE</code> then peak intensities are directly loaded from <code class="command">FeatureFinderMetabo</code>
output. Otherwise, intensities are loaded afterwards from the input <code class="file">mzML</code> files, which is potentially much
slower, especially with many analyses files. However, <code>useFFMIntensities=TRUE</code> is still somewhat experimental,
may be less accurate and requires a recent version of <code class="command">OpenMS</code> (&gt;=2.7).</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>If set to <code>FALSE</code> then no text output is shown.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>An object of a class which is derived from <code><a href="features-class.html">features</a></code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function uses OpenMS to automatically find features. This function is called when calling <code>findFeatures</code> with
  <code>algorithm="openms"</code>.</p>
<p>This functionality has been tested with OpenMS version &gt;= 2.0. Please make sure it is installed and
  configured, e.g. by installing <code>patRoonExt</code> or configuring the path of the binaries with
  the <code>patRoon.path.OpenMS</code> option or the system <span class="option">PATH</span> variable.</p>
<p>The file format of analyses must be <code class="file">mzML</code>.</p>
<p>The input MS data files need to be centroided. The <code><a href="convertMSFiles.html">convertMSFiles</a></code> function can be used to
  centroid data.</p>
    </div>
    <div id="parallelization">
    <h2>Parallelization</h2>
    <p><code>findFeaturesOpenMS</code> uses multiprocessing to parallelize
  computations. Please see the parallelization section in the handbook for
  more details and <a href="patRoon-package.html">patRoon options</a> for configuration
  options.</p>
<p>Note that for caching purposes, the analyses files must always exist on the local host
  computer, even if it is not participating in computations.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Rost HL, Sachsenberg T, Aiche S, Bielow C, Weisser H, Aicheler F, Andreotti S, Ehrlich H, Gutenbrunner P, Kenar E, Liang X, Nahnsen S, Nilse L, Pfeuffer J, Rosenberger G, Rurik M, Schmitt U, Veit J, Walzer M, Wojnar D, Wolski WE, Schilling O, Choudhary JS, Malmstrom L, Aebersold R, Reinert K, Kohlbacher O (2016).
“OpenMS: a flexible open-source software platform for mass spectrometry data analysis.”
<em>Nature Methods</em>, <b>13</b>(9), 741–748.
<a href="https://doi.org/10.1038/nmeth.3959" class="external-link">doi:10.1038/nmeth.3959</a>
.
 <br><br><a href="https://pugixml.org/" class="external-link">pugixml</a> (via <a href="http://www.rcpp.org/" class="external-link">Rcpp</a>) is used to process OpenMS XML output. <br><br>
  Eddelbuettel D (2013).
<em>Seamless R and C++ Integration with Rcpp</em>.
Springer, New York.
<a href="https://doi.org/10.1007/978-1-4614-6868-4" class="external-link">doi:10.1007/978-1-4614-6868-4</a>
, ISBN 978-1-4614-6867-7.<br><br>
Eddelbuettel D, Balamuta J (2018).
“Extending R with C++: A Brief Introduction to Rcpp.”
<em>The American Statistician</em>, <b>72</b>(1), 28-36.
<a href="https://doi.org/10.1080/00031305.2017.1375990" class="external-link">doi:10.1080/00031305.2017.1375990</a>
.<br><br>
Eddelbuettel D, François R (2011).
“Rcpp: Seamless R and C++ Integration.”
<em>Journal of Statistical Software</em>, <b>40</b>(8), 1–18.
<a href="https://doi.org/10.18637/jss.v040.i08" class="external-link">doi:10.18637/jss.v040.i08</a>
.<br><br>
Eddelbuettel D, Francois R, Allaire J, Ushey K, Kou Q, Russell N, Ucar I, Bates D, Chambers J (2025).
<em>Rcpp: Seamless R and C++ Integration</em>.
R package version 1.1.0, <a href="https://www.rcpp.org" class="external-link">https://www.rcpp.org</a>.
1</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="findFeatures.html">findFeatures</a></code> for more details and other algorithms.</p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Rick Helmus.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

