<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Formula annotations class — formulas-class • patRoon</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Formula annotations class — formulas-class"><meta property="og:description" content="Contains data of generated chemical formulae for given feature groups."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">patRoon</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>

  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Reference

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../reference/index.html">Online</a>
    </li>
    <li>
      <a href="../reference/patRoon.pdf">PDF</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorial

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/tutorial.html">Online HTML page</a>
    </li>
    <li>
      <a href="../articles/tutorial.pdf">PDF</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Handbook

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../handbook_bd/index.html">Book format</a>
    </li>
    <li>
      <a href="../handbook_bd/handbook.pdf">PDF</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/rickhelmus/patRoon" class="external-link">
    <span class="fa fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Formula annotations class</h1>
    <small class="dont-index">Source: <a href="https://github.com/rickhelmus/patRoon/blob/HEAD/R/formulas.R" class="external-link"><code>R/formulas.R</code></a>, <a href="https://github.com/rickhelmus/patRoon/blob/HEAD/R/formulas-set.R" class="external-link"><code>R/formulas-set.R</code></a>, <a href="https://github.com/rickhelmus/patRoon/blob/HEAD/R/formulas-sirius.R" class="external-link"><code>R/formulas-sirius.R</code></a></small>
    <div class="hidden name"><code>formulas-class.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Contains data of generated chemical formulae for given feature groups.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S4 method for class 'formulas'</span></span>
<span><span class="fu"><a href="generics.html">annotations</a></span><span class="op">(</span><span class="va">obj</span>, features <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'formulas'</span></span>
<span><span class="fu"><a href="generics.html">analyses</a></span><span class="op">(</span><span class="va">obj</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'formulas'</span></span>
<span><span class="fu"><a href="generics.html">defaultExclNormScores</a></span><span class="op">(</span><span class="va">obj</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'formulas'</span></span>
<span><span class="fu"><a href="generics.html">show</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'formulas,ANY,ANY'</span></span>
<span><span class="va">x</span><span class="op">[[</span><span class="va">i</span>, <span class="va">j</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># S4 method for class 'formulas'</span></span>
<span><span class="fu"><a href="generics.html">delete</a></span><span class="op">(</span><span class="va">obj</span>, i <span class="op">=</span> <span class="cn">NULL</span>, j <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'formulas'</span></span>
<span><span class="fu"><a href="generics.html">as.data.table</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  fGroups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fragments <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  countElements <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  countFragElements <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  OM <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  normalizeScores <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  excludeNormScores <span class="op">=</span> <span class="fu"><a href="generics.html">defaultExclNormScores</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  average <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'formulas'</span></span>
<span><span class="fu"><a href="generics.html">annotatedPeakList</a></span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  <span class="va">index</span>,</span>
<span>  <span class="va">groupName</span>,</span>
<span>  analysis <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">MSPeakLists</span>,</span>
<span>  onlyAnnotated <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'formulas'</span></span>
<span><span class="fu"><a href="generics.html">plotSpectrum</a></span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  <span class="va">index</span>,</span>
<span>  <span class="va">groupName</span>,</span>
<span>  analysis <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">MSPeakLists</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  specSimParams <span class="op">=</span> <span class="fu"><a href="specSimParams.html">getDefSpecSimParams</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  mincex <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  xlim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ylim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'formulas'</span></span>
<span><span class="fu"><a href="generics.html">plotScores</a></span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  <span class="va">index</span>,</span>
<span>  <span class="va">groupName</span>,</span>
<span>  analysis <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  normalizeScores <span class="op">=</span> <span class="st">"max"</span>,</span>
<span>  excludeNormScores <span class="op">=</span> <span class="fu"><a href="generics.html">defaultExclNormScores</a></span><span class="op">(</span><span class="va">obj</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'formulas'</span></span>
<span><span class="fu"><a href="generics.html">consensus</a></span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  absMinAbundance <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  relMinAbundance <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  uniqueFrom <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  uniqueOuter <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  rankWeights <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  labels <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'formulasSet'</span></span>
<span><span class="fu"><a href="generics.html">show</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'formulasSet'</span></span>
<span><span class="fu"><a href="generics.html">delete</a></span><span class="op">(</span><span class="va">obj</span>, <span class="va">i</span>, <span class="va">j</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'formulasSet,ANY,missing,missing'</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span>, <span class="va">...</span>, sets <span class="op">=</span> <span class="cn">NULL</span>, updateConsensus <span class="op">=</span> <span class="cn">FALSE</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># S4 method for class 'formulasSet'</span></span>
<span><span class="fu"><a href="generics.html">filter</a></span><span class="op">(</span><span class="va">obj</span>, <span class="va">...</span>, sets <span class="op">=</span> <span class="cn">NULL</span>, updateConsensus <span class="op">=</span> <span class="cn">FALSE</span>, negate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'formulasSet'</span></span>
<span><span class="fu"><a href="generics.html">plotSpectrum</a></span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  <span class="va">index</span>,</span>
<span>  <span class="va">groupName</span>,</span>
<span>  analysis <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">MSPeakLists</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  specSimParams <span class="op">=</span> <span class="fu"><a href="specSimParams.html">getDefSpecSimParams</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  mincex <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  xlim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ylim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  perSet <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  mirror <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'formulasSet'</span></span>
<span><span class="fu"><a href="generics.html">annotatedPeakList</a></span><span class="op">(</span><span class="va">obj</span>, <span class="va">index</span>, <span class="va">groupName</span>, analysis <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">MSPeakLists</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'formulasSet'</span></span>
<span><span class="fu"><a href="generics.html">consensus</a></span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  absMinAbundance <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  relMinAbundance <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  uniqueFrom <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  uniqueOuter <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  rankWeights <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  filterSets <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  setThreshold <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  setThresholdAnn <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  setAvgSpecificScores <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'formulasSet'</span></span>
<span><span class="fu"><a href="generics.html">unset</a></span><span class="op">(</span><span class="va">obj</span>, <span class="va">set</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'formulasConsensusSet'</span></span>
<span><span class="fu"><a href="generics.html">unset</a></span><span class="op">(</span><span class="va">obj</span>, <span class="va">set</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'formulasSIRIUS'</span></span>
<span><span class="fu"><a href="generics.html">delete</a></span><span class="op">(</span><span class="va">obj</span>, i <span class="op">=</span> <span class="cn">NULL</span>, j <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-obj-x-object">obj, x, object<a class="anchor" aria-label="anchor" href="#arg-obj-x-object"></a></dt>
<dd><p>The <code>formulas</code> object.</p></dd>


<dt id="arg-features">features<a class="anchor" aria-label="anchor" href="#arg-features"></a></dt>
<dd><p>If <code>TRUE</code> returns formula data for features, otherwise
for feature groups.</p></dd>


<dt id="arg-i-j">i, j<a class="anchor" aria-label="anchor" href="#arg-i-j"></a></dt>
<dd><p>For <code>[[</code>: If both <code>i</code> and <code>j</code> are specified then <code>i</code> specifies the analysis and
  <code>j</code> the feature group of the feature for which annotations should be returned. Otherwise <code>i</code> specifies
  the feature group for which group annotations should be returned. <code>i</code>/<code>j</code> can be specified as
  <code>integer</code> index or as a <code>character</code> name.</p>
<p>Otherwise passed to the <code><a href="featureAnnotations-class.html">featureAnnotations</a></code> method.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>For <code>plotSpectrum</code>: Further arguments passed to <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></code>.</p>
<p>For <code>delete</code>: passed to the function specified as <code>j</code>.</p>
<p>For <code>consensus</code>: Any further (and unique) <code>formulas</code> objects.</p>
<p>For <a href="sets-workflow.html">sets workflow</a> methods: further arguments passed to the base <code>formulas</code> method.</p></dd>


<dt id="arg-fgroups-fragments-countelements-countfragelements-om">fGroups, fragments, countElements, countFragElements, OM<a class="anchor" aria-label="anchor" href="#arg-fgroups-fragments-countelements-countfragelements-om"></a></dt>
<dd><p>Passed to the
<code><a href="featureAnnotations-class.html">featureAnnotations</a></code> method.</p></dd>


<dt id="arg-normalizescores">normalizeScores<a class="anchor" aria-label="anchor" href="#arg-normalizescores"></a></dt>
<dd><p>A <code>character</code> that specifies how normalization of
annotation scorings occurs. Either
<code>"none"</code> (no normalization),
<code>"max"</code> (normalize to max value) or <code>"minmax"</code> (perform min-max
normalization). Note that normalization of negative scores (e.g. output by
<code class="command">SIRIUS</code>) is always performed as min-max. Furthermore, currently
normalization for <code>compounds</code> takes the original min/max scoring
values into account when candidates were generated. Thus, for
<code>compounds</code> scoring, normalization is not affected when candidate
results were removed after they were generated (<em>e.g.</em> by use of
<code>filter</code>).</p></dd>


<dt id="arg-excludenormscores">excludeNormScores<a class="anchor" aria-label="anchor" href="#arg-excludenormscores"></a></dt>
<dd><p>A
  <code>character</code> vector specifying any compound scoring names that
  should <em>not</em> be normalized. Set to <code>NULL</code> to normalize all
  scorings. Note that whether any normalization occurs is set by the
  <code>excludeNormScores</code> argument.</p>
<p>For <code>compounds</code>: By default <code>score</code> and
  <code>individualMoNAScore</code> are set to mimic the behavior of the
  <code class="command">MetFrag</code> web interface.</p></dd>


<dt id="arg-average">average<a class="anchor" aria-label="anchor" href="#arg-average"></a></dt>
<dd><p>If set to <code>TRUE</code> an 'average formula' is generated for each feature group by combining all
elements from all candidates and averaging their amounts. This obviously leads to non-existing formulae, however,
this data may be useful to deal with multiple candidate formulae per feature group when performing elemental
characterization. Setting this to <code>TRUE</code> disables reporting of most other data.</p></dd>


<dt id="arg-index">index<a class="anchor" aria-label="anchor" href="#arg-index"></a></dt>
<dd><p>The candidate index (row). For <code>plotSpectrum</code> two indices can be specified to compare spectra. In
this case <code>groupName</code> and <code>analysis</code> (if not <code>NULL</code>) should specify values for the spectra to
compare.</p></dd>


<dt id="arg-groupname">groupName<a class="anchor" aria-label="anchor" href="#arg-groupname"></a></dt>
<dd><p>The name of the feature group (or feature groups when comparing spectra) to which the candidate
belongs.</p></dd>


<dt id="arg-analysis">analysis<a class="anchor" aria-label="anchor" href="#arg-analysis"></a></dt>
<dd><p>A <code>character</code> specifying the analysis (or analyses when comparing spectra) for which the
annotated spectrum should be plotted. If <code>NULL</code> then annotation results for the complete feature group will be
plotted.</p></dd>


<dt id="arg-mspeaklists">MSPeakLists<a class="anchor" aria-label="anchor" href="#arg-mspeaklists"></a></dt>
<dd><p>The <code><a href="MSPeakLists-class.html">MSPeakLists</a></code> object that was used to generate the candidate</p></dd>


<dt id="arg-onlyannotated">onlyAnnotated<a class="anchor" aria-label="anchor" href="#arg-onlyannotated"></a></dt>
<dd><p>Set to <code>TRUE</code> to filter out any peaks that could
not be annotated.</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>The title of the plot. Set to <code>NULL</code> for an automatically generated title.</p></dd>


<dt id="arg-specsimparams">specSimParams<a class="anchor" aria-label="anchor" href="#arg-specsimparams"></a></dt>
<dd><p>A named <code>list</code> with parameters that influence the calculation of MS spectra similarities.
See the <a href="specSimParams.html">spectral similarity parameters</a> documentation for more details.</p></dd>


<dt id="arg-mincex">mincex<a class="anchor" aria-label="anchor" href="#arg-mincex"></a></dt>
<dd><p>The formula annotation labels are automatically scaled. The <code>mincex</code> argument forces a minimum
<code>cex</code> value for readability.</p></dd>


<dt id="arg-xlim-ylim">xlim, ylim<a class="anchor" aria-label="anchor" href="#arg-xlim-ylim"></a></dt>
<dd><p>Sets the plot size limits used by
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></code>. Set to <code>NULL</code> for automatic plot sizing.</p></dd>


<dt id="arg-absminabundance-relminabundance">absMinAbundance, relMinAbundance<a class="anchor" aria-label="anchor" href="#arg-absminabundance-relminabundance"></a></dt>
<dd><p>Minimum absolute or relative
(<samp>0-1</samp>) abundance across objects for a result to be kept. For
instance, <code>relMinAbundance=0.5</code> means that a result should be present
in at least half of the number of compared objects. Set to <samp>NULL</samp> to
ignore and keep all results. Limits cannot be set when <code>uniqueFrom</code> is
not <code>NULL</code>.</p></dd>


<dt id="arg-uniquefrom">uniqueFrom<a class="anchor" aria-label="anchor" href="#arg-uniquefrom"></a></dt>
<dd><p>Set this argument to only retain formulas that are unique
within one or more of the objects for which the consensus is made.
Selection is done by setting the value of <code>uniqueFrom</code> to a
<code>logical</code> (values are recycled), <code>numeric</code> (select by index) or a
<code>character</code> (as obtained with <code>algorithm(obj)</code>). For
<code>logical</code> and <code>numeric</code> values the order corresponds to the order
of the objects given for the consensus. Set to <code>NULL</code> to ignore.</p></dd>


<dt id="arg-uniqueouter">uniqueOuter<a class="anchor" aria-label="anchor" href="#arg-uniqueouter"></a></dt>
<dd><p>If <code>uniqueFrom</code> is not <code>NULL</code> and if
<code>uniqueOuter=TRUE</code>: only retain data that are also unique between
objects specified in <code>uniqueFrom</code>.</p></dd>


<dt id="arg-rankweights">rankWeights<a class="anchor" aria-label="anchor" href="#arg-rankweights"></a></dt>
<dd><p>A numeric vector with weights of to calculate the mean
ranking score for each candidate. The value will be re-cycled if necessary,
hence, the default value of <samp>1</samp> means equal weights for all considered
objects.</p></dd>


<dt id="arg-labels">labels<a class="anchor" aria-label="anchor" href="#arg-labels"></a></dt>
<dd><p>A <code>character</code> with names to use for labelling. If <code>NULL</code> labels are automatically generated.</p></dd>


<dt id="arg-sets">sets<a class="anchor" aria-label="anchor" href="#arg-sets"></a></dt>
<dd><p>(<strong>sets workflow</strong>) A <code>character</code> with name(s) of the sets to keep (or remove if <code>negate=TRUE</code>). Note: if
<code>updateConsensus=FALSE</code> then the <code>setCoverage</code> column of the annotation results is not updated.</p></dd>


<dt id="arg-updateconsensus">updateConsensus<a class="anchor" aria-label="anchor" href="#arg-updateconsensus"></a></dt>
<dd><p>(<strong>sets workflow</strong>) If <code>TRUE</code> then the annonation consensus among set results is updated. See the
<code>Sets workflows</code> section for more details.</p></dd>


<dt id="arg-drop">drop<a class="anchor" aria-label="anchor" href="#arg-drop"></a></dt>
<dd><p>Passed to the <code><a href="featureAnnotations-class.html">featureAnnotations</a></code> method.</p></dd>


<dt id="arg-negate">negate<a class="anchor" aria-label="anchor" href="#arg-negate"></a></dt>
<dd><p>Passed to the <code><a href="featureAnnotations-class.html">featureAnnotations</a></code> method.</p></dd>


<dt id="arg-perset-mirror">perSet, mirror<a class="anchor" aria-label="anchor" href="#arg-perset-mirror"></a></dt>
<dd><p>(<strong>sets workflow</strong>) If <code>perSet=TRUE</code> then the set specific mass peaks are annotated separately.
Furthermore, if <code>mirror=TRUE</code> (and there are two sets in the object) then a mirror plot is generated.</p></dd>


<dt id="arg-filtersets">filterSets<a class="anchor" aria-label="anchor" href="#arg-filtersets"></a></dt>
<dd><p>(<strong>sets workflow</strong>) Controls how algorithms concensus abundance filters are applied. See the <code>Sets
workflows</code> section below.</p></dd>


<dt id="arg-setthreshold-setthresholdann">setThreshold, setThresholdAnn<a class="anchor" aria-label="anchor" href="#arg-setthreshold-setthresholdann"></a></dt>
<dd><p>(<strong>sets workflow</strong>) Thresholds used to create the annotation set consensus. See
<code><a href="generateFormulas.html">generateFormulas</a></code>.</p></dd>


<dt id="arg-setavgspecificscores">setAvgSpecificScores<a class="anchor" aria-label="anchor" href="#arg-setavgspecificscores"></a></dt>
<dd><p>(<strong>sets workflow</strong>) If <code>TRUE</code> then set specific annotation scores (<em>e.g.</em> MS/MS and
isotopic pattern match scores) are averaged for the set consensus. See <code><a href="generateFormulas.html">generateFormulas</a></code>.</p></dd>


<dt id="arg-set">set<a class="anchor" aria-label="anchor" href="#arg-set"></a></dt>
<dd><p>(<strong>sets workflow</strong>) The name of the set.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code>annotations</code> returns a <code>list</code> containing for each feature
  group (or feature if <code>features=TRUE</code>) a <code>data.table</code>
  with an overview of all generated formulae and other data such as candidate
  scoring and MS/MS fragments.</p>
<p><code>consensus</code> returns a <code>formulas</code> object that is produced by
  merging results from multiple <code>formulas</code> objects.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><code>formulas</code> objects are obtained with <code><a href="generateFormulas.html">generateFormulas</a></code>. This class is derived from the
<code><a href="featureAnnotations-class.html">featureAnnotations</a></code> class, please see its documentation for more methods and other details.</p>
    </div>
    <div id="methods-by-generic-">
    <h2>Methods (by generic)</h2>

<ul><li><p><code>annotations(formulas)</code>: Accessor method to obtain generated formulae.</p></li>
<li><p><code>analyses(formulas)</code>: returns a <code>character</code> vector with the names of the
analyses for which data is present in this object.</p></li>
<li><p><code>defaultExclNormScores(formulas)</code>: Returns default scorings that are excluded from normalization.</p></li>
<li><p><code>show(formulas)</code>: Show summary information for this object.</p></li>
<li><p><code>x[[i</code>: Extracts a formula table, either for a feature group or for features in an analysis.</p></li>
<li><p><code>as.data.table(formulas)</code>: Generates a table with all candidate formulae for each feature group and other information such
as element counts.</p></li>
<li><p><code>annotatedPeakList(formulas)</code>: Returns an MS/MS peak list annotated with data from a
given candidate formula.</p></li>
<li><p><code>plotSpectrum(formulas)</code>: Plots an annotated spectrum for a given candidate formula of a feature or feature group. Two
spectra can be compared by specifying a two-sized vector for the <code>index</code>, <code>groupName</code> and (if desired)
<code>analysis</code> arguments.</p></li>
<li><p><code>plotScores(formulas)</code>: Plots a barplot with scoring of a candidate formula.</p></li>
<li><p><code>consensus(formulas)</code>: Generates a consensus of results from multiple
objects. In order to rank the consensus candidates, first
each of the candidates are scored based on their original ranking
(the scores are normalized and the highest ranked candidate gets value
<samp>1</samp>). The (weighted) mean is then calculated for all scorings of each
candidate to derive the final ranking (if an object lacks the candidate its
score will be <samp>0</samp>). The original rankings for each object is stored in
the <code>rank</code> columns.</p></li>
</ul></div>
    <div id="slots">
    <h2>Slots</h2>


<dl><dt><code>featureFormulas</code></dt>
<dd><p>A <code>list</code> with all generated formulae for each analysis/feature group. Use the
<code>annotations</code> method for access.</p></dd>


<dt><code>setThreshold,setThresholdAnn,setAvgSpecificScores</code></dt>
<dd><p>(<strong>sets workflow</strong>) A copy of the equally named arguments that were
passed when this object was created by <code><a href="generateFormulas.html">generateFormulas</a></code>.</p></dd>


<dt><code>origFGNames</code></dt>
<dd><p>(<strong>sets workflow</strong>) The original (order of) names of the <code><a href="featureGroups-class.html">featureGroups</a></code> object that was used to
create this object.</p></dd>


</dl></div>
    <div id="s-class-hierarchy">
    <h2>S4 class hierarchy</h2>
    <p></p><ul><li><p><code><a href="featureAnnotations-class.html">featureAnnotations</a></code></p><ul><li><p><strong><code>formulas</code></strong></p><ul><li><p><code>formulasConsensus</code></p></li>
<li><p><code>formulasSet</code></p><ul><li><p><code>formulasConsensusSet</code></p></li>
</ul></li>
<li><p><code>formulasUnset</code></p></li>
<li><p><code><a href="formulasSIRIUS-class.html">formulasSIRIUS</a></code></p></li>
</ul></li>
</ul></li>
</ul></div>
    <div id="source">
    <h2>Source</h2>
    <p>Subscripting of formulae for plots generated by
  <code>plotSpectrum</code> is based on the <code>chemistry2expression</code> function
  from the <a href="https://github.com/schymane/ReSOLUTION" class="external-link">ReSOLUTION</a> package.</p>
    </div>
    <div id="sets-workflows">
    <h2>Sets workflows</h2>
    <p>The <code>formulasSet</code> class is applicable for <a href="sets-workflow.html">sets workflows</a>. This class is derived from <code>formulas</code> and therefore largely follows the same user interface.</p>
<p>The following methods are specifically defined for sets workflows:</p><ul><li><p><code>unset</code> Converts the object data for a specified set into a 'non-set' object (<code>formulasUnset</code>), which allows it to be used in 'regular' workflows. Only the annotation results that are present in the specified set are kept
  (based on the set consensus, see below for implications).</p></li>
</ul><p>The following methods are changed or with new functionality:</p><ul><li><p><code>filter</code> and the subset operator (<code>[</code>) Can be used to select data that is only present for selected
  sets. Depending on the <code>updateConsenus</code>, both either operate on set consensus or original data (see below for
  implications).</p></li>
<li><p><code>annotatedPeakList</code> Returns a combined annotation table with all sets.</p></li>
<li><p><code>plotSpectrum</code> Is able to highlight set specific mass peaks (<code>perSet</code> and <code>mirror</code> arguments).</p></li>
<li><p><code>consensus</code> Creates the algorithm consensus based on the original annotation data (see below for
  implications). Then, like the sets workflow method for <code><a href="generateFormulas.html">generateFormulas</a></code>, a consensus is made for all
  sets, which can be controlled with the <code>setThreshold</code> and <code>setThresholdAnn</code> arguments. The candidate
  coverage among the different algorithms is calculated for each set (<em>e.g.</em> <code>coverage-positive</code> column)
  and for all sets (<code>coverage</code> column), which is based on the presence of a candidate in all the algorithms from
  all sets data. The <code>consensus</code> method for sets workflow data supports the <code>filterSets</code> argument. This
  controls how the algorithm consensus abundance filters (<code>absMinAbundance</code>/<code>relMinAbundance</code>) are applied:
  if <code>filterSets=TRUE</code> then the minimum of all <code>coverage</code> set specific columns is used to obtain the
  algorithm abundance. Otherwise the overall <code>coverage</code> column is used. For instance, consider a consensus
  object to be generated from two objects generated by different algorithms (<em>e.g.</em> <code class="command">SIRIUS</code> and
  <code class="command">GenForm</code>), which both have a positive and negative set. Then, if a candidate occurs with both
  algorithms for the positive mode set, but only with the first algorithm in the negative mode set,
  <code>relMinAbundance=1</code> will remove the candidate if <code>filterSets=TRUE</code> (because the minimum relative
  algorithm abundance is <samp>0.5</samp>), while <code>filterSets=FALSE</code> will not remove the candidate (because based on
  all sets data the candidate occurs in both algorithms).</p></li>
</ul><p>Two types of annotation data are stored in a <code>formulasSet</code> object:</p><ol><li><p>Annotations that are produced from a consensus between set results (see <code>generateFormulas</code>).</p></li>
<li><p>The 'original' annotation data per set, prior to when the set consensus was made. This includes candidates
  that were filtered out because of the thresholds set by <code>setThreshold</code> and <code>setThresholdAnn</code>. However,
  when <code>filter</code> or subsetting (<code>[</code>) operations are performed, the original data is also updated.</p></li>
</ol><p>In most cases the first data is used. However, in a few cases the original annotation data is used (as indicated
  above), for instance, to re-create the set consensus. It is important to realize that the original annotation data
  may have <em>additional</em> candidates, and a newly created set consensus may therefore have 'new' candidates. For
  instance, when the object consists of the sets <code>"positive"</code> and <code>"negative"</code> and <code>setThreshold=1</code>
  was used to create it, then <code>formulas[, sets = "positive", updateConsensus = TRUE]</code> may now have additional
  candidates, <em>i.e.</em> those that were not present in the <code>"negative"</code> set and were previously removed due to
  the consensus threshold filter.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>The <code><a href="featureAnnotations-class.html">featureAnnotations</a></code> base class for more relevant methods and
  <code><a href="generateFormulas.html">generateFormulas</a></code>.</p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Rick Helmus.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

