<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Componentization of adducts, isotopes etc. with cliqueMS — generateComponentsCliqueMS • patRoon</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Componentization of adducts, isotopes etc. with cliqueMS — generateComponentsCliqueMS"><meta property="og:description" content="Uses cliqueMS to generate components using the
cliqueMS::getCliques function."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">patRoon</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Reference
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../reference/index.html">Online</a>
    </li>
    <li>
      <a href="../reference/patRoon.pdf">PDF</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorial
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/tutorial.html">Online HTML page</a>
    </li>
    <li>
      <a href="../articles/tutorial.pdf">PDF</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Handbook
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../handbook_bd/index.html">Book format</a>
    </li>
    <li>
      <a href="../handbook_bd/handbook.pdf">PDF</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/rickhelmus/patRoon" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Componentization of adducts, isotopes etc. with cliqueMS</h1>
    <small class="dont-index">Source: <a href="https://github.com/rickhelmus/patRoon/blob/HEAD/R/generics.R" class="external-link"><code>R/generics.R</code></a>, <a href="https://github.com/rickhelmus/patRoon/blob/HEAD/R/components-cliquems.R" class="external-link"><code>R/components-cliquems.R</code></a></small>
    <div class="hidden name"><code>generateComponentsCliqueMS.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Uses <a href="https://github.com/osenan/cliqueMS" class="external-link">cliqueMS</a> to generate components using the
<code><a href="https://rdrr.io/pkg/cliqueMS/man/getCliques.html" class="external-link">cliqueMS::getCliques</a></code> function.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">generateComponentsCliqueMS</span><span class="op">(</span><span class="va">fGroups</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for featureGroups</span></span>
<span><span class="fu">generateComponentsCliqueMS</span><span class="op">(</span></span>
<span>  <span class="va">fGroups</span>,</span>
<span>  ionization <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maxCharge <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  maxGrade <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  ppm <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  adductInfo <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  absMzDev <span class="op">=</span> <span class="fl">0.005</span>,</span>
<span>  minSize <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  relMinAdductAbundance <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  adductConflictsUsePref <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  NMConflicts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"preferential"</span>, <span class="st">"mostAbundant"</span>, <span class="st">"mostIntense"</span><span class="op">)</span>,</span>
<span>  prefAdducts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"[M+H]+"</span>, <span class="st">"[M-H]-"</span><span class="op">)</span>,</span>
<span>  extraOptsCli <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  extraOptsIso <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  extraOptsAnn <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for featureGroupsSet</span></span>
<span><span class="fu">generateComponentsCliqueMS</span><span class="op">(</span><span class="va">fGroups</span>, ionization <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>fGroups</dt>
<dd><p><code><a href="featureGroups-class.html">featureGroups</a></code> object for which components should be generated.</p></dd>


<dt>...</dt>
<dd><p>(<strong>sets workflow</strong>) Further arguments passed to the non-sets workflow method.</p></dd>


<dt>ionization</dt>
<dd><p>Which ionization polarity was used to generate the data: should be <code>"positive"</code>
  or <code>"negative"</code>. If the <code>featureGroups</code> object has adduct annotations, and <code>ionization=NULL</code>, the
  ionization will be detected automatically.</p>
<p>(<strong>sets workflow</strong>) This parameter is not supported for sets workflows, as the ionization will always be detected
  automatically.</p></dd>


<dt>maxCharge, maxGrade, ppm</dt>
<dd><p>Arguments passed to <code><a href="https://rdrr.io/pkg/cliqueMS/man/getIsotopes.html" class="external-link">cliqueMS::getIsotopes</a></code> and/or
<code><a href="https://rdrr.io/pkg/cliqueMS/man/getAnnotation.html" class="external-link">cliqueMS::getAnnotation</a></code>.</p></dd>


<dt>adductInfo</dt>
<dd><p>Sets the <code>adinfo</code> argument to <code><a href="https://rdrr.io/pkg/cliqueMS/man/getAnnotation.html" class="external-link">cliqueMS::getAnnotation</a></code>.
If <code>NULL</code> then the default adduct information from <span class="pkg">cliqueMS</span> is used (<em>i.e.</em> the
<code>positive.adinfo</code>/<code>negative.adinfo</code> package datasets).</p></dd>


<dt>absMzDev</dt>
<dd><p>Maximum absolute \emphm/z deviation.</p></dd>


<dt>minSize</dt>
<dd><p>The minimum size of a component. Smaller components than this size will be removed. See note below.</p></dd>


<dt>relMinAdductAbundance</dt>
<dd><p>The minimum relative abundance (<samp>0-1</samp>) that an adduct should be assigned to
features within the same feature group. See the <code>Feature components</code> section for more details.</p></dd>


<dt>adductConflictsUsePref</dt>
<dd><p>If set to <code>TRUE</code>, and not all adduct assigments to the features within a feature
group are equal and at least one of those adducts is a preferential adduct (<code>prefAdducts</code> argument), then only
the features with (the lowest ranked) preferential adduct are considered. In all other cases or when
<code>adductConflictsUsePref=FALSE</code> only features with the most frequently assigned adduct is considered. See the
<code>Feature components</code> section for more details.</p></dd>


<dt>NMConflicts</dt>
<dd><p>The strategies to employ when not all neutral masses within a component are equal. Valid options
are: <code>"preferential"</code>, <code>"mostAbundant"</code> and <code>"mostIntense"</code>. Multiple strategies are possible, and
will be executed in the given order until one succeeds. See the <code>Feature components</code> section for more details.</p></dd>


<dt>prefAdducts</dt>
<dd><p>A <code>character</code> vector with one or more <em>preferential adducts</em>. See the <code>Feature
components</code> section for more details.</p></dd>


<dt>extraOptsCli, extraOptsIso, extraOptsAnn</dt>
<dd><p>Named <code>list</code> with further arguments to be passed to
<code><a href="https://rdrr.io/pkg/cliqueMS/man/getCliques.html" class="external-link">cliqueMS::getCliques</a></code>, <code><a href="https://rdrr.io/pkg/cliqueMS/man/getIsotopes.html" class="external-link">cliqueMS::getIsotopes</a></code>
and <code><a href="https://rdrr.io/pkg/cliqueMS/man/getAnnotation.html" class="external-link">cliqueMS::getAnnotation</a></code>, respectively. Set to <code>NULL</code> to ignore.</p></dd>


<dt>parallel</dt>
<dd><p>If set to <code>TRUE</code> then code is executed in parallel through the <a href="https://CRAN.R-project.org/package=futures" class="external-link"><span class="pkg">futures</span></a> package. Please
see the parallelization section in the handbook for more details.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code><a href="components-class.html">componentsFeatures</a></code> derived object.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function uses cliqueMS to generate components. This function is called when calling <code>generateComponents</code> with
  <code>algorithm="cliquems"</code>.</p>
<p>The grouping of features in each component ('clique') is based on high similarity of chromatographic elution
  profiles. All features in each component are then annotated with the
  <code><a href="https://rdrr.io/pkg/cliqueMS/man/getIsotopes.html" class="external-link">cliqueMS::getIsotopes</a></code> and
  <code><a href="https://rdrr.io/pkg/cliqueMS/man/getAnnotation.html" class="external-link">cliqueMS::getAnnotation</a></code> functions.</p>
    </div>
    <div id="feature-components">
    <h2>Feature components</h2>
    <p>The returned components are based on so called <em>feature components</em>. Unlike other
  algorithms, components are first made on a feature level (per analysis), instead of for complete feature groups. In
  the final step the feature components are converted to 'regular' components by employing a consensus approach with
  the following steps:</p>
<p></p><ol><li><p>If an adduct assigned to a feature only occurs as a minority compared to other adduct assigments within the
  same feature group, it is considered as an outlier and removed accordingly (controlled by the
  <code>relMinAdductAbundance</code> argument).</p></li>
<li><p>For features within a feature group, only keep their adduct assignment if it occurs as the most frequent or
  is preferential (controlled by <code>adductConflictsUsePref</code> and <code>prefAdducts</code> arguments).</p></li>
<li><p>Components are made by combining the feature groups for which at least one of their features are jointly
  present in the same feature component.</p></li>
<li><p>Conflicts of neutral mass assignments within a component (<em>i.e.</em> not all are the same) are dealt with.
  Firstly, all feature groups with an unknown neutral mass are split in another component. Then, if conflicts still
  occur, the feature groups with similar neutral mass (determined by <code>absMzDev</code> argument) are grouped. Depending
  on the <code>NMConflicts</code> argument, the group with one or more preferential adduct(s) or that is the largest or
  most intense is selected, whereas others are removed from the component. In case multiple groups contain
  preferential adducts, and <samp>&gt;1</samp> preferential adducts are available, the group with the adduct that matches
  first in <code>prefAdducts</code> 'wins'. In case of ties, one of the next strategies in <code>NMConflicts</code> is tried.</p></li>
<li><p>If a feature group occurs in multiple components it will be removed completely.</p></li>
<li><p>the <code>minSize</code> filter is applied.</p></li>
</ol></div>
    <div id="sets-workflows">
    <h2>Sets workflows</h2>
    <p>In a <a href="sets-workflow.html">sets workflow</a> the componentization is first performed for each
  set independently. The resulting components are then all combined in a <code><a href="components-class.html">componentsSet</a></code> object. Note that
  the components themselves are never merged. The components are renamed to include the set name from which they were
  generated (<em>e.g.</em> <code>"CMP1"</code> becomes <code>"CMP1-positive"</code>).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Senan O, Aguilar-Mogas A, Navarro M, Capellades J, Noon L, Burks D, Yanes O, Guimera R, Sales-Pardo M (2019).
“CliqueMS: a computational tool for annotating in-source metabolite ions from LC-MS untargeted metabolomics data based on a coelution similarity network.”
<em>Bioinformatics</em>, <b>35</b>(20), 4089--4097.
<a href="https://doi.org/10.1093/bioinformatics/btz207" class="external-link">doi:10.1093/bioinformatics/btz207</a>
.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="generateComponents.html">generateComponents</a></code> for more details and other algorithms.</p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Rick Helmus.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

