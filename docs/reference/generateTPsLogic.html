<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Obtain transformation products (TPs) with metabolic logic — generateTPsLogic • patRoon</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Obtain transformation products (TPs) with metabolic logic — generateTPsLogic"><meta property="og:description" content="Automatically calculate potential transformation products with metabolic logic."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">patRoon</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Reference
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../reference/index.html">Online</a>
    </li>
    <li>
      <a href="../reference/patRoon.pdf">PDF</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorial
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/tutorial.html">Online HTML page</a>
    </li>
    <li>
      <a href="../articles/tutorial.pdf">PDF</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Handbook
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../handbook_bd/index.html">Book format</a>
    </li>
    <li>
      <a href="../handbook_bd/handbook.pdf">PDF</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/rickhelmus/patRoon" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Obtain transformation products (TPs) with metabolic logic</h1>
    <small class="dont-index">Source: <a href="https://github.com/rickhelmus/patRoon/blob/HEAD/R/TP-logic.R" class="external-link"><code>R/TP-logic.R</code></a></small>
    <div class="hidden name"><code>generateTPsLogic.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Automatically calculate potential transformation products with <em>metabolic logic</em>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="co"># S4 method for featureGroups</span>
<span class="fu">generateTPsLogic</span><span class="op">(</span><span class="va">fGroups</span>, minMass <span class="op">=</span> <span class="fl">40</span>, adduct <span class="op">=</span> <span class="cn">NULL</span>, transformations <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>

<span class="co"># S4 method for featureGroupsSet</span>
<span class="fu">generateTPsLogic</span><span class="op">(</span><span class="va">fGroups</span>, minMass <span class="op">=</span> <span class="fl">40</span>, transformations <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>fGroups</dt>
<dd><p>A <code><a href="featureGroups-class.html">featureGroups</a></code> object for which TPs should be calculated.</p></dd>


<dt>minMass</dt>
<dd><p>A <code>numeric</code> that specifies the minimum mass of calculated TPs. If below this mass it will be
removed.</p></dd>


<dt>adduct</dt>
<dd><p>An <code><a href="adduct-class.html">adduct</a></code> object (or something that can be converted to it with <code><a href="adduct-utils.html">as.adduct</a></code>).
  Examples: <code>"[M-H]-"</code>, <code>"[M+Na]+"</code>. If the <code>featureGroups</code> object has
  adduct annotations then these are used if <code>adducts=NULL</code>.</p>
<p>(<strong>sets workflow</strong>) The <code>adduct</code> argument is not supported for sets workflows, since the
  adduct annotations will then always be used.</p></dd>


<dt>transformations</dt>
<dd><p>A <code>data.frame</code> with transformation reactions to be used for calculating the TPs (see
details below). If <code>NULL</code>, a default table from Schollee <em>et al.</em> is used (see references).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code><a href="transformationProducts-class.html">transformationProducts</a></code> (derived) object containing all generated TPs.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function uses metabolic logic to obtain transformation products. This function is called when calling <code>generateTPs</code> with
  <code>algorithm="logic"</code>.</p>
<p>With this algorithm TPs are predicted from common (environmental) chemical reactions, such as hydroxylation,
  demethylation etc. The generated TPs result from calculating the mass differences between a parent feature after it
  underwent the reaction. While this only results in little information on chemical properties of the TP, an
  advantage of this method is that it does not rely on structural information of the parent, which may be unknown in
  a full non-target analysis.</p>
    </div>
    <div id="custom-transformations">
    <h2>Custom transformations</h2>
    <p>The <code>transformations</code> argument to <code>generateTPsLogic</code> is used to specify
  custom rules to calculate transformation products. This should be a <code>data.frame</code> with the following columns:</p><ul><li><p><code>transformation</code> The name of the chemical transformation</p></li>
<li><p><code>add</code> The elements that are added by this reaction (<em>e.g.</em> <code>"O"</code>).</p></li>
<li><p><code>sub</code> The elements that are removed by this reaction (<em>e.g.</em> <code>"H2O"</code>).</p></li>
<li><p><code>retDir</code> The expected retention time direction relative to the parent (assuming a reversed phase like LC
  separation). Valid values are: <samp>-1</samp> (elutes before the parent), <samp>1</samp> (elutes after the parent) or <samp>0</samp>
  (no significant change or unknown).</p></li>
</ul></div>
    <div id="source">
    <h2>Source</h2>
    <p>The algorithm of <code>generateTPsLogic</code> is directly based on the work done by Schollee <em>et
  al.</em> (see references).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Schollee JE, Schymanski EL, Avak SE, Loos M, Hollender J (2015).
“Prioritizing Unknown Transformation Products from Biologically-Treated Wastewater Using High-Resolution Mass Spectrometry,  Multivariate Statistics,  and Metabolic Logic.”
<em>Analytical Chemistry</em>, <b>87</b>(24), 12121--12129.
<a href="https://doi.org/10.1021/acs.analchem.5b02905" class="external-link">doi:10.1021/acs.analchem.5b02905</a>
.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="generateTPs.html">generateTPs</a></code> for more details and other algorithms.</p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Rick Helmus.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

      </footer></div>

  


  

  </body></html>

