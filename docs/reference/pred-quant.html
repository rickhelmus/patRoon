<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Functionality to predict quantitative data — pred-quant • patRoon</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Functionality to predict quantitative data — pred-quant"><meta property="og:description" content="Functions to predict response factors and feature concentrations from SMILES and/or
SIRIUS+CSI:FingerID fingerprints using the MS2Quant package."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">patRoon</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>

  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Reference

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../reference/index.html">Online</a>
    </li>
    <li>
      <a href="../reference/patRoon.pdf">PDF</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorial

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/tutorial.html">Online HTML page</a>
    </li>
    <li>
      <a href="../articles/tutorial.pdf">PDF</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Handbook

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../handbook_bd/index.html">Book format</a>
    </li>
    <li>
      <a href="../handbook_bd/handbook.pdf">PDF</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/rickhelmus/patRoon" class="external-link">
    <span class="fa fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Functionality to predict quantitative data</h1>
    <small class="dont-index">Source: <a href="https://github.com/rickhelmus/patRoon/blob/HEAD/R/main.R" class="external-link"><code>R/main.R</code></a>, <a href="https://github.com/rickhelmus/patRoon/blob/HEAD/R/feature_groups.R" class="external-link"><code>R/feature_groups.R</code></a>, <a href="https://github.com/rickhelmus/patRoon/blob/HEAD/R/feature_groups-set.R" class="external-link"><code>R/feature_groups-set.R</code></a>, and 8 more</small>
    <div class="hidden name"><code>pred-quant.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Functions to predict response factors and feature concentrations from <acronym>SMILES</acronym> and/or
<code class="command">SIRIUS+CSI:FingerID</code> fingerprints using the <span class="pkg">MS2Quant</span> package.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S4 method for class 'featureGroups'</span></span>
<span><span class="fu">calculateConcs</span><span class="op">(</span><span class="va">fGroups</span>, <span class="va">featureAnn</span>, areas <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'featureGroupsSet'</span></span>
<span><span class="fu">calculateConcs</span><span class="op">(</span><span class="va">fGroups</span>, <span class="va">featureAnn</span>, areas <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'compounds'</span></span>
<span><span class="fu"><a href="generics.html">predictRespFactors</a></span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  <span class="va">fGroups</span>,</span>
<span>  <span class="va">calibrants</span>,</span>
<span>  <span class="va">eluent</span>,</span>
<span>  <span class="va">organicModifier</span>,</span>
<span>  <span class="va">pHAq</span>,</span>
<span>  concUnit <span class="op">=</span> <span class="st">"ugL"</span>,</span>
<span>  calibConcUnit <span class="op">=</span> <span class="va">concUnit</span>,</span>
<span>  updateScore <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  scoreWeight <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'featureGroupsScreening'</span></span>
<span><span class="fu"><a href="generics.html">predictRespFactors</a></span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  <span class="va">calibrants</span>,</span>
<span>  <span class="va">eluent</span>,</span>
<span>  <span class="va">organicModifier</span>,</span>
<span>  <span class="va">pHAq</span>,</span>
<span>  concUnit <span class="op">=</span> <span class="st">"ugL"</span>,</span>
<span>  calibConcUnit <span class="op">=</span> <span class="va">concUnit</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'featureGroupsScreening'</span></span>
<span><span class="fu">calculateConcs</span><span class="op">(</span><span class="va">fGroups</span>, featureAnn <span class="op">=</span> <span class="cn">NULL</span>, areas <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'featureGroupsScreeningSet'</span></span>
<span><span class="fu"><a href="generics.html">predictRespFactors</a></span><span class="op">(</span><span class="va">obj</span>, <span class="va">calibrants</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'featureGroupsScreeningSet'</span></span>
<span><span class="fu">calculateConcs</span><span class="op">(</span><span class="va">fGroups</span>, featureAnn <span class="op">=</span> <span class="cn">NULL</span>, areas <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'compoundsSet'</span></span>
<span><span class="fu"><a href="generics.html">predictRespFactors</a></span><span class="op">(</span><span class="va">obj</span>, <span class="va">fGroups</span>, <span class="va">calibrants</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'compoundsSIRIUS'</span></span>
<span><span class="fu"><a href="generics.html">predictRespFactors</a></span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  <span class="va">fGroups</span>,</span>
<span>  <span class="va">calibrants</span>,</span>
<span>  <span class="va">eluent</span>,</span>
<span>  <span class="va">organicModifier</span>,</span>
<span>  <span class="va">pHAq</span>,</span>
<span>  concUnit <span class="op">=</span> <span class="st">"ugL"</span>,</span>
<span>  calibConcUnit <span class="op">=</span> <span class="va">concUnit</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"FP"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'formulasSet'</span></span>
<span><span class="fu"><a href="generics.html">predictRespFactors</a></span><span class="op">(</span><span class="va">obj</span>, <span class="va">fGroups</span>, <span class="va">calibrants</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'formulasSIRIUS'</span></span>
<span><span class="fu"><a href="generics.html">predictRespFactors</a></span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  <span class="va">fGroups</span>,</span>
<span>  <span class="va">calibrants</span>,</span>
<span>  <span class="va">eluent</span>,</span>
<span>  <span class="va">organicModifier</span>,</span>
<span>  <span class="va">pHAq</span>,</span>
<span>  concUnit <span class="op">=</span> <span class="st">"ugL"</span>,</span>
<span>  calibConcUnit <span class="op">=</span> <span class="va">concUnit</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">getQuantCalibFromScreening</span><span class="op">(</span><span class="va">fGroups</span>, <span class="va">concs</span>, areas <span class="op">=</span> <span class="cn">FALSE</span>, average <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-fgroups">fGroups<a class="anchor" aria-label="anchor" href="#arg-fgroups"></a></dt>
<dd><p>For <code>predictRespFactors</code> methods for feature annotations: The <code><a href="featureGroups-class.html">featureGroups</a></code> object
  for which the annotations were performed.</p>
<p>For <code>calculateConcs</code>: The <code><a href="featureGroups-class.html">featureGroups</a></code> object for which concentrations should be calculated.</p>
<p>For <code>getQuantCalibFromScreening</code>: A feature groups object screened for the calibrants with
  <code><a href="suspect-screening.html">screenSuspects</a></code>.</p></dd>


<dt id="arg-featureann">featureAnn<a class="anchor" aria-label="anchor" href="#arg-featureann"></a></dt>
<dd><p>A <code><a href="featureAnnotations-class.html">featureAnnotations</a></code> object (<em>e.g.</em> <code><a href="formulasSIRIUS-class.html">formulasSIRIUS</a></code> or
<code><a href="compounds-class.html">compounds</a></code>) which contains response factors. Optional if <code>calculateConcs</code> is called on suspect
screening results (<em>i.e.</em> <code><a href="featureGroupsScreening-class.html">featureGroupsScreening</a></code> method).</p></dd>


<dt id="arg-areas">areas<a class="anchor" aria-label="anchor" href="#arg-areas"></a></dt>
<dd><p>Set to <code>TRUE</code> to use peak areas instead of peak heights. Note: for <code>calculateConcs</code> this
should follow what is in the <code>calibrants</code> table.</p></dd>


<dt id="arg-obj">obj<a class="anchor" aria-label="anchor" href="#arg-obj"></a></dt>
<dd><p>The workflow object for which predictions should be performed, <em>e.g.</em> feature groups with screening
results (<code><a href="featureGroupsScreening-class.html">featureGroupsScreening</a></code>) or compound annotations (<code><a href="compounds-class.html">compounds</a></code>).</p></dd>


<dt id="arg-calibrants">calibrants<a class="anchor" aria-label="anchor" href="#arg-calibrants"></a></dt>
<dd><p>A <code>data.frame</code> with calibrants, see the <code>Calibration</code> section below.</p>
<p>(<strong>sets workflow</strong>) Should be a <code>list</code> with the calibrants for each set.</p></dd>


<dt id="arg-eluent">eluent<a class="anchor" aria-label="anchor" href="#arg-eluent"></a></dt>
<dd><p>A <code>data.frame</code> that describes the LC gradient program. Should have a column <code>time</code> with the
retention time in seconds and a column <code>B</code> with the corresponding percentage of the organic modifier
(<samp>0-100</samp>).</p></dd>


<dt id="arg-organicmodifier">organicModifier<a class="anchor" aria-label="anchor" href="#arg-organicmodifier"></a></dt>
<dd><p>The organic modifier of the mobile phase: either <code>"MeOH"</code> (methanol) or <code>"MeCN"</code>
(acetonitrile).</p></dd>


<dt id="arg-phaq">pHAq<a class="anchor" aria-label="anchor" href="#arg-phaq"></a></dt>
<dd><p>The <acronym>pH</acronym> of the aqueous part of the mobile phase.</p></dd>


<dt id="arg-concunit">concUnit<a class="anchor" aria-label="anchor" href="#arg-concunit"></a></dt>
<dd><p>The concentration unit for calculated concentrations. Can be molar based (<code>"nM"</code>, <code>"uM"</code>,
<code>"mM"</code>, <code>"M"</code>) or mass based (<code>"ngL"</code>, <code>"ugL"</code>, <code>"mgL"</code>, <code>"gL"</code>). Furthermore, can be
prefixed with <code>"log "</code> for logarithmic concentrations (<em>e.g.</em> <code>"log mM"</code>).</p></dd>


<dt id="arg-calibconcunit">calibConcUnit<a class="anchor" aria-label="anchor" href="#arg-calibconcunit"></a></dt>
<dd><p>The concentration unit used in the calibrants table. For possible values see the <code>concUnit</code>
argument.</p></dd>


<dt id="arg-updatescore-scoreweight">updateScore, scoreWeight<a class="anchor" aria-label="anchor" href="#arg-updatescore-scoreweight"></a></dt>
<dd><p>If <code>updateScore=TRUE</code> then the annotation <code>score</code> column is updated
by adding normalized values of the response factor (weighted by <span class="option">scoreWeight</span>). Currently, this
<strong>only</strong> makes sense for annotations performed with <code class="command">MetFrag</code>!</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>If set to <code>TRUE</code> then code is executed in parallel through the <a href="https://CRAN.R-project.org/package=futures" class="external-link"><span class="pkg">futures</span></a> package. Please
see the parallelization section in the handbook for more details.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>(<strong>sets workflow</strong>) Further arguments passed to the non-sets workflow method.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Which types of predictions should be performed: should be <code>"FP"</code> (<code class="command">SIRIUS+CSI:FingerID</code>
fingerprints), <code>"SMILES"</code> or <code>"both"</code>. Only relevant for <code><a href="compoundsSIRIUS-class.html">compoundsSIRIUS</a></code> method.</p></dd>


<dt id="arg-concs">concs<a class="anchor" aria-label="anchor" href="#arg-concs"></a></dt>
<dd><p>A <code>data.frame</code> with concentration data. See the <code>Calibration</code> section below.</p></dd>


<dt id="arg-average">average<a class="anchor" aria-label="anchor" href="#arg-average"></a></dt>
<dd><p>Set to <code>TRUE</code> to average intensity values within replicate groups.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code>predictRespFactors</code> returns an object amended with response factors (<code>RF_SMILES</code>/<code>LRF_SIRFP</code>
  columns).</p>
<p><code>calculateConcs</code> returns a <code><a href="featureGroups-class.html">featureGroups</a></code> based object amended with concentrations for each
  feature group (accessed with the <code><a href="featureGroups-class.html">concentrations</a></code> method).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The <a href="https://github.com/kruvelab/MS2Quant" class="external-link">MS2Quant</a> <span style="R">R</span> package predicts concentrations from <acronym>SMILES</acronym>
and/or MS/MS fingerprints obtained with <code class="command">SIRIUS+CSI:FingerID</code>. The <code>predictRespFactors</code> method functions
interface with this package to calculate response factors, which can then be used to calculate feature concentrations
with the <code>calculateConcs</code> method function.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The <a href="https://CRAN.R-project.org/package=rcdk" class="external-link"><span class="pkg">rcdk</span></a> package and <a href="https://github.com/openbabel/openbabel" class="external-link">OpenBabel</a> tool are used
  internally to calculate molecular weights. Please make sure that <code class="command">OpenBabel</code> is installed.</p>
<p><span class="pkg">MS2Quant</span> currently <em>only</em> supports <samp>M+H</samp> and <samp>M+</samp> adducts when performing predictions with
  <code class="command">SIRIUS:FingerID</code> fingerprints. Predictions for candidates with other adducts, including <samp>M-H]</samp>, are
  skipped with a warning.</p>
    </div>
    <div id="calibration">
    <h2>Calibration</h2>
    <p>The <span class="pkg">MS2Quant</span> package requires calibration to convert predicted ionization efficiencies to
  instrument/method specific response factors. The calibration data should be specified with the <code>calibrants</code>
  argument to <code>predictRespFactors</code>. This should be a <code>data.frame</code> with intensity observations at different
  concentrations for a set of calibrants. Each row specifies one intensity observation at one concentration. The
  table should have the following columns:</p>
<p></p><ul><li><p><code>name</code> The name of the calibrant. Can be freely chosen.</p></li>
<li><p><code>SMILES</code> The <acronym>SMILES</acronym> of the calibrant.</p></li>
<li><p><code>rt</code> The retention time of the calibrant (in seconds).</p></li>
<li><p><code>intensity</code> The peak intensity (or area, see the <code>areas</code> argument) of the calibrant.</p></li>
<li><p><code>conc</code> The concentration of the calibrant (see the <code>calibConcUnit</code> argument for specifying the unit).</p></li>
</ul><p>It is recommended to include multiple calibrants (<em>e.g.</em> <samp>&gt;=10</samp>) at multiple concentrations (<em>e.g.</em>
  <samp>&gt;=5</samp>). The latter is achieved by adding multiple rows for the same calibrant (keeping the
  <code>name</code>/<code>SMILES</code>/<code>rt</code> columns constant). It is also possible to follow the column naming used by
  <span class="pkg">MS2Quant</span> (however retention times should still be in seconds!). For more details and tips see
  <a href="https://github.com/kruvelab/MS2Quant" class="external-link">https://github.com/kruvelab/MS2Quant</a>.</p>
<p>The <code>getQuantCalibFromScreening</code> function can be used to automatically generate a calibrants table from a
  feature groups object with suspect screening results. Here, the idea is to perform a screening with
  <code><a href="suspect-screening.html">screenSuspects</a></code> with a suspect list that contain the calibrants, which is then used to construct the
  calibrant table. It is highly recommended to add retention times for the calibrants in the suspect list to ensure
  the calibrant is assigned to the correct feature. Furthermore, it is possible to simply add the calibrants to the
  'regular' suspect list in case a suspect screening was already part of the workflow. The
  <code>getQuantCalibFromScreening</code> function still requires you to specify concentration data, which is achieved via
  the <code>concs</code> argument. This should be a <code>data.frame</code> with a column <code>name</code> corresponding to the
  calibrant name (<em>i.e.</em> same as used by <code>screenSuspects</code> above) and columns with concentration data. The
  latter columns specify the concentrations of a calibrant in different replicate groups (as defined in the
  <a href="analysis-information.html">analysis information</a>). The concentration columns should be named after the
  corresponding replicate group. Only those replicate groups that should be used for calibration need to be included.
  Furthermore, <code>NA</code> values can be used if a replicate group should be ignored for a specific calibrant.</p>
    </div>
    <div id="predicting-response-factors">
    <h2>Predicting response factors</h2>
    <p>The response factors are predicted with the <code>predictRespFactors</code> generic functions,
  which accepts the following input:</p>
<ul><li><p><a href="suspect-screening.html">Suspect screening results</a>. The <acronym>SMILES</acronym> data is used to predict
response factors for suspect hits.</p></li>
<li><p>Formula annotation data obtained with <code>"sirius"</code> algorithm (<code><a href="generateFormulasSIRIUS.html">generateFormulasSIRIUS</a></code>). The
predictions are performed for each formula candidate using <code class="command">SIRIUS+CSI:FingerID</code> fingerprints. For this
reason, the <code>getFingerprint</code> argument must be set to <code>TRUE</code> when generating the formula data.</p></li>
<li><p>Compound annotation data obtained with the <code>"sirius"</code> algorithm (<code><a href="generateCompoundsSIRIUS.html">generateCompoundsSIRIUS</a></code>).
The predictions are performed for each annotation candidate using its <acronym>SMILES</acronym> and/or
<code class="command">SIRIUS+CSI:FingerID</code> fingerprints. The predictions are performed on a per formula basis, hence,
response factors for isomers will be equal.</p></li>
<li><p>Compound annotation data obtained with algorithms other than <code>"sirius"</code>. The response factors are predicted
from <acronym>SMILES</acronym> data.</p></li>
</ul><p>When <acronym>SMILES</acronym> data is used then predictions of response factors are generally more accurate. However,
  calculations with <code class="command">SIRIUS+CSI:FingerID</code> fingerprints are faster and only require the formula and MS/MS
  spectrum, <em>i.e.</em> not the full structure. Hence, calculations with <acronym>SMILES</acronym> are mostly useful in
  suspect screening workflows, or with high confidence compound annotation data, whereas MS/MS fingerprints are
  suitable with unknowns.</p>
<p>For annotation data the calculations are performed for <em>all</em> candidates. This can especially lead to long
  running calculations when <acronym>SMILES</acronym> data is used. Hence, it is <strong>strongly</strong> recommended to first
  prioritize the annotation results, <em>e.g.</em> with the <code>topMost</code> argument to the
  <a href="featureAnnotations-class.html">filter method</a>.</p>
<p>When response factors are predicted from <code class="command">SIRIUS+CSI:FingerID</code> fingerprints then only formula and MS/MS
  spectra are used, even if compound annotations are used for input. The major difference is that with formula
  annotation input <em>all</em> formula candidates for which a fingerprint could be generated are considered, whereas
  with compound annotations only candidate formulae are considered for which also a structure could be assigned.
  Hence, the formula annotation input could be more comprehensive, whereas predictions from structure annotations
  could lead to more representative results as only formulae are considered for which at least one structure could be
  assigned.</p>
    </div>
    <div id="assigning-concentrations">
    <h2>Assigning concentrations</h2>
    <p>The <code>calculateConcs</code> generic function is used to assign concentrations for each
  feature using the response factors discussed in the previous section. The function takes response factors from suspect
  screening results and/or feature annotation data. If multiple response factors were predicted for the same feature
  group, for instance when multiple annotation candidates or suspect hits for this feature group are present, then a
  concentrations is assigned for all response factors. These values can later be easily aggregated with <em>e.g.</em> the
  <a href="featureGroups-class.html">as.data.table</a> function.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>OBoyle NM, Banck M, James CA, Morley C, Vandermeersch T, Hutchison GR (2011).
“Open Babel: An open chemical toolbox.”
<em>Journal of Cheminformatics</em>, <b>3</b>(1).
<a href="https://doi.org/10.1186/1758-2946-3-33" class="external-link">doi:10.1186/1758-2946-3-33</a>
.
 <br><br> Guha R (2007).
“Chemical Informatics Functionality in R.”
<em>Journal of Statistical Software</em>, <b>18</b>(6).</p>
<p>Sepman H, Malm L, Peets P, MacLeod M, Martin J, Breitholtz M, Kruve A (2023).
“Bypassing the Identification: MS2Quant for Concentration Estimations of Chemicals Detected with Nontarget LC-HRMS from MS2 Data.”
<em>Analytical Chemistry</em>, <b>95</b>(33), 12329–12338.
<a href="https://doi.org/10.1021/acs.analchem.3c01744" class="external-link">doi:10.1021/acs.analchem.3c01744</a>
, <a href="https://doi.org/10.1021/acs.analchem.3c01744" class="external-link">https://doi.org/10.1021/acs.analchem.3c01744</a>.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="pred-tox.html">Toxicity prediction</a></p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Rick Helmus.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

