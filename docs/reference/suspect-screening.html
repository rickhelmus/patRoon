<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Target and suspect screening — suspect-screening • patRoon</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Target and suspect screening — suspect-screening" />
<meta property="og:description" content="Utilities to screen for analytes with known or suspected identity." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">patRoon</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Reference
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../reference/index.html">Online</a>
    </li>
    <li>
      <a href="../reference/patRoon.pdf">PDF</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorial
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/tutorial.html">Online HTML page</a>
    </li>
    <li>
      <a href="../articles/tutorial.pdf">PDF</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Handbook
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../handbook_bd/index.html">Book format</a>
    </li>
    <li>
      <a href="../articles/handbook.html">Single page</a>
    </li>
    <li>
      <a href="../handbook_bd/handbook.pdf">PDF</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/rickhelmus/patRoon">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Target and suspect screening</h1>
    <small class="dont-index">Source: <a href='https://github.com/rickhelmus/patRoon/blob/master/R/generics.R'><code>R/generics.R</code></a>, <a href='https://github.com/rickhelmus/patRoon/blob/master/R/features.R'><code>R/features.R</code></a>, <a href='https://github.com/rickhelmus/patRoon/blob/master/R/feature_groups.R'><code>R/feature_groups.R</code></a>, and 3 more</small>
    <div class="hidden name"><code>suspect-screening.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Utilities to screen for analytes with known or suspected identity.</p>
    </div>

    <pre class="usage"><span class='fu'>screenSuspects</span><span class='op'>(</span>
  <span class='va'>obj</span>,
  <span class='va'>suspects</span>,
  rtWindow <span class='op'>=</span> <span class='fl'>12</span>,
  mzWindow <span class='op'>=</span> <span class='fl'>0.005</span>,
  adduct <span class='op'>=</span> <span class='cn'>NULL</span>,
  skipInvalid <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>

<span class='co'># S4 method for features</span>
<span class='fu'>screenSuspects</span><span class='op'>(</span>
  <span class='va'>obj</span>,
  <span class='va'>suspects</span>,
  rtWindow <span class='op'>=</span> <span class='fl'>12</span>,
  mzWindow <span class='op'>=</span> <span class='fl'>0.005</span>,
  adduct <span class='op'>=</span> <span class='cn'>NULL</span>,
  skipInvalid <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>

<span class='co'># S4 method for featureGroups</span>
<span class='fu'>screenSuspects</span><span class='op'>(</span>
  <span class='va'>obj</span>,
  <span class='va'>suspects</span>,
  rtWindow <span class='op'>=</span> <span class='fl'>12</span>,
  mzWindow <span class='op'>=</span> <span class='fl'>0.005</span>,
  adduct <span class='op'>=</span> <span class='cn'>NULL</span>,
  skipInvalid <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>

<span class='co'># S4 method for featureGroups</span>
<span class='fu'>groupFeaturesScreening</span><span class='op'>(</span><span class='va'>fGroups</span>, <span class='va'>scr</span><span class='op'>)</span>

<span class='fu'>importFeatureGroupsBrukerTASQ</span><span class='op'>(</span><span class='va'>path</span>, <span class='va'>analysisInfo</span>, clusterRTWindow <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>obj</th>
      <td><p>The object that should be screened (<em>i.e.</em>
<code><a href='features-class.html'>features</a></code> or <code><a href='featureGroups-class.html'>featureGroups</a></code>).</p></td>
    </tr>
    <tr>
      <th>suspects</th>
      <td><p>A <code>data.frame</code> that must contain a <code>"name"</code> column
(the analyte name) and <em>at least</em> a <code>"mz"</code>, <code>"neutralMass"</code>,
<code>"formula"</code>, <code>"SMILES"</code>, <code>"InChI"</code> column (with the ionized
m/z value, the neutral monoisotopic mass or the chemical
formula/SMILES/InChI character string for the molecule, respectively). If
an ion mass needs to be calculated (<em>i.e.</em> no valid data is available
in the <code>mz</code> column) then data is tried to be used from the columns in
the aforementioned order. Furthermore, if ion masses need to be calculated
then the adduct must be specified either with the <code>adduct</code> function
argument or by an <code>"adduct"</code> column containing a <code>character</code> that
can be converted with <code>as.adduct</code> (<em>e.g.</em> <code>"[M+H]+"</code>). In
addition, a column <code>"rt"</code> can be included to specify the retention
time (if unspecified no retention times are checked).</p></td>
    </tr>
    <tr>
      <th>rtWindow, mzWindow</th>
      <td><p>The retention time window (in seconds) and
<em>m/z</em> window that will be used for matching a suspect (+/- feature
data).</p></td>
    </tr>
    <tr>
      <th>adduct</th>
      <td><p>An <code><a href='adduct-class.html'>adduct</a></code> object (or something that can be
converted to it with <code><a href='adduct-utils.html'>as.adduct</a></code>). Examples: <code>"[M-H]-"</code>,
<code>"[M+Na]+"</code>. Can be <code>NULL</code> if either a <code>"mz"</code> or
<code>"adduct"</code> column is present in the <code>suspects</code> argument.</p></td>
    </tr>
    <tr>
      <th>skipInvalid</th>
      <td><p>If set to <code>TRUE</code> then suspects with invalid data
(<em>e.g.</em> missing names or other missing data) will be ignored with a
warning. Similarly, any suspects for which mass calculation failed (when no
<code>mz</code> column is present in the suspect list), for instance, due to
invalid <code>SMILES</code>, will be ignored with a warning.</p></td>
    </tr>
    <tr>
      <th>fGroups</th>
      <td><p>The <code><a href='featureGroups-class.html'>featureGroups</a></code> object that should be
transformed (and was used to obtain the screening results).</p></td>
    </tr>
    <tr>
      <th>scr</th>
      <td><p>The screening results table returned by <code>screenSuspects</code>.</p></td>
    </tr>
    <tr>
      <th>path</th>
      <td><p>The file path to an Excel export of the Global results table from
TASQ, converted to <code class="file">.csv</code> format.</p></td>
    </tr>
    <tr>
      <th>analysisInfo</th>
      <td><p>A table with <a href='analysis-information.html'>analysis
information</a>.</p></td>
    </tr>
    <tr>
      <th>clusterRTWindow</th>
      <td><p>This retention time window (in seconds) is used to
group hits across analyses together. See also the details section.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>screenSuspects</code> will return a table (a
  <code>data.table</code>) with detected suspects and details such as
  retention and <em>m/z</em> values. If a suspect is matched on multiple
  features/feature groups then each hit is reported as a separate row.</p>
<p><code>groupFeaturesScreening</code> returns a modified <code>featureGroups</code>
  object in which those feature groups that were not matched by any suspects
  are removed and others renamed by the respective suspect name. In case of
  duplicate suspect results, feature group names are made unique with
  <code><a href='https://rdrr.io/r/base/make.unique.html'>make.unique</a></code>.</p>
<p><code>importFeatureGroupsBrukerTASQ</code> returns a new
  <code>featureGroups</code> object containing converted screening results from
  Bruker TASQ.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Besides 'full non-target analysis', where compounds may be identitified with
little to no prior knowledge, a common strategy is to screen for compounds
with known or suspected identity. This may be a generally favourable approach
if possible, as it can significantly reduce the load on data interpretation.</p>
<p><code>screenSuspects</code> will screen a set of suspects (provided as a
  <code>data.frame</code>) within an <code><a href='features-class.html'>features</a></code> or
  <code><a href='featureGroups-class.html'>featureGroups</a></code> object.</p>
<p><code>groupFeaturesScreening</code> uses results from <code>screenSuspects</code>
  to transform an existing <code><a href='featureGroups-class.html'>featureGroups</a></code> object by (1) renaming
  any matched feature groups by the respective name of the suspect and (2)
  filtering out any feature groups that were not matched. A common workflow
  is to first obtain and group features (with <em>e.g.</em>
  <code><a href='feature-finding.html'>findFeatures</a></code> and <code><a href='feature-grouping.html'>groupFeatures</a></code>), screen them
  with <code>screenSuspects</code>, convert the <code>featureGroups</code> object that was
  used for screening with this method function and continue any further
  workflow steps such as compound identification as with 'regular'
  <code>featureGroups</code>.</p>
<p><code>importFeatureGroupsBrukerTASQ</code> will convert screening results
  from Bruker TASQ to a <code><a href='featureGroups-class.html'>featureGroups</a></code> object. The feature
  groups across analyses are formed based on the name of suspects and their
  closeness in retention time. The latter is necessary because TASQ does not
  necessarily perform checks on retention times and may therefore assign a
  suspect to peaks with different retention times across analyses (or within
  a single analysis). Hence, suspects with equal names are hierarchically
  clustered on their retention times (using <span class="pkg">fastcluster</span>) to form
  the feature groups. The cut-off value for this is specified by the
  <code>clusterRTWindow</code> argument. The input for this function is obtained by
  generating an Excel export of the 'global' results and subsequently
  converting the file to <code class="file">.csv</code> format. Similar to
  <code>groupFeaturesScreening</code>, this method will return an object that is
  suitable for any further workflow processes.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Both <code>groupFeaturesScreening</code> and
  <code>importFeatureGroupsBrukerTASQ</code> use names from targets/suspects as
  feature group names, therefore, it is important that these are
  file-compatible names when <a href='reporting.html'>reporting data</a> <code class="file">csv</code> or
  <code class="file">pdf</code> data.</p>
<p>For <code>screenSuspects</code> in some cases you may need to install
  <a href='http://openbabel.org/wiki/Main_Page'>OpenBabel</a> (<em>e.g.</em> when
  only InChI data is available for mass calculation).</p>
<p>Please note that <code>groupFeaturesScreening</code> method can only
  transform the <code>featureGroups</code> object that was used to obtain the given
  screening results.</p>
<p><code>importFeatureGroupsBrukerTASQ</code> will use estimated min/max values
  for retention times and dummy min/max <em>m/z</em> values for conversion to
  features, since this information is not (readily) available. Hence, when
  plotting, for instance, extracted ion chromatograms (with
  <code><a href='generics.html'>plotEIC</a></code>) the integrated chromatographic peak range shown is
  incorrect.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Daniel Müllner (2013). fastcluster: Fast Hierarchical, Agglomerative Clustering Routines for R and Python. Journal of Statistical Software, 53(9), 1-18. URL http://www.jstatsoft.org/v53/i09/.</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Rick Helmus.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


