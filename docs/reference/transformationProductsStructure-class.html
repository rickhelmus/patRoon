<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Base transformation products (TP) class with structure information — transformationProductsStructure-class • patRoon</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Base transformation products (TP) class with structure information — transformationProductsStructure-class"><meta property="og:description" content="Holds information for all TPs for a set of parents, including structural information."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">patRoon</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Reference
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../reference/index.html">Online</a>
    </li>
    <li>
      <a href="../reference/patRoon.pdf">PDF</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorial
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/tutorial.html">Online HTML page</a>
    </li>
    <li>
      <a href="../articles/tutorial.pdf">PDF</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Handbook
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../handbook_bd/index.html">Book format</a>
    </li>
    <li>
      <a href="../handbook_bd/handbook.pdf">PDF</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/rickhelmus/patRoon" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Base transformation products (TP) class with structure information</h1>
    <small class="dont-index">Source: <a href="https://github.com/rickhelmus/patRoon/blob/HEAD/R/TP-structure.R" class="external-link"><code>R/TP-structure.R</code></a>, <a href="https://github.com/rickhelmus/patRoon/blob/HEAD/R/TP-CTS.R" class="external-link"><code>R/TP-CTS.R</code></a>, <a href="https://github.com/rickhelmus/patRoon/blob/HEAD/R/TP-biotransformer.R" class="external-link"><code>R/TP-biotransformer.R</code></a>, and 1 more</small>
    <div class="hidden name"><code>transformationProductsStructure-class.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Holds information for all TPs for a set of parents, including structural information.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="co"># S4 method for transformationProductsStructure</span>
<span class="fu"><a href="generics.html">convertToMFDB</a></span><span class="op">(</span><span class="va">TPs</span>, <span class="va">out</span>, includeParents <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># S4 method for transformationProductsStructure</span>
<span class="fu"><a href="generics.html">filter</a></span><span class="op">(</span>
  <span class="va">obj</span>,
  <span class="va">...</span>,
  removeParentIsomers <span class="op">=</span> <span class="cn">FALSE</span>,
  removeTPIsomers <span class="op">=</span> <span class="cn">FALSE</span>,
  removeDuplicates <span class="op">=</span> <span class="cn">FALSE</span>,
  minSimilarity <span class="op">=</span> <span class="cn">NULL</span>,
  verbose <span class="op">=</span> <span class="cn">TRUE</span>,
  negate <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>

<span class="co"># S4 method for transformationProductsStructure</span>
<span class="fu"><a href="generics.html">plotGraph</a></span><span class="op">(</span>
  <span class="va">obj</span>,
  <span class="va">which</span>,
  components <span class="op">=</span> <span class="cn">NULL</span>,
  structuresMax <span class="op">=</span> <span class="fl">25</span>,
  prune <span class="op">=</span> <span class="cn">TRUE</span>,
  onlyCompletePaths <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>

<span class="co"># S4 method for transformationProductsStructure</span>
<span class="fu"><a href="generics.html">plotVenn</a></span><span class="op">(</span><span class="va">obj</span>, <span class="va">...</span>, commonParents <span class="op">=</span> <span class="cn">FALSE</span>, labels <span class="op">=</span> <span class="cn">NULL</span>, vennArgs <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>

<span class="co"># S4 method for transformationProductsStructure</span>
<span class="fu"><a href="generics.html">plotUpSet</a></span><span class="op">(</span>
  <span class="va">obj</span>,
  <span class="va">...</span>,
  commonParents <span class="op">=</span> <span class="cn">FALSE</span>,
  labels <span class="op">=</span> <span class="cn">NULL</span>,
  nsets <span class="op">=</span> <span class="fu"><a href="generics.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>,
  nintersects <span class="op">=</span> <span class="cn">NA</span>,
  upsetArgs <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span>

<span class="co"># S4 method for transformationProductsStructure</span>
<span class="fu"><a href="generics.html">consensus</a></span><span class="op">(</span>
  <span class="va">obj</span>,
  <span class="va">...</span>,
  absMinAbundance <span class="op">=</span> <span class="cn">NULL</span>,
  relMinAbundance <span class="op">=</span> <span class="cn">NULL</span>,
  uniqueFrom <span class="op">=</span> <span class="cn">NULL</span>,
  uniqueOuter <span class="op">=</span> <span class="cn">FALSE</span>,
  labels <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>out</dt>
<dd><p>The file name of the the output <code class="command">MetFrag</code> database.</p></dd>


<dt>includeParents</dt>
<dd><p>Set to <code>TRUE</code> to include the parents in the database.</p></dd>


<dt>obj, TPs</dt>
<dd><p><code>transformationProductsStructure</code> derived object to be accessed</p></dd>


<dt>...</dt>
<dd><p>For <code>filter</code>: Further argument passed to the base
  <code><a href="transformationProducts-class.html">filter method</a></code>.</p>
<p>For <code>plotVenn</code>, <code>plotUpSet</code> and <code>consensus</code>: further (unique) <code>transformationProductsStructure</code>
  objects.</p></dd>


<dt>removeParentIsomers</dt>
<dd><p>If <code>TRUE</code> then TPs with an equal formula as their parent (isomers) are removed.</p></dd>


<dt>removeTPIsomers</dt>
<dd><p>If <code>TRUE</code> then all TPs with equal formula as any sibling TPs (isomers) are removed.
Unlike <code>removeDuplicates</code>, <em>all</em> TP candidates are removed (including the first match). This filter
automatically sets <code>removeDuplicates=TRUE</code> to avoid complete removal of TPs with equal structure.</p></dd>


<dt>removeDuplicates</dt>
<dd><p>If <code>TRUE</code> then the TPs of a parent with duplicate structures (<acronym>SMILES</acronym>) are
removed. Such duplicates may occur when different transformation pathways yield the same TPs. The first TP
candidate with duplicate structure will be kept.</p></dd>


<dt>minSimilarity</dt>
<dd><p>Minimum structure similarity (<samp>0-1</samp>) that a TP should have relative to its parent. This
data is only available if the <code>calcSims</code> argument to <code><a href="generateTPs.html">generateTPs</a></code> was set to <code>TRUE</code>. May be
useful under the assumption that parents and TPs who have a high structural similarity, also likely have a high
MS/MS spectral similarity (which can be evaluated after componentization with <code><a href="generateComponentsTPs.html">generateComponentsTPs</a></code>.
Any values that are <code>NA</code> are removed (which only occur when a consensus was made from objects that not all
have similarity information).</p></dd>


<dt>verbose</dt>
<dd><p>If set to <code>FALSE</code> then no text output is shown.</p></dd>


<dt>negate</dt>
<dd><p>If <code>TRUE</code> then filters are performed in opposite manner.</p></dd>


<dt>which</dt>
<dd><p>Either a <code>character</code> or <code>integer</code> vector with one or more names/indices of the parents to
plot.</p></dd>


<dt>components</dt>
<dd><p>If specified (<em>i.e.</em> not <code>NULL</code>), a <code><a href="componentsTPs-class.html">componentsTPs</a></code> object that is used for
matching the graph with screening results. The TPs that were found will be marked. See also the <code>prune</code> and
<code>onlyCompletePaths</code> arguments.</p></dd>


<dt>structuresMax</dt>
<dd><p>An <code>integer</code> with the maximum number of structures to plot. Setting a maximum is mainly
done to avoid long times needed to construct the graph.</p></dd>


<dt>prune</dt>
<dd><p>If <code>TRUE</code> and <code>components</code> is set, then pathways without <em>any</em> detected TPs are not shown
(pruned). See also the <code>onlyCompletePaths</code> and <code>components</code> arguments.</p></dd>


<dt>onlyCompletePaths</dt>
<dd><p>If <code>TRUE</code> and <code>components</code> is set, then only pathways are shown for which
<em>all</em> TPs were detected. See also the <code>prune</code> and <code>components</code> arguments.</p></dd>


<dt>commonParents</dt>
<dd><p>Only consider TPs from parents that are common to all compared objects.</p></dd>


<dt>labels</dt>
<dd><p>A <code>character</code> with names to use for labelling. If <code>NULL</code> labels are automatically generated.</p></dd>


<dt>vennArgs</dt>
<dd><p>A <code>list</code> with further arguments passed to <span class="pkg">VennDiagram</span> plotting functions. Set to
<code>NULL</code> to ignore.</p></dd>


<dt>nsets, nintersects</dt>
<dd><p>See <code><a href="https://rdrr.io/pkg/UpSetR/man/upset.html" class="external-link">upset</a></code>.</p></dd>


<dt>upsetArgs</dt>
<dd><p>A list with any further arguments to be passed to
<code><a href="https://rdrr.io/pkg/UpSetR/man/upset.html" class="external-link">upset</a></code>. Set to <code>NULL</code> to ignore.</p></dd>


<dt>absMinAbundance, relMinAbundance</dt>
<dd><p>Minimum absolute or relative
(<samp>0-1</samp>) abundance across objects for a result to be kept. For
instance, <code>relMinAbundance=0.5</code> means that a result should be present
in at least half of the number of compared objects. Set to <samp>NULL</samp> to
ignore and keep all results. Limits cannot be set when <code>uniqueFrom</code> is
not <code>NULL</code>.</p></dd>


<dt>uniqueFrom</dt>
<dd><p>Set this argument to only retain TPs that are unique
within one or more of the objects for which the consensus is made.
Selection is done by setting the value of <code>uniqueFrom</code> to a
<code>logical</code> (values are recycled), <code>numeric</code> (select by index) or a
<code>character</code> (as obtained with <code>algorithm(obj)</code>). For
<code>logical</code> and <code>numeric</code> values the order corresponds to the order
of the objects given for the consensus. Set to <code>NULL</code> to ignore.</p></dd>


<dt>uniqueOuter</dt>
<dd><p>If <code>uniqueFrom</code> is not <code>NULL</code> and if
<code>uniqueOuter=TRUE</code>: only retain data that are also unique between
objects specified in <code>uniqueFrom</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p><code>filter</code> returns a filtered <code>transformationProductsStructure</code> object.</p>


<p><code>plotGraph</code> returns the result of <code>visNetwork</code>.</p>


<p><code>plotVenn</code> (invisibly) returns a list with the following fields:</p><ul><li><p><code>gList</code> the <code>gList</code> object that was returned by
  the utilized <span class="pkg">VennDiagram</span> plotting function.</p></li>
<li><p><code>areas</code> The total area for each plotted group.</p></li>
<li><p><code>intersectionCounts</code> The number of intersections between groups.</p></li>
</ul><p>The order for the <code>areas</code> and <code>intersectionCounts</code> fields is the same as the parameter order
from the used plotting function (see <em>e.g.</em></p>
<p></p>
<p><code>draw.pairwise.venn</code> and
<code>draw.triple.venn</code>).</p>


<p><code>consensus</code> returns a <code>transformationProductsStructure</code> object that is produced by merging results
  from multiple <code>transformationProductsStructure</code> objects.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This (virtual) class is derived from the <code><a href="transformationProducts-class.html">transformationProducts</a></code> base class, please see its
documentation for more details. Objects from this class are returned by <a href="generateTPs.html">TP generators</a>. More
specifically, algorithms that works with chemical structures (<em>e.g.</em> <code>biotransformer</code>), uses this class to
store their results. The methods defined for this class extend the functionality for the base
<code><a href="transformationProducts-class.html">transformationProducts</a></code> class.</p>
    </div>
    <div id="methods-by-generic-">
    <h2>Methods (by generic)</h2>
    
<ul><li><p><code>convertToMFDB</code>: Exports this object as a <code class="file">.csv</code> file that can be used as a <code class="command">MetFrag</code> local
database. Any duplicate TPs (formed by different pathways or parents) will be merged based on their
<acronym>InChIKey</acronym>.</p></li>
<li><p><code>filter</code>: Performs rule-based filtering. Useful to simplify and clean-up the data.</p></li>
<li><p><code>plotGraph</code>: Plots an interactive hierarchy graph of the transformation products. The
resulting graph can be browsed interactively and allows exploration of the different TP formation pathways.
Furthermore, results from <a href="generateComponentsTPs.html">TP componentization</a> can be used to match the hierarchy
with screening results. The graph is rendered with <span class="pkg">visNetwork</span>.</p></li>
<li><p><code>plotVenn</code>: plots a Venn diagram (using <span class="pkg">VennDiagram</span>) outlining unique and shared
candidates of up to five different <code>featureAnnotations</code> objects.</p></li>
<li><p><code>plotUpSet</code>: Plots an UpSet diagram (using the <code><a href="https://rdrr.io/pkg/UpSetR/man/upset.html" class="external-link">upset</a></code> function)
outlining unique and shared TPs between different <code>transformationProductsStructure</code> objects.</p></li>
<li><p><code>consensus</code>: Generates a consensus from different
<code>transformationProductsStructure</code> objects. Currently this removes any hierarchical data, and all TPs are
considered to originate from the same (original) parent.</p></li>
</ul></div>
    <div id="note">
    <h2>Note</h2>
    <p><code>consensus</code>: If the <code>retDir</code> values differs between matched TPs it will be set to <samp>0</samp>. If
  structure similarity data is available (<em>i.e.</em> <code>calcSims=TRUE</code> to <code>generateTPs</code>) then the mean
  similarity is calculated.</p>
    </div>
    <div id="comparison-between-objects">
    <h2>Comparison between objects</h2>
    <p>The methods that compare different objects (<em>e.g.</em> <code>plotVenn</code> and
  <code>consensus</code>) use the <acronym>InChIKey</acronym> to match TPs between objects. Moreover, the parents between objects
  are matched by their name. Hence, it is <em>crucial</em> that the input parents to <code><a href="generateTPs.html">generateTPs</a></code>
  (<em>i.e.</em> the <code>parents</code> argument) are named equally.</p>
    </div>
    <div id="s-class-hierarchy">
    <h2>S4 class hierarchy</h2>
    <p></p><ul><li><p><code><a href="transformationProducts-class.html">transformationProducts</a></code></p><ul><li><p><strong><code>transformationProductsStructure</code></strong></p><ul><li><p><code>transformationProductsStructureConsensus</code></p></li>
<li><p><code>transformationProductsCTS</code></p></li>
<li><p><code>transformationProductsBT</code></p></li>
<li><p><code>transformationProductsLibrary</code></p></li>
</ul></li>
</ul></li>
</ul></div>
    <div id="references">
    <h2>References</h2>
    <p>Conway JR, Lex A, Gehlenborg N (2017).
“UpSetR: an R package for the visualization of intersecting sets and their properties.”
<em>Bioinformatics</em>, <b>33</b>(18), 2938-2940.
<a href="https://doi.org/10.1093/bioinformatics/btx364" class="external-link">doi:10.1093/bioinformatics/btx364</a>
, <a href="http://dx.doi.org/10.1093/bioinformatics/btx364" class="external-link">http://dx.doi.org/10.1093/bioinformatics/btx364</a>.
 <br><br> Lex A, Gehlenborg N, Strobelt H, Vuillemot R, Pfister H (2014).
“UpSet: Visualization of Intersecting Sets.”
<em>IEEE Transactions on Visualization and Computer Graphics</em>, <b>20</b>(12), 1983--1992.
<a href="https://doi.org/10.1109/tvcg.2014.2346248" class="external-link">doi:10.1109/tvcg.2014.2346248</a>
.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>The base class <code><a href="transformationProducts-class.html">transformationProducts</a></code> for more relevant methods and <code><a href="generateTPs.html">generateTPs</a></code></p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Rick Helmus.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

      </footer></div>

  


  

  </body></html>

